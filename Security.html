<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comprehensive Organizational Security Mindmap</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* General Reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif; /* Using Inter font */
            border-radius: 8px; /* Applying rounded corners to all elements */
        }

        /* Body Styles */
        body {
            background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%); /* Deep blueish gradient */
            min-height: 100vh;
            padding: 20px;
            color: white;
            display: flex;
            flex-direction: column;
            gap: 30px;
            align-items: center;
        }

        /* Container for overall layout */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }

        /* Main Heading */
        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.8rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            color: #4CAF50; /* Security green accent */
        }

        /* Mindmap Layout */
        .mindmap {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
            width: 100%;
        }

        /* Central Node */
        .central-node {
            background: linear-gradient(45deg, #4CAF50, #8BC34A); /* Green gradient */
            padding: 20px 40px;
            border-radius: 50px;
            font-size: 1.5rem;
            font-weight: bold;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            cursor: pointer;
            transform: scale(1);
            transition: all 0.3s ease;
        }

        .central-node:hover {
            transform: scale(1.05);
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
        }

        /* Main Branches Grid Layout */
        .main-branches {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            width: 100%;
        }

        /* Individual Branch Styles */
        .branch {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            padding: 25px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .branch:hover {
            transform: translateY(-5px);
            background: rgba(255,255,255,0.15);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }

        .branch-header {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 15px;
            color: #00bcd4; /* Light blue accent */
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .branch-icon {
            font-size: 1.5rem;
        }

        /* Sub-services (initially hidden) */
        .sub-services {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .sub-services.active {
            display: block;
        }

        /* Fade-in animation for sub-services */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Individual Service Item Styles (now category-item) */
        .category-item {
            background: rgba(0,0,0,0.2);
            margin: 10px 0;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .category-item:hover {
            background: rgba(0,0,0,0.3);
            transform: translateX(10px);
        }

        .category-name {
            font-weight: bold;
            color: #ffd700; /* Yellow accent */
            margin-bottom: 5px;
        }

        .category-desc {
            font-size: 0.9rem;
            color: #e0e0e0;
            margin-bottom: 10px;
        }

        /* Feature Tag Styles within modal */
        .feature-tag {
            display: inline-block;
            background: #4CAF50; /* Green accent */
            color: white;
            padding: 3px 8px;
            margin: 2px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .feature-tag:hover {
            background: #45a049;
            transform: scale(1.05);
        }

        /* Feature Details (initially hidden, expands on click) */
        .feature-details {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background: rgba(0,0,0,0.4);
            border-left: 4px solid #4CAF50; /* Green accent */
        }

        .feature-details.active {
            display: block;
            animation: slideDown 0.3s ease;
        }

        /* Slide-down animation for feature details */
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Sub-feature styles within details */
        .sub-feature {
            background: rgba(255,255,255,0.1);
            margin: 8px 0;
            padding: 10px;
            border-left: 3px solid #00bcd4; /* Light blue accent */
        }

        .sub-feature-title {
            font-weight: bold;
            color: #00bcd4; /* Light blue accent */
            margin-bottom: 5px;
        }

        .sub-feature-desc {
            font-size: 0.9rem;
            color: #e0e0e0;
            line-height: 1.4;
        }

        .feature-nav {
            text-align: left;
            margin: 15px 0;
            font-size: 0.9rem;
            color: #fff; /* White for better contrast */
        }
        .feature-nav strong {
            color: #a78bfa; /* Purple accent for strong text */
        }

        .use-cases-list { /* Renamed for clarity */
            margin-top: 10px;
            font-size: 0.85rem;
            color: #ff9900; /* Orange accent */
            list-style: disc;
            margin-left: 20px;
        }
        .use-cases-list li {
            margin-bottom: 5px;
        }


        /* Modal Overlay */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            animation: fadeIn 0.3s ease;
            overflow-y: auto; /* Allow scrolling for modal content */
        }

        /* Modal Content Box */
        .modal-content {
            background: linear-gradient(135deg, #1f283e 0%, #3a4b6c 100%); /* Consistent with body background */
            margin: 5% auto;
            padding: 30px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh; /* Max height to prevent overflow */
            overflow-y: auto; /* Ensure scrollability within modal */
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            border-radius: 12px;
        }

        /* Close Button for Modal */
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: white;
        }

        /* Sections within the modal */
        .tech-stack-list, .interdependencies-list, .config-options { /* Renamed for clarity */
            background: rgba(0,0,0,0.2);
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
        }
        .tech-stack-list ul, .interdependencies-list ul, .config-options ul {
            list-style: disc;
            margin-left: 20px;
            padding-left: 0;
        }

        .pricing-info-box { /* Renamed for clarity */
            background: rgba(52, 152, 219, 0.2);
            padding: 10px;
            margin: 10px 0;
            font-size: 0.9rem;
            border-radius: 8px;
        }

        .scenario-box {
            background: rgba(46, 204, 113, 0.2);
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
        }
        
        .config-options li {
            margin-bottom: 5px;
        }

        .llm-action-button {
            background-color: #4CAF50; /* Security green accent */
            color: white;
            border: none;
            padding: 8px 12px;
            cursor: pointer;
            font-size: 0.9rem;
            margin-top: 10px;
            margin-right: 10px;
            transition: background-color 0.3s ease;
            border-radius: 6px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .llm-action-button:hover {
            background-color: #45a049;
            transform: translateY(-1px);
        }

        .llm-output-area {
            background: rgba(0,0,0,0.3);
            padding: 15px;
            margin-top: 20px;
            border: 1px solid rgba(255,255,255,0.2);
            min-height: 50px;
            font-size: 0.95rem;
            line-height: 1.5;
            white-space: pre-wrap;
            word-wrap: break-word;
            display: none; /* Hidden by default */
            border-radius: 8px;
        }

        .loading-indicator {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: #4CAF50; /* Security green accent */
            animation: spin 1s ease-in-out infinite;
            -webkit-animation: spin 1s ease-in-out infinite;
            margin-left: 10px;
            vertical-align: middle;
        }

        @keyframes spin {
            to { -webkit-transform: rotate(360deg); }
        }
        @-webkit-animation {
            to { -webkit-transform: rotate(360deg); }
        }

        /* News Section */
        .news-section {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            padding: 25px;
            color: white;
            width: 100%;
            margin-top: 30px;
            border-radius: 12px;
        }

        .news-section h2 {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 20px;
            color: #4CAF50; /* Security green accent */
            text-align: center;
        }

        .news-item {
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .news-item:last-child {
            border-bottom: none;
        }

        .news-item h3 {
            font-size: 1.2rem;
            color: #ffd700; /* Yellow accent */
            margin-bottom: 5px;
        }

        .news-item p {
            font-size: 0.9rem;
            color: #e0e0e0;
        }

        .news-item a {
            color: #00bcd4; /* Light blue accent */
            text-decoration: underline;
            font-size: 0.85rem;
        }

        /* Floating Search Bar Styles */
        .floating-search-container {
            position: fixed;
            bottom: 20px;
            right: 20px; /* Default position */
            z-index: 1001;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            padding: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            transition: all 0.3s ease-in-out;
            opacity: 0.6;
            width: 60px;
            height: 60px;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 1px solid rgba(255,255,255,0.2);
            cursor: grab;
            border-radius: 50%; /* Make it round */
        }

        .floating-search-container:hover {
            opacity: 1;
        }

        .floating-search-container.expanded {
            width: 350px;
            height: auto;
            opacity: 1;
            flex-direction: column;
            align-items: flex-start;
            padding: 20px;
            cursor: auto;
            border-radius: 8px; /* Square when expanded */
        }

        .search-toggle-button {
            background-color: #4CAF50; /* Security green accent */
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            font-size: 1.5rem;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: background-color 0.3s ease;
            border-radius: 50%; /* Always round */
        }

        .search-toggle-button:hover {
            background-color: #45a049;
        }

        .floating-search-content {
            display: none;
            width: 100%;
        }

        .floating-search-container.expanded .floating-search-content {
            display: block;
        }

        .floating-search-content .search-bar-container {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            flex-direction: column;
        }
        
        .floating-search-content .search-bar-container input[type="text"] {
            flex-grow: 1;
            padding: 10px;
            border: 1px solid rgba(255,255,255,0.3);
            background-color: rgba(0,0,0,0.3);
            color: white;
            font-size: 1rem;
            width: 100%;
            border-radius: 6px;
        }

        .floating-search-content .search-bar-container button {
            padding: 10px 20px;
            background-color: #00bcd4; /* Light blue accent */
            color: white;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s ease;
            width: 100%;
            border-radius: 6px;
        }

        .floating-search-content .search-bar-container button:hover {
            background-color: #0097a7;
        }

        /* Close button for expanded search */
        .floating-search-close {
            color: #aaa;
            align-self: flex-end;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            margin-bottom: 10px;
            display: none;
        }

        .floating-search-container.expanded .floating-search-close {
            display: block;
        }

        .floating-search-close:hover {
            color: white;
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .main-branches {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .modal-content {
                width: 95%;
                margin: 10% auto;
                padding: 20px;
            }
            .floating-search-container.expanded {
                width: 90%;
                right: 5%;
                bottom: 10%;
            }
            .floating-search-content .search-bar-container {
                flex-direction: column;
            }
            .news-section {
                padding: 15px;
            }
            .central-node {
                font-size: 1.2rem;
                padding: 15px 30px;
            }
            .branch-header {
                font-size: 1.1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🔒 Comprehensive Organizational Security</h1>
        
        <div class="mindmap">
            <div class="central-node">
                Defense in Depth
            </div>
            	 
	<!-- Back to Landing Page Button -->
    <a href="./index.html" class="fixed top-4 left-4 z-50 bg-purple-700 text-white py-2 px-4 rounded-lg shadow-lg hover:bg-purple-800 transition duration-300 ease-in-out text-lg font-bold">
        &larr; Back to Hub
    </a>
	
            <div class="main-branches">
                <!-- Perimeter Security -->
                <div class="branch" onclick="toggleBranch('perimeter-security')">
                    <div class="branch-header">
                        <span class="branch-icon">🛡️</span>
                        Perimeter Security
                    </div>
                    <div id="perimeter-security" class="sub-services">
                        <div class="category-item" onclick="showCategoryDetails('firewalls')">
                            <div class="category-name">Firewalls (Network Layer)</div>
                            <div class="category-desc">Controls network traffic at the border.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('ips')">
                            <div class="category-name">Intrusion Prevention Systems (IPS)</div>
                            <div class="category-desc">Detects and blocks intrusion attempts.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('ddos')">
                            <div class="category-name">Distributed Denial of Service (DDoS) Protection</div>
                            <div class="category-desc">Safeguards services from traffic overloads.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('waf')">
                            <div class="category-name">Web Application Firewalls (WAF)</div>
                            <div class="category-desc">Protects web apps from exploits.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('dmz')">
                            <div class="category-name">Demilitarized Zone (DMZ)</div>
                            <div class="category-desc">Isolates public-facing services.</div>
                        </div>
                    </div>
                </div>

                <!-- Network Security (Internal) -->
                <div class="branch" onclick="toggleBranch('network-internal-security')">
                    <div class="branch-header">
                        <span class="branch-icon">🌐</span>
                        Network Security (Internal)
                    </div>
                    <div id="network-internal-security" class="sub-services">
                        <div class="category-item" onclick="showCategoryDetails('network-segmentation')">
                            <div class="category-name">Network Segmentation</div>
                            <div class="category-desc">Divides network into isolated segments.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('ids')">
                            <div class="category-name">Intrusion Detection Systems (IDS)</div>
                            <div class="category-desc">Monitors traffic for suspicious activity.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('vpn')">
                            <div class="category-name">Virtual Private Networks (VPN)</div>
                            <div class="category-desc">Creates secure connections over public networks.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('dns-security')">
                            <div class="category-name">DNS Security</div>
                            <div class="category-desc">Protects against DNS-based attacks.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('nac')">
                            <div class="category-name">Network Access Control (NAC)</div>
                            <div class="category-desc">Restricts network access based on policy.</div>
                        </div>
                    </div>
                </div>

                <!-- Endpoint Security -->
                <div class="branch" onclick="toggleBranch('endpoint-security')">
                    <div class="branch-header">
                        <span class="branch-icon">💻</span>
                        Endpoint Security
                    </div>
                    <div id="endpoint-security" class="sub-services">
                        <div class="category-item" onclick="showCategoryDetails('antivirus')">
                            <div class="category-name">Antivirus/Anti-malware</div>
                            <div class="category-desc">Detects and removes malicious software.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('edr')">
                            <div class="category-name">Endpoint Detection and Response (EDR)</div>
                            <div class="category-desc">Monitors endpoints for advanced threats.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('patch-management')">
                            <div class="category-name">Patch Management</div>
                            <div class="category-desc">Keeps software updated to fix vulnerabilities.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('dlp')">
                            <div class="category-name">Data Loss Prevention (DLP)</div>
                            <div class="category-desc">Prevents sensitive data from leaving.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('endpoint-firewall')">
                            <div class="category-name">Endpoint Firewall</div>
                            <div class="category-desc">Controls network connections on devices.</div>
                        </div>
                    </div>
                </div>

                <!-- Application Security -->
                <div class="branch" onclick="toggleBranch('application-security')">
                    <div class="branch-header">
                        <span class="branch-icon">⚙️</span>
                        Application Security
                    </div>
                    <div id="application-security" class="sub-services">
                        <div class="category-item" onclick="showCategoryDetails('ssdlc')">
                            <div class="category-name">Secure Software Development Lifecycle (SSDLC)</div>
                            <div class="category-desc">Integrates security into development.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('sast')">
                            <div class="category-name">Static Application Security Testing (SAST)</div>
                            <div class="category-desc">Analyzes code for vulnerabilities without execution.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('dast')">
                            <div class="category-name">Dynamic Application Security Testing (DAST)</div>
                            <div class="category-desc">Tests running apps for vulnerabilities.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('iast')">
                            <div class="category-name">Interactive Application Security Testing (IAST)</div>
                            <div class="category-desc">Combines SAST/DAST for accurate runtime analysis.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('rasp')">
                            <div class="category-name">Runtime Application Self-Protection (RASP)</div>
                            <div class="category-desc">Applications protect themselves in real-time.</div>
                        </div>
                    </div>
                </div>

                <!-- Data Security -->
                <div class="branch" onclick="toggleBranch('data-security')">
                    <div class="branch-header">
                        <span class="branch-icon">🗄️</span>
                        Data Security
                    </div>
                    <div id="data-security" class="sub-services">
                        <div class="category-item" onclick="showCategoryDetails('encryption')">
                            <div class="category-name">Encryption</div>
                            <div class="category-desc">Transforms data to prevent unauthorized access.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('data-masking')">
                            <div class="category-name">Data Masking/Tokenization</div>
                            <div class="category-desc">Obscures sensitive data.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('data-backup')">
                            <div class="category-name">Data Backup and Recovery</div>
                            <div class="category-desc">Creates redundant data copies.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('database-security')">
                            <div class="category-name">Database Security</div>
                            <div class="category-desc">Protects databases from attacks.</div>
                        </div>
                    </div>
                </div>

                <!-- Identity & Access Management (IAM) -->
                <div class="branch" onclick="toggleBranch('iam-security')">
                    <div class="branch-header">
                        <span class="branch-icon">🔑</span>
                        Identity & Access Management (IAM)
                    </div>
                    <div id="iam-security" class="sub-services">
                        <div class="category-item" onclick="showCategoryDetails('user-authentication')">
                            <div class="category-name">User Authentication</div>
                            <div class="category-desc">Verifies user identity.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('authorization')">
                            <div class="category-name">Authorization (Access Control)</div>
                            <div class="category-desc">Determines permitted actions.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('directory-services')">
                            <div class="category-name">Directory Services</div>
                            <div class="category-desc">Centralizes identity management.</div>
                        </div>
                    </div>
                </div>

                <!-- Security Operations & Monitoring -->
                <div class="branch" onclick="toggleBranch('secops-monitoring')">
                    <div class="branch-header">
                        <span class="branch-icon">👁️‍🗨️</span>
                        Security Operations & Monitoring
                    </div>
                    <div id="secops-monitoring" class="sub-services">
                        <div class="category-item" onclick="showCategoryDetails('siem')">
                            <div class="category-name">Security Information and Event Management (SIEM)</div>
                            <div class="category-desc">Centralizes log analysis and alerting.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('soar')">
                            <div class="category-name">Security Orchestration, Automation, and Response (SOAR)</div>
                            <div class="category-desc">Automates incident response workflows.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('tip')">
                            <div class="category-name">Threat Intelligence Platforms (TIP)</div>
                            <div class="category-desc">Aggregates and disseminates threat data.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('vulnerability-management')">
                            <div class="category-name">Vulnerability Management</div>
                            <div class="category-desc">Identifies and remediates security flaws.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('incident-response')">
                            <div class="category-name">Incident Response (IR) Platform</div>
                            <div class="category-desc">Manages security incident lifecycle.</div>
                        </div>
                    </div>
                </div>

                <!-- Governance, Risk, and Compliance (GRC) -->
                <div class="branch" onclick="toggleBranch('grc-framework')">
                    <div class="branch-header">
                        <span class="branch-icon">⚖️</span>
                        Governance, Risk, and Compliance (GRC)
                    </div>
                    <div id="grc-framework" class="sub-services">
                        <div class="category-item" onclick="showCategoryDetails('security-policies')">
                            <div class="category-name">Security Policies and Standards</div>
                            <div class="category-desc">Defines security rules and best practices.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('risk-management')">
                            <div class="category-name">Risk Management</div>
                            <div class="category-desc">Identifies and treats security risks.</div>
                        </div>
                        <div class="category-item" onclick="showCategoryDetails('compliance-management')">
                            <div class="category-name">Compliance Management</div>
                            <div class="category-desc">Ensures adherence to regulations.</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- News Letter Section -->
            <div class="news-section">
                <h2>General Cybersecurity News & Updates</h2>
                <ul id="news-list" style="list-style: none; padding: 0;">
                    <!-- News items will be loaded here by JavaScript -->
                    <li><div class="loading-indicator"></div> Loading latest cybersecurity news...</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Category Details Modal -->
    <div id="categoryModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <div id="modalContent"></div>
        </div>
    </div>

    <!-- Floating AI Search Bar -->
    <div id="floatingAISearch" class="floating-search-container">
        <button class="search-toggle-button" onclick="toggleFloatingSearch()">
            <span id="searchIcon">🔍</span>
        </button>
        <div class="floating-search-content">
            <span class="floating-search-close" onclick="toggleFloatingSearch()">&times;</span>
            <div class="search-bar-container">
                <input type="text" id="ai-search-input" placeholder="Ask Gemini AI about cybersecurity...">
                <button id="ai-search-button" onclick="performAISearch()">Search with AI ✨</button>
            </div>
            <div id="ai-search-output" class="llm-output-area">
                <!-- Search results will appear here -->
            </div>
        </div>
    </div>

    <script>
        // Data structure containing details for each security category
        const securityData = {
            'firewalls': {
                name: "Firewalls (Network Layer)",
                purpose: "To control incoming and outgoing network traffic based on predefined security rules, acting as a barrier between trusted and untrusted networks, and protecting internal assets.",
                features: [
                    { title: "Packet Filtering", desc: "Examines network packets at the network layer (Layer 3 and 4 of OSI model), inspecting source/destination IP addresses, ports, and protocols (e.g., TCP, UDP, ICMP). It makes basic allow/deny decisions based on these header fields. Can be stateless or stateful." },
                    { title: "Stateful Inspection", desc: "A more advanced technique that tracks the state of active network connections. It maintains a 'state table' to recognize legitimate return traffic and automatically allows it without explicit rules, significantly improving security posture and reducing administrative overhead. This prevents responses to valid internal requests from being blocked." },
                    { title: "Next-Generation Firewalls (NGFW)", desc: "These firewalls offer deeper packet inspection, extending beyond traditional port/protocol inspection to Layer 7 (Application Layer). They integrate features like intrusion prevention (IPS), application awareness (e.g., blocking specific apps like Facebook or Dropbox), identity awareness (user-based rules), and real-time threat intelligence feeds for proactive blocking of known malicious IPs/domains. NGFWs provide a more comprehensive security posture against modern threats." },
                    { title: "Proxy Services", desc: "Acts as an intermediary for requests from clients seeking resources from other servers. This can include web proxies, SOCKS proxies, or reverse proxies. Proxies provide an additional layer of anonymity, enforce content filtering, perform deep packet inspection, and can terminate SSL/TLS connections for further inspection, enhancing control and security over external communications." },
                    { title: "Cloud-Native Firewalls", desc: "Firewall services provided by cloud providers (e.g., AWS Network Firewall, Azure Firewall). These are fully managed, scalable, and integrate seamlessly with cloud environments, offering advanced threat protection, traffic filtering, and centralized management for cloud deployments. They simplify deployment and scaling of firewall capabilities within dynamic cloud infrastructures." }
                ],
                examples: [
                    "Configuring a firewall to block all incoming traffic to internal application servers except for connections originating from a trusted DMZ web server on port 443 (HTTPS).",
                    "Implementing an NGFW to apply content filtering policies, preventing employees from accessing gambling or illegal streaming sites during work hours, and detecting malware downloads.",
                    "Using a cloud firewall to centrally manage security policies across multiple virtual networks (VPCs) within a cloud environment, ensuring consistent enforcement."
                ],
                technicalDetails: "Firewalls operate primarily at OSI Layers 3 (Network) and 4 (Transport), but NGFWs extend up to Layer 7 (Application). They employ Access Control Lists (ACLs) for rule definition. Stateful firewalls track connection states (SYN, SYN-ACK, ACK). Deployment modes include 'routed mode' (Layer 3, IP routing) and 'transparent/bridge mode' (Layer 2, acts like a network switch without changing IP addresses).",
                tools: "Palo Alto Networks (e.g., FortiGate), Cisco ASA, pfSense (open source), Sophos Firewall, Check Point, AWS Network Firewall, Azure Firewall, Google Cloud Firewall."
            },
            'ips': {
                name: "Intrusion Prevention Systems (IPS)",
                purpose: "To actively detect and prevent intrusion attempts by analyzing network traffic or system activities for known malicious activity or policy violations, blocking suspicious traffic or activity in real-time before it reaches its target.",
                features: [
                    { title: "Signature-based Detection", desc: "Relies on a database of known attack patterns or 'signatures'. When incoming traffic matches a known signature (e.g., a specific malware byte sequence, a common exploit string), the IPS immediately blocks it. This method is highly effective against known threats but struggles with zero-day attacks." },
                    { title: "Anomaly-based Detection", desc: "Builds a baseline of 'normal' network or system behavior through machine learning and statistical analysis. Any significant deviation from this baseline is flagged as a potential threat. This approach is effective at detecting novel attacks and zero-days that lack specific signatures." },
                    { title: "Protocol Anomaly Detection", desc: "Identifies deviations from the proper usage and syntax of network protocols. For example, it might detect malformed packets, unusual command sequences, or non-compliant protocol headers that could indicate an exploit attempt leveraging protocol vulnerabilities." },
                    { title: "Policy-based Detection", desc: "Enforces organizational security policies by blocking traffic that violates predefined rules. This can include preventing unauthorized file transfers (e.g., specific file types or data content) or communication with blacklisted IP addresses/domains." },
                    { title: "Behavioral Analysis", desc: "Goes beyond simple signatures to analyze the actual behavior of network sessions or processes. It can detect suspicious sequences of actions, unusual access patterns, or malicious command execution that might not match a known signature but are indicative of an attack." }
                ],
                examples: [
                    "An IPS detecting and immediately blocking a multi-stage SQL injection attempt by identifying malformed SQL queries and subsequent suspicious database access patterns.",
                    "Preventing a buffer overflow exploit by detecting unusually long input strings directed at a web server that exceed expected legitimate lengths, indicative of an attempt to overwrite memory.",
                    "Stopping the spread of a newly emerged ransomware variant across the network by identifying its unique command-and-control (C2) communication patterns, even if its file hash is not yet in antivirus databases."
                ],
                technicalDetails: "IPS solutions are typically deployed inline (in-band), meaning all network traffic must pass through them, allowing for active blocking. They operate at various OSI model layers depending on the detection method, from Layer 2 up to Layer 7. Common evasion techniques include fragmentation, encryption, and polymorphism, which IPS systems use advanced methods (e.g., normalization, decryption, behavioral analysis) to counter.",
                tools: "Snort (open source IDS/IPS), Suricata (open source IDS/IPS), Cisco Firepower IPS, FortiGate IPS, Palo Alto Networks Threat Prevention."
            },
            'ddos': {
                name: "Distributed Denial of Service (DDoS) Protection",
                purpose: "To safeguard online services, websites, and network infrastructure from traffic overloads designed to exhaust resources, making services unavailable to legitimate users. It focuses on mitigating high-volume and sophisticated attack vectors.",
                features: [
                    { title: "Traffic Scrubbing", desc: "Diverts incoming network traffic through specialized 'scrubbing centers' or appliances. These centers analyze and filter out malicious DDoS traffic (e.g., spoofed packets, botnet floods) while forwarding legitimate, 'clean' traffic to the target servers. This protects the origin server from being directly overwhelmed." },
                    { title: "Rate Limiting", desc: "Controls the number of requests or connections allowed from a single source IP address, or to a specific resource, within a given time frame. This mitigates volumetric attacks by preventing a single attacker or bot from monopolizing resources, ensuring fair access for other users." },
                    { title: "Anycast Routing", desc: "A network routing strategy where multiple servers advertise the same IP address from different geographical locations. When a user sends a request, it is routed to the closest or best-performing server, distributing incoming traffic and making it significantly harder for attackers to overwhelm a single point of presence." },
                    { title: "Behavioral Analysis & Machine Learning", desc: "Continuously monitors traffic patterns to establish a baseline of normal behavior. It uses machine learning algorithms to identify abnormal traffic patterns that indicate a DDoS attack, even if new or complex attack vectors are used, allowing for detection of zero-day DDoS attacks." },
                    { title: "Layer 3/4 and Layer 7 Mitigation", desc: "Protects against a wide range of DDoS attack types: volumetric attacks (Layer 3/4, e.g., UDP floods, SYN floods) which overwhelm bandwidth, and application-layer attacks (Layer 7, e.g., HTTP floods, slowloris) which target application resources like web servers or APIs." }
                ],
                examples: [
                    "An online banking platform employing always-on DDoS mitigation to automatically detect and absorb large-scale volumetric attacks, ensuring continuous service availability during peak demand or an attack.",
                    "A gaming company utilizing DDoS protection to protect its game servers from application-layer attacks that exploit game logic or exhaust server CPU, preventing disruption to player experience.",
                    "An organization with a global web presence using Anycast routing to serve content from the closest data center to users, while simultaneously distributing potential DDoS attack traffic across multiple locations."
                ],
                technicalDetails: "DDoS protection often leverages large-scale cloud infrastructure and Content Delivery Networks (CDNs). Techniques involve BGP routing, traffic redirection (DNS changes or BGP advertisements), and specialized hardware/software appliances for packet inspection and filtering. Advanced methods include challenge-response mechanisms (e.g., CAPTCHA) for Layer 7 attacks, and stateful tracking for SYN flood protection.",
                tools: "Akamai Prolexic, Cloudflare DDoS Protection, AWS Shield (Standard/Advanced), Google Cloud Armor, Radware DefensePro, Arbor Networks."
            },
            'waf': {
                name: "Web Application Firewalls (WAF)",
                purpose: "To protect web applications specifically from common web exploits (e.g., SQL injection, cross-site scripting, broken authentication) that can compromise security or impact availability, focusing on inspecting and filtering HTTP/S traffic.",
                features: [
                    { title: "Application Layer Filtering", desc: "Inspects the content of HTTP/S requests and responses (Layer 7 of OSI model) for patterns indicative of web-specific attacks. It analyzes URL parameters, HTTP headers, cookies, and POST data to identify and block malicious payloads before they reach the web application." },
                    { title: "Customizable Rules & Rule Sets", desc: "Allows organizations to define specific security rules tailored to their unique web applications, business logic, and specific threats. Many WAFs also provide pre-built rule sets, such as those aligned with the OWASP ModSecurity Core Rule Set (CRS), offering immediate protection against common vulnerabilities." },
                    { title: "Bot Protection & Rate Limiting", desc: "Identifies and blocks malicious bots (e.g., credential stuffing bots, scrapers, vulnerability scanners) while allowing legitimate bot traffic (e.g., search engine crawlers). It can also apply rate limiting to prevent brute-force attacks or excessive requests from a single source." },
                    { title: "OWASP Top 10 Protection", desc: "Provides robust, built-in rules and capabilities to defend against the most critical web application security risks identified by OWASP (Open Web Application Security Project), including Injection, Broken Authentication, Sensitive Data Exposure, XML External Entities (XXE), and Security Misconfiguration." },
                    { title: "API Protection", desc: "Extends protection to APIs (REST, SOAP, GraphQL) by validating API requests and responses against defined schemas and behaviors, safeguarding backend services from API-specific attacks." }
                ],
                examples: [
                    "Deploying a WAF in front of an e-commerce website to detect and block SQL injection attempts made through product search queries or login forms.",
                    "Configuring a WAF to sanitize user input to prevent Cross-Site Scripting (XSS) attacks, where malicious scripts are embedded into comments or forums and executed in other users' browsers.",
                    "Using a WAF to implement adaptive rate limiting on a login page, automatically blocking IP addresses that exhibit an unusually high number of failed login attempts to prevent brute-force attacks."
                ],
                technicalDetails: "WAFs operate at Layer 7 (Application Layer). They can be deployed as network-based appliances, cloud-based services, or as software modules on a web server. They use a combination of signature matching (regex), anomaly detection (behavioral analysis), and positive security models (allow-listing known good inputs) for protection. They often perform SSL/TLS termination to inspect encrypted traffic.",
                tools: "Imperva WAF, F5 BIG-IP ASM, Cloudflare WAF, AWS WAF, Azure Application Gateway WAF, ModSecurity (open source)."
            },
            'dmz': {
                name: "Demilitarized Zone (DMZ)",
                purpose: "To create a secure buffer network segment between the organization's internal, trusted network and an untrusted external network (like the internet). It hosts publicly accessible services, isolating them to ensure that if a public service is compromised, the internal network remains protected from direct attacks.",
                features: [
                    { title: "Network Isolation", desc: "Services deployed within the DMZ are logically and often physically isolated from both the internal trusted network and the external untrusted network, typically by firewalls on both sides. This creates a multi-layered defense, preventing direct access to internal resources from the internet." },
                    { title: "Restricted Access & Controlled Flow", desc: "Strict firewall rules govern traffic flow into, within, and out of the DMZ. External users can only access specific DMZ services on defined ports, and DMZ services can only initiate communication with internal systems on very specific, limited ports and protocols (e.g., database access for a web server). This minimizes the attack surface and lateral movement." },
                    { title: "Public Service Hosting", desc: "The DMZ is the ideal location for hosting publicly accessible services such as web servers, email servers, DNS servers, VPN concentrators, and FTP servers. Placing these services in the DMZ exposes only the necessary systems to the internet, rather than the entire internal network." },
                    { title: "Intrusion Detection/Prevention Zones", desc: "Often, additional security controls like Intrusion Detection Systems (IDS) or Intrusion Prevention Systems (IPS) are strategically placed within the DMZ or between the DMZ and internal network to monitor for and block malicious activity targeting the public services or attempting to pivot inwards." }
                ],
                examples: [
                    "Placing an organization's public web server and its associated web application in a DMZ. If the web server is breached, attackers cannot directly access internal employee workstations or sensitive databases in the corporate LAN, as the internal firewall will block unauthorized traffic.",
                    "Hosting an email server and a spam filtering appliance in the DMZ to handle all external email traffic. Only filtered, legitimate email is then allowed to pass from the DMZ email server to the internal mail server for local mailboxes.",
                    "Providing external users access to a VPN concentrator located in the DMZ. Users first connect to the VPN in the DMZ, which then securely tunnels their authenticated and authorized traffic into specific segments of the internal network."
                ],
                technicalDetails: "DMZs are typically implemented using two firewalls ('three-legged DMZ' or 'back-to-back DMZ' architecture), or a single multi-homed firewall with three network interfaces (internal, external, and DMZ). Traffic filtering is based on source/destination IP, port, and protocol. Key principles include ensuring DMZ hosts have no direct access to the internal network (only specific, necessary connections) and applying the principle of least privilege to all DMZ-facing services.",
                tools: "Implemented via network segmentation and robust firewall configurations from vendors like Cisco, Palo Alto, Fortinet, Juniper. Requires careful network design and ACL management."
            },
            'network-segmentation': {
                name: "Network Segmentation",
                purpose: "To divide a computer network into smaller, isolated sub-networks or segments. The primary goals are to improve security by limiting the 'blast radius' of an attack, control traffic flow between different trust zones, and enhance network performance.",
                features: [
                    { title: "VLANs (Virtual Local Area Networks)", desc: "Logical grouping of network devices into separate broadcast domains, regardless of their physical cabling. VLANs are configured on network switches, allowing devices in different physical locations to be part of the same logical segment, or devices on the same physical switch to be in different logical segments. Traffic between VLANs typically requires a Layer 3 device (router/firewall) for routing and policy enforcement." },
                    { title: "Subnetting", desc: "Dividing a larger IP network into smaller, distinct sub-networks. Each subnet is defined by an IP address range and a subnet mask. Subnetting helps in organizing IP addresses, reducing network broadcast traffic, and creating a fundamental layer of logical separation. Traffic between subnets requires routing." },
                    { title: "Micro-segmentation", desc: "A more granular approach to network segmentation that isolates workloads down to the individual application or virtual machine level. Often implemented using software-defined networking (SDN) or host-based firewalls, micro-segmentation enforces 'zero-trust' principles by defining strict communication policies between individual application components, even within the same subnet." },
                    { title: "Firewall Rules & Access Control Lists (ACLs)", desc: "Internal firewalls, routers, or switches are used to implement Access Control Lists (ACLs) that define specific rules for traffic flow between network segments. These rules dictate which types of traffic (source, destination, port, protocol) are permitted or denied, enforcing separation and security policies." },
                    { title: "Zero-Trust Architecture", desc: "Network segmentation is a cornerstone of Zero-Trust. Instead of trusting internal network traffic implicitly, every connection attempt (even within the network) is verified based on identity, context, and policy before access is granted. Micro-segmentation is key to achieving this granular control." }
                ],
                examples: [
                    "Separating the finance department's network (VLAN 10) from the marketing department's network (VLAN 20) with firewall rules that only allow specific, authorized communication between them, thereby restricting access to sensitive financial data.",
                    "Isolating operational technology (OT) networks or Internet of Things (IoT) devices from the corporate IT network. This prevents an attack originating in a less secure IoT environment from directly impacting critical business systems.",
                    "Creating a separate 'guest Wi-Fi' network that is entirely isolated from the internal corporate network, routing all guest traffic directly to the internet and preventing access to internal resources."
                ],
                technicalDetails: "Network segmentation is achieved using Layer 2 (VLAN tagging on managed switches like IEEE 802.1Q), Layer 3 (IP subnetting and routing on routers or Layer 3 switches), and sometimes Layer 7 for application-aware segmentation. Technologies like VXLAN and NSX are used for advanced micro-segmentation in virtualized and cloud environments. It requires careful planning of IP addressing schemes, routing, and firewall policies.",
                tools: "Managed Network Switches (e.g., Cisco Catalyst, Juniper EX, Aruba Switches), Firewalls (e.g., Palo Alto, FortiGate, Cisco ASA), VMware NSX, Cisco ACI, Illumio, Guardicore (for micro-segmentation)."
            },
            'ids': {
                name: "Intrusion Detection Systems (IDS)",
                purpose: "To continuously monitor network traffic or system activities for suspicious patterns, anomalies, or known attack signatures. Unlike IPS, an IDS primarily *detects* and *alerts* security personnel to potential threats without actively blocking the traffic. It provides crucial visibility into potential compromises.",
                features: [
                    { title: "Signature-based Detection", desc: "Compares captured network traffic or system logs against a continuously updated database of known attack signatures. When a match is found (e.g., a specific malware payload, a known exploit string), an alert is generated. This is effective for widely known threats but less so for new, unknown attacks." },
                    { title: "Anomaly-based Detection", desc: "Builds a statistical baseline of 'normal' network or system behavior using machine learning and historical data. Any significant deviation from this baseline (e.g., unusual port activity, abnormal traffic volume, unexpected protocol usage) is flagged as an anomaly, potentially indicating a new or sophisticated attack." },
                    { title: "Network Traffic Analysis (NTA)", desc: "Monitors and analyzes network flows, metadata (e.g., source/destination IP, port, protocol, session duration), and sometimes full packet contents (deep packet inspection). NTA helps identify unusual communication patterns, suspicious protocols, or unauthorized access attempts that might evade signature-based detection." },
                    { title: "Host-based IDS (HIDS)", desc: "Deploys agents on individual hosts (servers, workstations) to monitor system calls, file system changes, registry modifications, application logs, and running processes for suspicious activity. HIDS is effective at detecting insider threats or malicious activity that has bypassed network-level defenses." },
                    { title: "Network-based IDS (NIDS)", desc: "Deploys sensors at strategic points within the network (e.g., egress points, critical segments) to monitor network traffic in promiscuous mode. NIDS analyzes packets for anomalies or signatures, providing a broad view of network-level threats." },
                    { title: "Alerting and Reporting", desc: "Generates alerts (email, SMS, SIEM integration) when a suspicious event is detected. Provides detailed logs and reports for forensic analysis, compliance auditing, and security posture assessment." }
                ],
                examples: [
                    "A NIDS detecting a comprehensive port scan activity originating from an internal workstation, indicating a potential compromised system or an insider threat attempting to map the internal network.",
                    "An IDS alerting on communication from an internal server to a known malicious IP address associated with a botnet command-and-control (C2) server, suggesting a malware infection.",
                    "A HIDS detecting unauthorized changes to critical system files or registry entries on a server, indicating a potential rootkit installation or privilege escalation attempt."
                ],
                technicalDetails: "IDS systems can be deployed out-of-band (promiscuous mode, mirroring traffic) or in-band (inline, but typically in 'monitor-only' mode for IDS). They use pattern matching, protocol parsers, and statistical analysis engines. A common challenge is 'alert fatigue' due to high volumes of false positives, necessitating careful tuning and integration with SIEM/SOAR platforms for context and automation.",
                tools: "Snort (open source), Suricata (open source), Zeek (formerly Bro, open source NIDS), Splunk Stream (for NTA), OSSEC (open source HIDS), Commercial IDS solutions (e.g., IBM QRadar Network Insights, Palo Alto Networks Threat Detection)."
            },
            'vpn': {
                name: "Virtual Private Networks (VPN)",
                purpose: "To create secure, encrypted connections ('tunnels') over a public, untrusted network (like the internet). This makes it appear as if the connection is part of a private, internal network, enabling secure remote access for users and secure site-to-site connectivity for branch offices.",
                features: [
                    { title: "Encryption", desc: "Protects data in transit using strong cryptographic protocols (e.g., IPsec, SSL/TLS, OpenVPN protocol, WireGuard). This ensures confidentiality and integrity, preventing eavesdropping, tampering, and man-in-the-middle attacks on data as it traverses public networks." },
                    { title: "Authentication", desc: "Verifies the identity of users, devices, or remote networks attempting to establish a VPN connection. This can involve usernames/passwords, multi-factor authentication (MFA), digital certificates, or pre-shared keys, ensuring only authorized entities can establish a tunnel." },
                    { title: "Tunneling", desc: "Encapsulates network packets within another packet, creating a secure 'tunnel' through the public internet. This allows the encapsulated, private network traffic to travel securely and appear as if it originated from within the private network, bypassing direct exposure to the internet." },
                    { title: "Data Integrity & Anti-Replay", desc: "Cryptographic hash functions are used to ensure that data has not been altered during transmission. Anti-replay mechanisms prevent attackers from retransmitting captured packets to gain unauthorized access or cause denial of service." },
                    { title: "Split Tunneling vs. Full Tunneling", desc: "Split tunneling routes only specific network traffic (e.g., corporate resources) through the VPN tunnel, while other traffic (e.g., internet browsing) goes directly. Full tunneling routes all network traffic through the VPN, enhancing security but potentially impacting performance." }
                ],
                examples: [
                    "A remote employee securely accessing internal company resources (e.g., file shares, internal applications, customer relationship management systems) from their home network or a public Wi-Fi hotspot.",
                    "Connecting two geographically separated branch offices securely over the internet (site-to-site VPN), allowing resources in each office to communicate as if they were on the same local network.",
                    "Allowing third-party vendors or contractors secure, limited access to specific internal systems or development environments for project collaboration, without exposing the entire network."
                ],
                technicalDetails: "VPNs primarily use IPsec (Internet Protocol Security) for site-to-site connections (Layer 3) or SSL/TLS (Secure Sockets Layer/Transport Layer Security) for remote access (Layer 4/7). IPsec operates in 'tunnel mode' or 'transport mode'. OpenVPN and WireGuard are popular open-source VPN protocols. VPNs typically involve a VPN server/concentrator at the network edge and VPN client software on user devices or routers at branch offices. Network Address Translation (NAT) is often used in conjunction with VPNs.",
                tools: "OpenVPN, Cisco AnyConnect, FortiClient VPN, Palo Alto GlobalProtect, WireGuard, NordLayer, Azure VPN Gateway, AWS Client VPN, StrongSwan (IPsec)."
            },
            'dns-security': {
                name: "DNS Security",
                purpose: "To protect against various DNS-based attacks (e.g., DNS spoofing, cache poisoning, domain generation algorithm (DGA) malware, DNS tunneling) and to control access to malicious or inappropriate domains at the DNS resolution level.",
                features: [
                    { title: "DNS Filtering", desc: "Blocks access to known malicious domains (e.g., phishing sites, malware command-and-control servers, botnet domains) or undesirable content categories (e.g., pornography, gambling, social media) by preventing their resolution. This acts as a first line of defense, stopping connections to harmful sites before they can even be established." },
                    { title: "DNSSEC (DNS Security Extensions)", desc: "Adds cryptographic signatures to DNS data to ensure the authenticity and integrity of DNS responses. It verifies that DNS records (e.g., A records for IP addresses) have not been tampered with and originate from authorized DNS servers, effectively preventing DNS spoofing and cache poisoning attacks." },
                    { title: "DNS Anomaly Detection", desc: "Continuously monitors DNS queries and responses for unusual patterns that might indicate malware activity (e.g., frequent queries for DGA-generated domains), data exfiltration attempts (DNS tunneling), or other suspicious behaviors that deviate from normal DNS traffic." },
                    { title: "Recursive DNS Protection", desc: "Secures the recursive DNS servers that client devices (e.g., workstations, mobile phones) use to resolve domain names. This includes protecting these servers from DDoS attacks, ensuring query integrity, and applying security policies before forwarding requests upstream." },
                    { title: "Response Policy Zones (RPZ)", desc: "A mechanism used by DNS servers to provide alternative responses to DNS queries based on locally defined policies. RPZs can be used to block access to malicious domains, redirect users to safe landing pages, or provide custom responses for specific queries." }
                ],
                examples: [
                    "Implementing DNS filtering across the corporate network to prevent employees from accidentally navigating to a phishing website, even if they click on a malicious link in an email.",
                    "Ensuring that internal systems do not communicate with known malware command-and-control infrastructure by resolving their domains to a blackhole IP address at the DNS level, effectively cutting off malware communication.",
                    "Protecting the organization's public DNS servers from cache poisoning attacks using DNSSEC. This ensures that users resolving the company's website domain always get the legitimate IP address, not a malicious one injected by an attacker.",
                    "Detecting DNS tunneling where attackers might be exfiltrating data over DNS queries, by identifying abnormally large or unusually structured DNS requests."
                ],
                technicalDetails: "DNS security operates at the application layer (Layer 7). DNSSEC uses public-key cryptography (digital signatures, trust anchors, chain of trust). DNS filtering relies on regularly updated threat intelligence feeds and blacklists, often implemented via recursive DNS resolvers. DNS anomaly detection uses behavioral analytics and machine learning to identify deviations from normal query patterns. RPZ utilizes domain name system protocol extensions to influence DNS resolution outcomes.",
                tools: "Cisco Umbrella (OpenDNS), Infoblox, Cloudflare DNS, Quad9, Google Public DNS (secure features), BIND (with DNSSEC support), Unbound DNS (with validation)."
            },
            'nac': {
                name: "Network Access Control (NAC)",
                purpose: "To restrict network access to devices that comply with defined security policies and to ensure only authorized users and devices (managed or unmanaged) can connect to the network. It enforces security posture and principle of least privilege at the point of network connection.",
                features: [
                    { title: "Authentication", desc: "Verifies the identity of users and devices trying to connect to the network. Common methods include IEEE 802.1X (port-based network access control), MAC Address Authentication Bypass (MAB) for non-802.1X devices, and web-based authentication for guest access. It ensures that only legitimate entities attempt to join the network." },
                    { title: "Authorization", desc: "Grants specific levels of network access based on the authenticated identity of the user/device and its security posture. This means a device might be placed into a specific VLAN, assigned certain firewall rules, or given limited bandwidth based on its compliance status or the user's role." },
                    { title: "Posture Assessment", desc: "Checks the 'health' and compliance of a device *before* granting it full network access. This involves verifying criteria such as up-to-date antivirus definitions, active personal firewalls, latest operating system patches, and disk encryption. Non-compliant devices can be quarantined or given restricted access until issues are remediated." },
                    { title: "Guest Access Management", desc: "Provides a secure, controlled, and often temporary way for visitors and personal devices (BYOD) to access the network with limited privileges, usually segregated from the corporate network. This often involves a captive portal for registration and acceptance of terms." },
                    { title: "Endpoint Remediation", desc: "For non-compliant devices, NAC can automatically trigger remediation actions. This might involve directing the user to a portal to download missing patches or antivirus updates, or placing the device in a dedicated quarantine VLAN with only access to remediation servers." },
                    { title: "Device Profiling", desc: "Automatically identifies and categorizes devices connecting to the network (e.g., IP phone, printer, IoT device, Windows laptop, Mac, mobile). This allows for context-aware policy application, assigning appropriate access based on device type." }
                ],
                examples: [
                    "When an employee's laptop attempts to connect to the corporate wired or wireless network, NAC checks to ensure its antivirus software is running and updated, and that the operating system has the latest security patches before granting full network access.",
                    "A contractor's personal device connecting to the network is authenticated and then placed in a highly restricted VLAN, granting them only the specific network access necessary for their project, segmented from sensitive internal resources.",
                    "An unauthorized device (e.g., a rogue personal laptop) attempting to connect to a corporate wired port is immediately detected by the NAC system and either blocked entirely or placed into a guest VLAN with no access to internal resources, triggering an alert to security operations."
                ],
                technicalDetails: "NAC systems typically integrate deeply with network infrastructure (switches, wireless access points, routers), directory services (e.g., Active Directory, LDAP) for identity, and RADIUS/TACACS+ for authentication and authorization. They can be agent-based (requiring software on endpoints) or agentless (using network scans, SNMP, NMAP). Policies are often centrally managed and pushed to enforcement points. Zero-Trust Network Access (ZTNA) is a more advanced evolution of NAC, focusing on identity-centric, adaptive access control.",
                tools: "Cisco Identity Services Engine (ISE), Aruba ClearPass, FortiNAC, Forescout CounterACT, InfoBlox (for IPAM/NAC integration)."
            },
            'antivirus': {
                name: "Antivirus/Anti-malware",
                purpose: "To protect individual endpoints (workstations, laptops, servers, mobile devices) by detecting, preventing, and removing malicious software (malware) such as viruses, worms, Trojans, ransomware, spyware, adware, and rootkits.",
                features: [
                    { title: "Signature-based Detection", desc: "The traditional and most common method. It scans files and processes, comparing them against a regularly updated database of known malware signatures (unique digital fingerprints). If a match is found, the malware is identified and remediated. Effective against known threats, but less so for new, unknown malware (zero-days)." },
                    { title: "Heuristic Analysis", desc: "Detects new or unknown malware by analyzing suspicious characteristics, behaviors, or code structures. Instead of relying on a direct signature match, it looks for actions that are *indicative* of malware (e.g., attempts to modify system files, encrypt data, or inject code into other processes). This helps catch polymorphic or obfuscated malware." },
                    { title: "Behavioral-based Detection", desc: "Monitors the real-time behavior of programs and processes on the endpoint. If a program exhibits suspicious or malicious actions (e.g., attempting to access protected memory, initiating unusual network connections, modifying critical system settings), it is flagged and potentially blocked, even if no known signature exists. Often incorporates machine learning." },
                    { title: "Real-time Scanning & Protection", desc: "Continuously monitors files as they are accessed, downloaded, or executed, as well as active processes and network connections. This provides immediate protection by detecting and blocking threats before they can cause harm, rather than relying on scheduled scans." },
                    { title: "Quarantine and Removal", desc: "When malware is detected, it is typically moved to a secure, isolated 'quarantine' area to prevent it from executing further or spreading. From quarantine, administrators can choose to safely delete the malware or attempt to clean/restore infected files." },
                    { title: "Rootkit Detection & Remediation", desc: "Specifically designed to identify and remove rootkits, which are malicious programs designed to hide their presence and activities on a system. Rootkit detection often involves deep kernel-level scanning and integrity checks." }
                ],
                examples: [
                    "An antivirus program automatically scanning an email attachment as soon as it's downloaded, detecting a known Trojan virus, and moving it to quarantine before the user can open it.",
                    "A behavioral-based anti-malware solution blocking a newly created executable from encrypting files on a laptop, identifying the suspicious encryption behavior as potential ransomware, even without a specific signature.",
                    "During a system scan, an antivirus tool detects and removes spyware that was silently collecting browsing history and transmitting it to an external server."
                ],
                technicalDetails: "Antivirus software typically operates at the kernel level of the operating system to intercept file system access, process execution, and network calls. They use various scanning engines (signature, heuristic, behavioral, sandboxing) and regularly update their definition files and behavioral models. Modern solutions often leverage cloud-based threat intelligence for rapid response to new threats and lighter endpoint footprint.",
                tools: "Microsoft Defender Antivirus (built-in), Symantec Endpoint Protection, McAfee Endpoint Security, CrowdStrike Falcon (next-gen AV features), SentinelOne, Avast, AVG, Malwarebytes."
            },
            'edr': {
                name: "Endpoint Detection and Response (EDR)",
                purpose: "To continuously monitor and collect granular data from endpoints (workstations, laptops, servers) to detect, investigate, and respond to advanced and emerging threats that traditional antivirus might miss. EDR provides deep visibility into endpoint activity and enables rapid incident response.",
                features: [
                    { title: "Behavioral Analysis & Anomaly Detection", desc: "Goes beyond signatures to analyze the entire context and sequence of endpoint events (process execution, file access, network connections, registry changes). It uses machine learning to identify anomalous or malicious patterns of behavior that indicate sophisticated attacks, including fileless malware, supply chain attacks, and insider threats." },
                    { title: "Threat Hunting Capabilities", desc: "Provides security analysts with tools and historical data to proactively search for undetected threats across endpoints. Analysts can run complex queries on collected telemetry data to look for Indicators of Compromise (IOCs) or Indicators of Attack (IOAs) that might signify a breach in progress." },
                    { title: "Automated & Manual Response Actions", desc: "Enables rapid response to detected threats. This can include automated actions like isolating a compromised endpoint from the network, killing malicious processes, or rolling back suspicious changes. It also supports manual response actions by security teams, such as remote shell access for deeper investigation." },
                    { title: "Deep Forensic Data Collection", desc: "Continuously collects and stores rich telemetry data from endpoints, including process command-line arguments, network connections, file hashes, registry changes, and user activity. This data is invaluable for detailed post-incident investigation, root cause analysis, and understanding the full scope and timeline of a breach." },
                    { title: "Centralized Visibility & Management", desc: "Provides a unified console for managing and monitoring all protected endpoints. This central view allows security teams to correlate events across multiple machines, understand attack paths, and deploy response actions uniformly." },
                    { title: "Threat Intelligence Integration", desc: "Integrates with internal and external threat intelligence feeds to enrich detected events with context about known adversaries, attack campaigns, and malware families, helping prioritize and understand threats." }
                ],
                examples: [
                    "An EDR system detecting a fileless malware attack that operates purely in memory (e.g., PowerShell script executing from an Office macro), as it observes suspicious process injection and network communication, even though no malicious file is written to disk.",
                    "A security analyst using EDR's threat hunting capabilities to proactively search for specific TTPs (Tactics, Techniques, and Procedures) associated with a recently disclosed APT (Advanced Persistent Threat) group across all corporate laptops, uncovering an early-stage compromise.",
                    "Upon detecting a suspicious ransomware-like activity, the EDR system automatically isolates the affected machine from the network, preventing the ransomware from spreading laterally, and provides a forensic timeline for immediate investigation."
                ],
                technicalDetails: "EDR typically employs agents deployed on each endpoint, which collect data at a low level (kernel, API hooks). This data is then sent to a cloud-based or on-premises analysis platform leveraging big data analytics, machine learning, and behavioral engines. Integration with SIEM (Security Information and Event Management) and SOAR (Security Orchestration, Automation, and Response) platforms is crucial for centralized alerting and automated response workflows. Endpoint isolation often utilizes host-based firewall rules.",
                tools: "CrowdStrike Falcon Insight, SentinelOne Singularity, Microsoft Defender for Endpoint, Carbon Black (VMware Carbon Black EDR), Cybereason Defense Platform, Sophos Intercept X with EDR."
            },
            'patch-management': {
                name: "Patch Management",
                purpose: "To systematically identify, acquire, test, and apply software updates (patches) and security fixes to all operating systems, applications, and firmware on endpoints and servers across an organization. This is crucial for closing known vulnerabilities that attackers could exploit.",
                features: [
                    { title: "Vulnerability Scanning & Assessment", desc: "Automated scanning capabilities to identify missing patches, outdated software versions, and security misconfigurations on systems and applications across the IT environment. It often integrates with vulnerability databases (e.g., CVE, NVD) to map identified issues to known vulnerabilities." },
                    { title: "Automated Patch Deployment", desc: "Automates the distribution and installation of patches to target endpoints and servers efficiently and on schedule. This minimizes manual effort, reduces human error, and ensures timely remediation, often with options for deployment groups and staggered rollouts." },
                    { title: "Reporting & Compliance", desc: "Provides comprehensive dashboards and reports on patch status, compliance levels, and remediation progress. This helps organizations demonstrate adherence to internal security policies and external regulatory requirements (e.g., PCI DSS, HIPAA, ISO 27001)." },
                    { title: "Patch Testing & Rollback Capabilities", desc: "Allows for testing patches in a non-production environment before widespread deployment to identify potential conflicts or instability. In case of issues, robust patch management solutions offer rollback capabilities to revert systems to their pre-patch state, minimizing downtime." },
                    { title: "Third-Party Application Patching", desc: "Goes beyond just operating system patches to include updates for common third-party applications (e.g., Adobe products, web browsers, Java runtime, productivity suites), which are frequent targets for attackers due to common vulnerabilities." },
                    { title: "Inventory Management", desc: "Maintains a comprehensive inventory of all software and hardware assets, enabling the system to accurately assess patching needs and deployment targets." }
                ],
                examples: [
                    "Automatically deploying the latest Windows security updates to all corporate laptops overnight, ensuring protection against a newly discovered critical vulnerability that affects the operating system, without disrupting employee work during business hours.",
                    "Scheduling weekly patch deployments for all Linux web servers in the staging environment, followed by a series of automated functional and security tests, before promoting the patches to production servers.",
                    "Generating a compliance report at the end of each quarter showing that all critical workstations and servers have maintained a patch level of less than 30 days old, satisfying an internal security audit requirement."
                ],
                technicalDetails: "Patch management systems often operate with a client-server architecture, where agents on endpoints communicate with a central server that retrieves patches from vendor repositories. They utilize asset inventory databases, vulnerability intelligence, and deployment scheduling engines. Integration with Configuration Management Databases (CMDBs) and IT Service Management (ITSM) systems is common. Orchestration tools are used for complex dependencies and sequencing of patches across different system types and applications.",
                tools: "Microsoft SCCM (Endpoint Configuration Manager), Tanium, Ivanti Patch Management, ManageEngine Patch Manager Plus, GFI LanGuard, Automox, PDQ Deploy, AWS Systems Manager Patch Manager."
            },
            'dlp': {
                name: "Data Loss Prevention (DLP)",
                purpose: "To prevent sensitive data from leaving the organization's control, whether accidentally (e.g., misconfigured email, lost laptop, accidental upload) or maliciously (e.g., insider theft, data exfiltration by malware). DLP solutions enforce policies to protect critical information wherever it resides or moves.",
                features: [
                    { title: "Content Inspection & Classification", desc: "Identifies sensitive data (e.g., credit card numbers, Social Security numbers, protected health information (PHI), proprietary intellectual property, GDPR/CCPA data) within files, emails, web traffic, and other communications. It uses various techniques: pattern matching (regex), keyword dictionaries, fuzzy matching (for variations), and data classification tags to accurately detect sensitive information." },
                    { title: "Policy Enforcement (Block, Encrypt, Alert)", desc: "Enforces predefined security policies by taking actions on data transfers that violate rules. Actions can include: **blocking** the transfer entirely, **encrypting** the data before it leaves, **alerting** security personnel to the violation, or **quarantining** the data for review. This prevents sensitive information from reaching unauthorized destinations." },
                    { title: "Channel Monitoring & Control", desc: "Monitors data movement across various egress channels, allowing control over where sensitive data can go. Channels include: email (outgoing messages/attachments), web uploads (cloud storage, webmail, social media), USB devices (copying to removable media), printers (printing sensitive documents), network shares, and cloud synchronization services." },
                    { title: "Endpoint DLP", desc: "Agent-based monitoring and control of data on individual workstations and laptops. It can prevent sensitive data from being copied to USB drives, printed, uploaded to personal cloud storage, or even pasted into unauthorized applications." },
                    { title: "Network DLP", desc: "Monitors data in motion across the network, typically at network egress points (e.g., proxies, email gateways). It inspects network traffic for sensitive data attempting to leave the corporate network." },
                    { title: "Cloud DLP", desc: "Focuses on monitoring and protecting sensitive data stored in and shared through cloud applications (SaaS, IaaS) and cloud storage services. It ensures compliance with data residency and privacy regulations in cloud environments." }
                ],
                examples: [
                    "Preventing an employee from emailing a spreadsheet containing customer credit card numbers to their personal email account, by automatically detecting the pattern and blocking the email.",
                    "Blocking the transfer of highly confidential project designs to a USB drive inserted into a corporate laptop, based on the file's classification tag or its content.",
                    "Alerting the security team when a large volume of sensitive customer Personally Identifiable Information (PII) is attempted to be uploaded to an unsanctioned public cloud storage service (e.g., a personal Dropbox account)."
                ],
                technicalDetails: "DLP solutions use content analysis engines to parse and inspect data. They often integrate with enterprise content management systems, identity management, and SIEMs for a holistic view. Data classification is crucial for effective DLP, often relying on user-applied tags, automated content analysis, or a combination. Enforcement points are distributed across endpoints, networks, and cloud access security brokers (CASBs).",
                tools: "Symantec DLP, Forcepoint DLP, Microsoft Purview (formerly Microsoft 365 DLP), McAfee DLP, Broadcom DLP, Digital Guardian, Securly (for educational environments)."
            },
            'endpoint-firewall': {
                name: "Endpoint Firewall",
                purpose: "To provide a host-based firewall that controls network connections for individual devices (laptops, desktops, servers), supplementing network-level firewalls by offering granular control over application-specific traffic and protecting the individual host from network-based threats.",
                features: [
                    { title: "Application-level Rules", desc: "Allows administrators to define specific rules for individual applications, controlling whether they can connect to the internet or internal network, and on which ports. This is more granular than network firewalls, which typically apply rules to IP addresses or subnets." },
                    { title: "Granular Control (Process/User)", desc: "Provides precise control over inbound and outbound traffic based on the specific process (executable), user, or port on the host machine. This means you can allow an application 'X' to communicate on port 80 but deny application 'Y' on the same port." },
                    { title: "Inbound/Outbound Filtering", desc: "Monitors both incoming connections attempting to access services on the endpoint and outgoing connections initiated by applications on the endpoint. This prevents unauthorized external access and also blocks malware from establishing outbound command-and-control (C2) connections or exfiltrating data." },
                    { title: "Stealth Mode & Port Blocking", desc: "Can hide the computer from network scans by not responding to probe requests, making it less discoverable to attackers. It can also block specific ports from being visible or accessible externally or internally." },
                    { title: "Integrity Checks", desc: "Some advanced endpoint firewalls can monitor the integrity of the applications they are protecting, ensuring that legitimate applications haven't been tampered with or injected with malicious code." }
                ],
                examples: [
                    "Configuring the Windows Defender Firewall on an employee's laptop to block all incoming connections except for those explicitly allowed for remote desktop access from IT's subnet.",
                    "Allowing a developer's Integrated Development Environment (IDE) to connect to a specific internal source code repository over Git (port 9418) but blocking all other outbound connections from the IDE to prevent accidental or malicious data leakage.",
                    "Using an endpoint firewall to prevent malware that has bypassed perimeter defenses from establishing outbound command-and-control connections from a compromised workstation to an external malicious IP address."
                ],
                technicalDetails: "Endpoint firewalls are typically integrated into the operating system (e.g., Windows Defender Firewall with Advanced Security, macOS built-in firewall, Linux `iptables`/`ufw`) or provided as a component within a comprehensive endpoint security suite (EPP/EDR). They operate at the network stack of the individual device, applying rules before packets leave or after they arrive at the network interface. They are often stateful, tracking connections for legitimate return traffic. Differences from network firewalls: Endpoint firewalls protect a single host, while network firewalls protect network segments or perimeters; endpoint firewalls have application-level awareness.",
                tools: "Windows Defender Firewall, macOS Firewall (built-in), Linux `iptables`/`nftables`/`ufw` (Uncomplicated Firewall), ZoneAlarm (consumer), Integrated components within EDR/EPP suites (e.g., CrowdStrike Falcon Firewall Management, SentinelOne Firewall)."
            },
            'ssdlc': {
                name: "Secure Software Development Lifecycle (SSDLC)",
                purpose: "To integrate security practices and considerations into every phase of the software development process, from initial requirements gathering and design to coding, testing, deployment, and ongoing maintenance. This proactive approach ensures security is 'built-in' from the start, rather than 'bolted on' as an afterthought.",
                features: [
                    { title: "Threat Modeling & Security Requirements", desc: "Systematically identifies potential threats and vulnerabilities early in the application's design phase. Using frameworks like STRIDE (Spoofing, Tampering, Repudiation, Information Disclosure, Denial of Service, Elevation of Privilege), teams define explicit security requirements and non-functional requirements (e.g., encryption standards, authentication strength) before development begins." },
                    { title: "Secure Design & Architecture Review", desc: "Reviews application designs and architectures to ensure security principles (e.g., least privilege, defense in depth, secure defaults) are incorporated. This includes reviewing data flows, authentication mechanisms, authorization models, and error handling strategies." },
                    { title: "Secure Coding Guidelines & Training", desc: "Provides developers with comprehensive best practices, coding standards, and rules for writing secure code. Regular training on common vulnerabilities (e.g., OWASP Top 10) and secure coding techniques is crucial to reduce the introduction of flaws." },
                    { title: "Security Testing Integration (SAST, DAST, IAST, Pen Testing)", desc: "Incorporates various security testing methodologies throughout the development and testing phases. **SAST** (Static Application Security Testing) analyzes code *before* execution. **DAST** (Dynamic Application Security Testing) tests running applications from the outside. **IAST** (Interactive Application Security Testing) combines aspects of both. **Penetration Testing** involves manual ethical hacking to find exploitable vulnerabilities prior to production." },
                    { title: "Security Gates & Milestones", desc: "Introduces mandatory security checkpoints at key stages of the SDLC (e.g., design approval, code freeze, pre-release). These gates require that certain security activities are completed and specific security criteria are met before moving to the next phase, preventing insecure code from progressing." },
                    { title: "Vulnerability Management & Remediation", desc: "Establishes a process for tracking, prioritizing, and remediating identified security flaws. This includes clear responsibilities for bug fixing, retesting, and ensuring vulnerabilities are closed in a timely manner, often integrated with bug tracking systems." }
                ],
                examples: [
                    "A development team performing threat modeling on a new microservice to identify potential data leakage points and injection vulnerabilities early in the design phase, leading to secure API design principles.",
                    "Integrating automated SAST scans into the Continuous Integration (CI) pipeline, so that every new code commit is automatically checked for common security flaws like SQL injection or cross-site scripting before it's merged to the main branch.",
                    "Mandating that all critical web applications undergo a DAST scan and a third-party penetration test before being deployed to the production environment, ensuring external-facing vulnerabilities are identified and fixed."
                ],
                technicalDetails: "SSDLC is a process framework rather than a single technology. It leverages various security testing tools (SAST, DAST, IAST), vulnerability scanners, and GRC platforms. Key frameworks adopted include OWASP SAMM (Software Assurance Maturity Model), BSIMM (Building Security In Maturity Model), and Microsoft's SDL. Automation tools like Jenkins, GitLab CI/CD, and AWS CodePipeline are used to integrate security checks into the CI/CD pipeline. Requires strong collaboration between development, security, and operations teams (DevSecOps).",
                tools: "Threat Modeling Tools (e.g., Microsoft Threat Modeling Tool, OWASP Threat Dragon), SAST Tools (e.g., Checkmarx, Fortify SCA, SonarQube), DAST Tools (e.g., OWASP ZAP, Burp Suite Pro, Acunetix), IAST Tools (e.g., Contrast Security), Pen Testing Services/Tools, Jira/Azure DevOps (for tracking), Jenkins/GitLab CI/CD (for automation), Security Training Platforms."
            },
            'sast': {
                name: "Static Application Security Testing (SAST)",
                purpose: "To analyze application source code, bytecode, or binary code for security vulnerabilities *without* actually executing the application. It's like checking the blueprint of a building for structural flaws before construction even begins, making it a 'white-box' testing method.",
                features: [
                    { title: "Early Detection in SDLC", desc: "Identifies vulnerabilities early in the development lifecycle (pre-production), even before the application is fully functional. This makes flaws cheaper and easier to fix, as they are caught when developers are actively working on the code, rather than later in testing or production." },
                    { title: "Code-level Visibility & Pinpointing", desc: "Provides detailed results, pinpointing the exact lines of code where vulnerabilities exist. This direct feedback is highly valuable for developers, allowing them to quickly understand and remediate the identified security flaws." },
                    { title: "Comprehensive Code Path Coverage", desc: "Can analyze all possible code paths, including those that might not be reachable during dynamic testing or typical functional use. This allows SAST to uncover vulnerabilities in rarely used or legacy code that might otherwise remain hidden." },
                    { title: "Support for Multiple Languages & Frameworks", desc: "Most enterprise SAST tools support a wide array of programming languages (e.g., Java, .NET, C++, Python, JavaScript, Go) and common frameworks, making them versatile for diverse development environments." },
                    { title: "Integration with Development Tools", desc: "Often integrates directly into Integrated Development Environments (IDEs), version control systems (VCS), and Continuous Integration/Continuous Delivery (CI/CD) pipelines. This enables developers to run scans as part of their regular workflow and receive immediate security feedback." }
                ],
                examples: [
                    "A SAST tool scanning a new Java web application's source code nightly and flagging potential SQL injection vulnerabilities in specific database query methods within the backend code.",
                    "During a code review process, a SAST tool identifies hardcoded credentials or insecure cryptographic algorithm usage within a mobile application's codebase, prompting the developer to use a secrets management solution.",
                    "Integrating SAST scans into a CI/CD pipeline: every time a developer commits new code, an automated SAST scan is triggered. If critical vulnerabilities are found, the build fails, preventing insecure code from being merged into the main branch."
                ],
                technicalDetails: "SAST tools perform various analyses: **Lexical Analysis** (breaking code into tokens), **Parsing** (building abstract syntax trees), **Control Flow Analysis** (mapping execution paths), and **Data Flow Analysis** (tracking data origins and transformations). They can employ different analysis techniques like **Pattern Matching** (for known vulnerable code patterns), **Taint Analysis** (tracking untrusted input to sensitive sinks), and **Semantic Analysis** (understanding code meaning). A key challenge for SAST is a potentially high false positive rate, requiring tuning and manual review to validate findings.",
                tools: "Checkmarx CxSAST, Fortify Static Code Analyzer (SCA), SonarQube (open source with security plugins), Veracode Static Analysis, GitLab SAST, Snyk Code."
            },
            'dast': {
                name: "Dynamic Application Security Testing (DAST)",
                purpose: "To test applications for vulnerabilities by simulating attacks against a *running* application from the outside, observing its behavior and responses. It's like trying to break into a locked house without knowing its internal layout, making it a 'black-box' testing method.",
                features: [
                    { title: "Black-box Testing & Runtime Vulnerability Detection", desc: "Does not require access to the application's source code, making it suitable for testing third-party applications, APIs, or applications already deployed in production. It identifies vulnerabilities that manifest at runtime, such as configuration errors, server-side issues, authentication flaws, and issues arising from the interaction of different components." },
                    { title: "Coverage of OWASP Top 10 & Business Logic Flaws", desc: "Highly effective at finding common web application vulnerabilities listed in the OWASP Top 10, including Injection flaws (SQL, Command), Broken Authentication and Session Management, Cross-Site Scripting (XSS), Insecure Direct Object References (IDOR), and Security Misconfiguration. It can also uncover certain business logic flaws by observing application behavior." },
                    { title: "Web Application & API Scanning", desc: "Specifically designed to interact with web applications via HTTP/S, crawling all accessible links and forms to discover potential attack vectors. Modern DAST tools also offer robust API scanning capabilities, testing REST, SOAP, and GraphQL APIs for vulnerabilities." },
                    { title: "Passive and Active Scanning", desc: "Can operate in 'passive' mode by analyzing normal application traffic (e.g., through a proxy) to identify potential vulnerabilities without sending active attack payloads. In 'active' mode, it sends various attack payloads (e.g., malformed inputs, special characters) to provoke vulnerabilities." },
                    { title: "Integration with CI/CD & Reporting", desc: "Can be integrated into CI/CD pipelines (typically after a build or deployment to a test environment) to provide automated runtime security feedback. Generates reports detailing identified vulnerabilities, severity, and sometimes remediation guidance." }
                ],
                examples: [
                    "Scanning a live e-commerce website to discover Cross-Site Scripting (XSS) vulnerabilities in product review forms, where malicious JavaScript could be injected and affect other users.",
                    "Testing an application's authentication mechanism for common weaknesses like weak password enforcement, session fixation, or insecure password reset flows by attempting various login and session manipulation techniques.",
                    "Running a DAST scan against a newly deployed API endpoint to discover if it's vulnerable to SQL injection or improper access control, even without having access to the API's underlying code."
                ],
                technicalDetails: "DAST tools typically function as web application vulnerability scanners. They first 'crawl' the application to discover all accessible pages and parameters, then send various attack payloads (e.g., fuzzing, SQL injection payloads, XSS vectors) to identified input points. They analyze the application's responses (HTTP status codes, error messages, content changes) to infer vulnerabilities. A challenge with DAST is its inability to see internal code logic, potentially leading to false negatives (missed vulnerabilities) or requiring extensive manual configuration for complex applications. It also cannot test un-executed code paths.",
                tools: "OWASP ZAP (open source), Acunetix, Burp Suite Professional, Qualys Web Application Scanning (WAS), IBM AppScan Standard, Netsparker (Invicti), HCL AppScan."
            },
            'iast': {
                name: "Interactive Application Security Testing (IAST)",
                purpose: "To combine the strengths of SAST and DAST, running within the application's runtime environment (e.g., web server, application server) to analyze code and traffic for vulnerabilities with high accuracy and low false positives. It's often called 'grey-box' testing because it has some internal visibility.",
                features: [
                    { title: "Hybrid Analysis & Runtime Visibility", desc: "Deploys an agent or 'instrumentation' within the running application (similar to DAST's runtime aspect) but also monitors internal application execution, data flow, and code paths (similar to SAST's code-level view). This hybrid approach provides deep insights into how the application processes data and executes code in response to user input." },
                    { title: "Real-time Feedback in Development/QA", desc: "Provides immediate security feedback to developers and QA teams during functional testing. As testers or automated tests interact with the application, IAST automatically identifies vulnerabilities when they are triggered by normal application usage, allowing for rapid remediation." },
                    { title: "High Accuracy & Low False Positives", desc: "Because it observes actual data flow (taint tracking) and code execution, IAST can confirm vulnerabilities with much higher accuracy than SAST or DAST alone. It can differentiate between exploitable and non-exploitable findings, significantly reducing false alarms." },
                    { title: "Context-aware Vulnerability Detection", desc: "Deeply understands the application's unique logic, libraries, and frameworks. This context-awareness allows it to make more intelligent vulnerability detections, providing precise remediation guidance, including the exact line of code and the full call stack where the vulnerability originated." },
                    { title: "Coverage Beyond OWASP Top 10", desc: "While covering OWASP Top 10, IAST can also detect more complex, subtle vulnerabilities such as insecure deserialization, business logic flaws, or issues arising from misconfigurations that might be challenging for traditional SAST/DAST tools to find." }
                ],
                examples: [
                    "A developer running automated unit tests or integration tests on a new feature, and the IAST tool running alongside the application server automatically detects a SQL injection vulnerability that is only triggered when a specific, complex input path is followed during the test.",
                    "During a quality assurance (QA) team's regular functional testing of a web application, the IAST agent identifies an insecure deserialization flaw by observing how data is processed within the application's Java Virtual Machine (JVM) during runtime, providing immediate alert and remediation details.",
                    "An IAST tool integrated into a CI/CD pipeline provides real-time security feedback during the staging environment's automated functional tests. It flags an access control vulnerability only when a specific user role attempts to access an unauthorized resource, showing the exact code path involved."
                ],
                technicalDetails: "IAST solutions typically involve instrumenting the application's runtime environment (e.g., Java Virtual Machine, .NET Common Language Runtime, Python interpreter) with an agent. This agent monitors application code execution, library calls, data flow (taint tracking from untrusted sources to sensitive sinks), and HTTP/S traffic. It then uses algorithms to correlate runtime observations with known vulnerability patterns. IAST is particularly effective for web applications and APIs. It complements SAST (for early, broad coverage) and DAST (for external view, config issues).",
                tools: "Contrast Security, HCL AppScan (with IAST capabilities), Synopsis Seeker, Veracode (with IAST module), Checkmarx (with CxIAST)."
            },
            'rasp': {
                name: "Runtime Application Self-Protection (RASP)",
                purpose: "To integrate security directly into the application's runtime environment, enabling it to 'self-protect' against attacks by analyzing incoming requests and application behavior in real-time. Unlike WAFs which protect from the outside, RASP protects *from within* the application itself.",
                features: [
                    { title: "Real-time, In-Application Protection", desc: "Blocks attacks as they occur by understanding the application's internal workings. RASP sits inside the application runtime (e.g., JVM, .NET CLR) and monitors interactions between users, the application, and data in real-time, preventing malicious inputs from reaching vulnerable code paths." },
                    { title: "Context-Aware Threat Prevention", desc: "Deeply integrated with the application, RASP understands the legitimate behavior and context of API calls, data access, and process execution. This allows it to distinguish between legitimate and malicious activity with high accuracy, leading to very low false positives compared to network-level security tools like WAFs." },
                    { title: "Zero-Day Attack Protection", desc: "Because it analyzes application behavior rather than relying solely on signatures, RASP can detect and block zero-day exploits and novel attack techniques that traditional security solutions might miss, providing a strong last line of defense." },
                    { title: "Language & Framework Agnostic (Runtime Dependent)", desc: "Can protect applications built on various programming languages and frameworks, as long as it supports the underlying runtime environment. It operates at a low level within the runtime, intercepting operations before they are executed." },
                    { title: "Reduced False Positives & Simplified Management", desc: "Due to its deep insight into application logic, RASP generates fewer false alarms. It also requires less tuning than WAFs or IPS systems, simplifying management and reducing alert fatigue for security teams." },
                    { title: "Compliance & Logging", desc: "Provides detailed logs of blocked attacks and policy violations, aiding in forensic analysis and demonstrating compliance with security regulations." }
                ],
                examples: [
                    "A RASP solution integrated into a Java web application detects and immediately blocks a zero-day exploit attempt that tries to leverage an unknown vulnerability in a third-party library, preventing the exploit from reaching its target within the application code.",
                    "Preventing a command injection attack where an attacker attempts to execute system commands through a web input field. RASP intercepts the malicious command before it's passed to the operating system, even if the application's input validation is flawed.",
                    "Protecting a critical API endpoint from business logic flaws or API abuse. RASP identifies anomalous sequences of API calls or unauthorized data access based on the application's expected behavior, stopping the attack in real-time."
                ],
                technicalDetails: "RASP typically involves deploying an agent (e.g., a JAR file for Java, a DLL for .NET) that 'instruments' the application's runtime. This instrumentation allows RASP to intercept function calls, data inputs, and system interactions within the application process. It performs real-time analysis using a combination of static analysis (of the loaded code), dynamic analysis (of runtime behavior), and threat intelligence. Upon detecting a threat, RASP can terminate the execution, sanitize inputs, or return a custom error message to the client. It differs from WAF by operating *within* the application, providing deeper context and preventing attacks that have already bypassed network defenses.",
                tools: "Contrast Security (Contrast Protect), Signal Sciences (now Fastly), Sqreen (now Datadog), Waratek, WhiteHat Security (acquired by Synopsis, now part of Synopsys Application Security)."
            },
            'encryption': {
                name: "Encryption",
                purpose: "To transform data into an unreadable format (ciphertext) using cryptographic algorithms and keys. Its primary purpose is to ensure the confidentiality and integrity of data, protecting it from unauthorized access, disclosure, or modification throughout its lifecycle (at rest, in transit, and in use).",
                features: [
                    { title: "Encryption at Rest", desc: "Protects data when it is stored on physical media or in databases. This includes full disk encryption (FDE) for laptops/servers, database encryption (e.g., Transparent Data Encryption - TDE for SQL Server, Oracle TDE), and encryption of data in cloud storage buckets (e.g., AWS S3 SSE). Even if storage media are stolen, the data remains unreadable without the decryption key." },
                    { title: "Encryption in Transit", desc: "Secures data as it moves across networks (e.g., between a client and a server, between two data centers, or across the internet). This is typically achieved using secure communication protocols like TLS/SSL for HTTPS traffic, IPsec for VPNs, and SSH for secure remote access. It prevents eavesdropping and tampering during transmission." },
                    { title: "Encryption in Use (Confidential Computing)", desc: "An emerging field that protects data while it is being processed in memory or CPU. Technologies like Intel SGX (Software Guard Extensions) and AMD SEV (Secure Encrypted Virtualization) create secure enclaves or virtual machines where data remains encrypted even when loaded into RAM, protecting it from insider threats or malicious software on the host system." },
                    { title: "Key Management & Key Management Systems (KMS)", desc: "The secure generation, storage, distribution, rotation, and revocation of cryptographic keys are paramount. A robust Key Management System (KMS) ensures that keys are protected, highly available, and used only by authorized entities. Hardware Security Modules (HSMs) are often used to provide a high level of security for cryptographic key operations and storage." },
                    { title: "Symmetric vs. Asymmetric Encryption", desc: "**Symmetric encryption** uses the same key for both encryption and decryption (e.g., AES-256). It's fast and efficient, used for bulk data encryption. **Asymmetric encryption** (or public-key cryptography) uses a pair of mathematically related keys: a public key for encryption and a private key for decryption (e.g., RSA, ECC). It's slower but enables secure key exchange, digital signatures, and non-repudiation." }
                ],
                examples: [
                    "Encrypting all customer credit card numbers stored in a production database using AES-256 encryption, so that even if the database file is compromised, the sensitive payment data remains unreadable.",
                    "Enforcing HTTPS for all website traffic, ensuring that all communication (user login credentials, browsing data) between users' browsers and the web server is encrypted and protected from interception.",
                    "Implementing full disk encryption (FDE) on all company laptops and external hard drives to protect sensitive corporate data in case a device is lost or stolen, making the data inaccessible to unauthorized individuals."
                ],
                technicalDetails: "Encryption relies on complex mathematical algorithms (e.g., AES, RSA, ECC, SHA) and cryptographic protocols (TLS, IPsec, SSH). Key lengths (e.g., 256-bit for AES, 2048-bit for RSA) and algorithm strength are critical for security. Key management involves storing keys securely (e.g., in FIPS 140-2 validated HSMs or secure cloud KMS services), regular key rotation, and strict access controls. Data de-duplication and compression can be applied to encrypted data but must be carefully managed to avoid security risks.",
                tools: "AWS KMS, Azure Key Vault, Google Cloud KMS, HashiCorp Vault, Fortanix DSM, VeraCrypt (FDE), OpenSSL, various database-native encryption features (Oracle TDE, SQL Server TDE)."
            },
            'data-masking': {
                name: "Data Masking/Tokenization",
                purpose: "To obscure sensitive data to protect it while still allowing it to be used for non-production purposes (e.g., testing, development, analytics, training) where the original, real sensitive data is not strictly required. This helps reduce the risk of sensitive data exposure in non-production environments.",
                features: [
                    { title: "Static Data Masking (SDM)", desc: "Applied to data in non-production environments (e.g., development, testing, training databases, QA environments). The masked data is permanently altered and cannot be unmasked back to its original sensitive form. SDM techniques include scrambling, shuffling, substitution (replacing real names with fictional ones), nulling out (removing data), or format-preserving encryption (data looks real but is encrypted)." },
                    { title: "Dynamic Data Masking (DDM)", desc: "Masks data on-the-fly, in real-time, when it is queried. The original sensitive data in the production database remains unchanged, but a masked version is shown only to users who lack permissions to see the original data. This is often used for scenarios like call center agents who need to see some data but not full credit card numbers." },
                    { title: "Tokenization", desc: "Replaces sensitive data (e.g., credit card numbers, national identification numbers) with a non-sensitive, randomly generated 'token'. This token retains the format and type of the original data but holds no intrinsic value. The original sensitive data is stored securely and separately in a highly protected 'token vault', minimizing the scope of PCI DSS or other compliance audits." },
                    { title: "Format Preservation", desc: "A key aspect where the masked data retains the original data type and format. For example, masked credit card numbers still look like valid credit card numbers (e.g., 4xxx-xxxx-xxxx-1234), and masked email addresses still follow email address syntax. This ensures applications can still function correctly with the masked data." },
                    { title: "Referential Integrity & Consistency", desc: "Ensures that masked data remains consistent across multiple interconnected databases and applications. For example, if a customer's name is masked in one database, it will be consistently masked in all other related databases, maintaining data relationships for testing purposes." }
                ],
                examples: [
                    "Providing development teams with a masked version of a production customer database for testing new features. All customer names, addresses, and credit card numbers are replaced with realistic but fictional data, ensuring developers never handle real sensitive customer information.",
                    "A call center application implementing dynamic data masking to display only the last four digits of a customer's credit card number to a support agent, while the full number is tokenized and stored securely in a vault, fulfilling PCI DSS requirements.",
                    "An analytics team needing to run queries on employee salary data. Data masking replaces actual salaries with statistically valid but non-real values, allowing analysis without exposing individual compensation details."
                ],
                technicalDetails: "Data masking techniques involve cryptographic transformations, statistical methods, or dictionary lookups. SDM often uses a one-way hash or encryption with a fixed key for irreversible masking, or format-preserving encryption for reversible but secure masking. DDM is typically implemented at the database layer (e.g., SQL views, database proxies) or application layer. Tokenization requires a secure token vault (often an HSM) and a tokenization engine to map sensitive data to tokens and vice-versa. Standards like PCI DSS often mandate tokenization for payment card data.",
                tools: "IBM Optim Data Privacy, Delphix, Micro Focus Voltage SecureData, Informatica Data Masking, Broadcom Test Data Manager, Imperva Data Security."
            },
            'data-backup': {
                name: "Data Backup and Recovery",
                purpose: "To create redundant copies of data and systems that can be restored in the event of data loss, corruption, cyberattack (e.g., ransomware), accidental deletion, or a major disaster. The ultimate goal is to ensure business continuity and minimize data loss and downtime.",
                features: [
                    { title: "Regular & Automated Backups", desc: "Automated and scheduled processes to create copies of data at defined intervals (e.g., hourly, daily, weekly). This can include full backups (entire dataset), incremental backups (only data changed since last full/incremental), and differential backups (data changed since last full backup)." },
                    { title: "Offsite/Cloud Storage", desc: "Storing backup copies in a separate, geographically distant, and secure location, preferably in a different fault domain or cloud region. This protects against localized disasters (e.g., fire, flood) that could affect both primary and local backup copies." },
                    { title: "Disaster Recovery (DR) Planning", desc: "A comprehensive plan outlining the procedures and resources for restoring IT operations after a catastrophic event. Key metrics include RPO (Recovery Point Objective: how much data loss is acceptable, defining backup frequency) and RTO (Recovery Time Objective: how quickly systems and data must be restored, defining recovery speed)." },
                    { title: "Versioning & Retention Policies", desc: "Maintaining multiple versions of backups, allowing restoration to a specific point in time before data corruption, accidental deletion, or a cyberattack (e.g., ransomware infection). Retention policies define how long backup versions are kept based on legal, compliance, or business needs." },
                    { title: "Immutability/WORM (Write Once, Read Many)", desc: "Making backups immutable means they cannot be altered, overwritten, or deleted for a defined retention period. This is a critical defense against ransomware attacks, which often try to encrypt or delete backups to prevent recovery." },
                    { title: "Data Deduplication & Compression", desc: "Techniques used during the backup process to reduce the amount of storage space required and decrease data transfer times. Deduplication removes redundant copies of data blocks, while compression reduces the size of data." }
                ],
                examples: [
                    "Restoring critical business applications and associated data from immutable cloud backups after a widespread ransomware attack encrypts the primary on-premises systems, ensuring business operations can resume with minimal data loss.",
                    "An employee accidentally deletes an important project folder. The IT team can recover the folder and its contents from a daily incremental backup taken just before the deletion, restoring it to the exact point in time.",
                    "Executing a disaster recovery drill annually to test the organization's ability to restore its entire IT infrastructure (servers, databases, applications) in a secondary data center within a pre-defined RTO, ensuring business continuity preparedness."
                ],
                technicalDetails: "Involves backup software (agents/servers), various storage media (tape, disk, cloud object storage like S3 Glacier), and network infrastructure for data transfer. Storage snapshots (point-in-time copies) are often used for rapid backups. Cloud-based backup solutions leverage native cloud storage services. Encryption of backups (at rest and in transit) is a standard practice. Automated testing of backups (e.g., 'restore drills') is vital to ensure recoverability.",
                tools: "Veeam Backup & Replication, Commvault, Rubrik, Cohesity, Druva, Acronis Cyber Protect, AWS Backup, Azure Backup, Google Cloud Backup and DR, Veritas NetBackup."
            },
            'database-security': {
                name: "Database Security",
                purpose: "To protect databases from unauthorized access, attacks (e.g., SQL injection, privilege escalation), and vulnerabilities, ensuring the confidentiality, integrity, and availability of the sensitive data stored within them. It's a critical component of overall data security.",
                features: [
                    { title: "Access Controls & Least Privilege", desc: "Implementing granular permissions and roles for database users and applications, restricting access to specific tables, columns, rows (Row-Level Security - RLS), or functionalities based on the principle of least privilege. Users and applications only get the minimum access necessary to perform their legitimate job functions." },
                    { title: "Vulnerability Scanning & Hardening", desc: "Regularly scanning databases for security flaws in configurations, missing patches, weak default credentials, and insecure defaults. Database hardening involves implementing best practices like disabling unnecessary services, changing default passwords, and segmenting database networks." },
                    { title: "Auditing and Logging", desc: "Recording all database activities, including successful/failed login attempts, data modifications (inserts, updates, deletes), queries (especially to sensitive data), and changes to database schema or permissions. These audit logs are essential for forensic analysis, compliance reporting, and detecting suspicious behavior." },
                    { title: "Data Encryption (TDE, Column-Level)", desc: "Encrypting sensitive data within the database itself. Transparent Data Encryption (TDE) encrypts entire tablespaces or data files at rest without application changes. Column-level encryption allows encryption of specific sensitive columns, providing finer granularity. Encryption of communication channels (e.g., SSL/TLS for connections) protects data in transit." },
                    { title: "Database Activity Monitoring (DAM)", desc: "Monitors and analyzes database traffic (SQL queries, administrative commands) in real-time or near real-time to detect suspicious activities, policy violations, and potential attacks (e.g., SQL injection attempts, unauthorized data access, privilege escalation). DAM can alert or block suspicious queries." },
                    { title: "Secure Coding for Database Interaction", desc: "Educating developers on secure coding practices for database interaction, such as using parameterized queries or prepared statements to prevent SQL injection, validating and sanitizing all user inputs, and managing database connections securely." }
                ],
                examples: [
                    "Ensuring that only authorized finance personnel can access the full customer credit card number table in the production database, while customer support agents only see masked versions (e.g., last four digits) via Row-Level Security.",
                    "Detecting and alerting on unusual SQL queries originating from a web application, such as attempts to drop tables or execute system commands, indicating a potential SQL injection attack.",
                    "Auditing all access attempts to sensitive customer PII (Personally Identifiable Information) within the database, providing a clear trail for compliance with privacy regulations like GDPR or CCPA.",
                    "Encrypting sensitive columns (e.g., patient diagnoses in a healthcare database) to ensure that even if the database file is compromised through other means, the critical data remains unreadable."
                ],
                technicalDetails: "Database security leverages native database features (e.g., user roles, stored procedures, encryption functions) and external tools (DAM, vulnerability scanners). It involves network segmentation for database servers, strong authentication mechanisms, and regular security patching. SQL injection prevention relies on proper input validation and using object-relational mapping (ORM) frameworks or prepared statements. Privilege escalation prevention involves careful role design and continuous monitoring of elevated privileges.",
                tools: "Database-native security features (e.g., Oracle Database Security, SQL Server Security, PostgreSQL security extensions), Imperva Database Security, IBM Guardium, McAfee Database Security, DataVantage, HashiCorp Vault (for credential rotation)."
            },
            'user-authentication': {
                name: "User Authentication",
                purpose: "To verify the identity of users (individuals or systems) attempting to access IT systems, applications, or data. It answers the fundamental question: 'Are you who you claim to be?', ensuring that only legitimate entities can proceed to access controlled resources.",
                features: [
                    { title: "Passwords/Passphrases", desc: "The most common form of authentication, relying on something the user 'knows'. Strong password policies dictate complexity (mix of characters), minimum length, uniqueness, and expiration periods to mitigate brute-force and dictionary attacks. Password managers are often encouraged for users." },
                    { title: "Multi-Factor Authentication (MFA)", desc: "Requires users to provide two or more different types of verification factors before granting access. These factors are typically: something you know (password), something you have (physical token, mobile app code, smart card), or something you are (biometrics). MFA significantly increases security, as compromising one factor is insufficient for unauthorized access." },
                    { title: "Biometrics", desc: "Authentication using unique physical (e.g., fingerprints, facial recognition, iris scans) or behavioral (e.g., voice patterns, keystroke dynamics, gait) characteristics. Biometrics offer convenience and can be a strong second or third factor in MFA, reducing reliance on easily compromised passwords." },
                    { title: "Single Sign-On (SSO)", desc: "Allows users to log in once with a single set of credentials to access multiple independent software systems or applications without needing to re-authenticate for each one. SSO improves user experience and security by reducing 'password fatigue' and centralizing credential management." },
                    { title: "Certificate-based Authentication", desc: "Uses digital certificates (X.509) for strong authentication. Certificates, often stored on smart cards or client machines, bind a public key to an identity. This method is highly secure and is frequently used for machine-to-machine authentication, secure email (S/MIME), or client authentication in enterprise environments." },
                    { title: "Adaptive/Contextual Authentication", desc: "Adjusts authentication requirements based on the risk level of the access attempt. Factors considered include user location, device used, time of day, network type, and historical behavior. For example, a user logging in from a new, suspicious location might be prompted for additional MFA." }
                ],
                examples: [
                    "An employee logging into the corporate network using their username, a complex password, and a one-time code generated by a mobile authenticator app (MFA) or received via SMS, preventing unauthorized access even if the password is stolen.",
                    "Users accessing various cloud applications (e.g., Salesforce, Google Workspace, ServiceNow) with a single login via an SSO provider (e.g., Okta, Azure AD), streamlining access and enhancing security through centralized policy enforcement.",
                    "A government agency employee using a physical smart card (containing a digital certificate) along with a PIN to log into their workstation and access sensitive documents, providing strong two-factor authentication."
                ],
                technicalDetails: "Authentication protocols include LDAP/Kerberos (for on-premise Active Directory), OAuth 2.0, OpenID Connect (OIDC), and SAML 2.0 (for web/cloud SSO). MFA relies on various token types (TOTP - Time-based One-Time Password, HOTP - HMAC-based One-Time Password) or FIDO (Fast IDentity Online) standards. Biometric systems use specialized hardware and software for enrollment and verification. Adaptive authentication employs risk engines and machine learning to analyze contextual data. Password hashing and salting are critical for securely storing passwords.",
                tools: "Okta, Duo Security, Google Authenticator, Microsoft Azure AD, Ping Identity, Auth0, LastPass/1Password (password managers with MFA features), RSA SecurID, YubiKey (hardware MFA)."
            },
            'authorization': {
                name: "Authorization (Access Control)",
                purpose: "To determine what an authenticated user or system is permitted to do within a system or with specific resources. It answers the question: 'What can you do?', enforcing the principle of least privilege to minimize potential damage from a compromised account or insider threat.",
                features: [
                    { title: "Role-Based Access Control (RBAC)", desc: "Permissions are assigned to specific roles (e.g., 'HR Manager,' 'Database Administrator,' 'Read-Only User'), and users are assigned to one or more roles. RBAC simplifies permission management for large organizations by abstracting individual permissions into manageable roles, making it easier to audit and control access." },
                    { title: "Attribute-Based Access Control (ABAC)", desc: "Access decisions are made dynamically at the time of access request based on a set of attributes about the user (e.g., department, job title, security clearance, location), the resource (e.g., sensitivity, creation date, data owner), and the environment (e.g., time of day, IP address, device posture). ABAC provides highly granular and flexible control, adapting to changing contexts." },
                    { title: "Least Privilege Principle", desc: "A fundamental security principle where users, processes, and applications are granted only the minimum permissions necessary to perform their legitimate job functions. This reduces the attack surface and limits the potential impact of a security breach or misconfiguration." },
                    { title: "Policy-Based Access Control (PBAC)", desc: "A broad term that encompasses access control models defined by policies. These policies are often written in a human-readable language and then translated into executable rules. PBAC can include both RBAC and ABAC as specific implementations of policy-driven access." },
                    { title: "Segregation of Duties (SoD)", desc: "A control mechanism that ensures no single individual can complete a critical business process (e.g., financial transaction, system change) without involvement from another person. This prevents fraud, error, and misuse of privileges by requiring multiple individuals to complete distinct parts of a sensitive task." }
                ],
                examples: [
                    "An HR manager (assigned to the 'HR Admin' role) having read/write access to employee records in the HR system, while a regular employee (assigned to the 'Employee' role) only has read access to their own record, via RBAC.",
                    "Granting access to a specific financial report only if the user is in the 'Finance' department AND accessing from a trusted corporate IP range AND during business hours, using ABAC policies.",
                    "Implementing Segregation of Duties so that one administrator can approve a server patch, but a different administrator must deploy it, preventing a single point of failure or malicious act in the change management process."
                ],
                technicalDetails: "Authorization is implemented within operating systems, applications, databases, and cloud provider IAM services. It relies on Access Control Lists (ACLs), permissions matrices, group policies, and custom authorization logic. ABAC often uses policy engines that evaluate attributes against predefined rules (e.g., using XACML - eXtensible Access Control Markup Language). Just-in-Time (JIT) access and Just-Enough-Access (JEA) are modern approaches where permissions are granted only when needed and automatically revoked, further enforcing least privilege.",
                tools: "Microsoft Active Directory, AWS IAM, Azure IAM, Google Cloud IAM, Okta (for application authorization), Auth0 (for fine-grained authorization), Oracle Identity Governance, CyberArk (for privileged access management - PAM), database permission systems."
            },
            'directory-services': {
                name: "Directory Services",
                purpose: "To centralize identity and resource management, providing a single, consistent source of truth for user accounts, groups, devices, and other network resources (e.g., printers, applications). This enables centralized authentication and authorization, simplifies administration, and enhances security.",
                features: [
                    { title: "User Provisioning/Deprovisioning", desc: "Automating the creation, modification, and deletion of user accounts and their associated access rights across multiple systems and applications. This ensures that when an employee joins, changes roles, or leaves, their access rights are promptly and consistently updated or revoked across all integrated services." },
                    { title: "Group and Organizational Unit (OU) Management", desc: "Organizing users and resources into logical groups and hierarchical Organizational Units (OUs). This simplifies the assignment and management of permissions (e.g., applying group policies), reflecting the organizational structure and making access control more manageable." },
                    { title: "Authentication Integration", desc: "Provides a central repository that applications, operating systems, and network devices can query to authenticate users. Common protocols include LDAP (Lightweight Directory Access Protocol) for directory queries and Kerberos for secure authentication ticket exchange, ensuring consistent and secure login processes." },
                    { title: "Policy Enforcement & Management", desc: "Can enforce various security-related settings and policies, such as password complexity requirements, account lockout policies, session duration limits, and restrictions on administrative access. Group Policy Objects (GPOs) in Active Directory are a prime example." },
                    { title: "Single Source of Truth & Federation", desc: "Reduces administrative overhead, improves consistency, and enhances security by maintaining consistent identity information across the enterprise. Identity federation extends this by allowing users authenticated by an external identity provider (e.g., corporate AD, Google, Facebook) to access resources in the directory without creating duplicate accounts." },
                    { title: "Auditing and Logging", desc: "Logs all access attempts, changes to user accounts, group memberships, and policy modifications within the directory. These logs are crucial for security auditing, compliance, and detecting suspicious activities or unauthorized changes to identity information." }
                ],
                examples: [
                    "When a new employee joins the company, their account is automatically created in Active Directory, and they are assigned to relevant groups (e.g., 'Engineering', 'US-East'). This automatically grants them access to necessary file shares, applications, and network resources.",
                    "An organization using LDAP to authenticate users across various Linux servers, internal web applications, and VPN services, providing a unified login experience and centralized control over user credentials.",
                    "Synchronizing user identities from an on-premise Active Directory to a cloud-based directory service like Azure AD for seamless single sign-on (SSO) access to cloud applications (e.g., Microsoft 365, Salesforce)."
                ],
                technicalDetails: "The most prominent example is Microsoft Active Directory (AD), which uses LDAP for directory access and Kerberos for authentication. Other common directory services include OpenLDAP (open source) and various cloud-native directory services (e.g., AWS Directory Service, Azure Active Directory). Directory synchronization tools are used to keep multiple directories consistent. Federated identity management relies on standards like SAML (Security Assertion Markup Language) and OpenID Connect (OIDC) to enable trust between identity providers and service providers.",
                tools: "Microsoft Active Directory (on-premise), Azure Active Directory (cloud), OpenLDAP (open source), FreeIPA, AWS Directory Service, Okta (Identity Provider for federation), Ping Identity."
            },
            'siem': {
                name: "Security Information and Event Management (SIEM)",
                purpose: "To centralize the collection, storage, correlation, and analysis of log and event data from various security tools (firewalls, IDS/IPS, EDR), applications, network devices, and infrastructure components across the entire IT environment. The goal is to provide real-time monitoring, detect security incidents, and support forensic investigations.",
                features: [
                    { title: "Log Aggregation & Normalization", desc: "Collects log and event data from diverse sources (e.g., Windows Event Logs, Linux syslogs, firewall logs, application logs, cloud logs). It then normalizes this disparate data into a common format, making it easier to analyze and correlate events across different systems." },
                    { title: "Event Correlation & Analytics", desc: "The core capability of SIEM. It identifies patterns, relationships, and sequences between seemingly unrelated events across different systems and timeframes. This helps detect complex, multi-stage attacks (e.g., a failed login followed by successful access from a new location) that might otherwise go unnoticed." },
                    { title: "Real-time Monitoring & Alerting", desc: "Provides interactive dashboards and generates immediate alerts for suspicious activities or security incidents based on predefined rules, statistical anomalies, or behavioral patterns. Alerts can be sent to security analysts via various channels (email, SMS, ticketing systems)." },
                    { title: "Threat Intelligence Integration", desc: "Integrates with internal and external threat intelligence feeds (e.g., IP blacklists, malware hashes, known C2 domains). This contextualizes detected events, enriching them with information about known threats, and enabling more accurate and proactive detection." },
                    { title: "Forensic Analysis & Reporting", desc: "Stores massive volumes of historical log data for long-term retention. This data is invaluable for in-depth post-incident forensic investigations, root cause analysis, and understanding the scope and impact of past security breaches. It also generates various reports for internal audits and regulatory compliance (e.g., PCI DSS, HIPAA)." },
                    { title: "User and Entity Behavior Analytics (UEBA)", desc: "Many modern SIEMs incorporate UEBA capabilities. This uses machine learning to profile the normal behavior of users and entities (e.g., servers, applications) and detects deviations that could indicate an insider threat, compromised account, or data exfiltration." }
                ],
                examples: [
                    "A SIEM correlating a failed VPN login attempt from a suspicious foreign IP address, followed minutes later by a successful login using the same credentials on a different internal system, and then suspicious file access on a critical server, indicating a potential credential stuffing or brute-force attack.",
                    "Alerting security analysts in real-time when a large volume of data is transferred from an internal database server to an unknown external IP address during non-business hours, potentially indicating data exfiltration.",
                    "Generating weekly compliance reports on all firewall rule changes and successful brute-force attacks against public-facing web servers, demonstrating adherence to internal security policies and regulatory requirements."
                ],
                technicalDetails: "SIEM systems ingest data via various methods: agents deployed on hosts, Syslog protocol, SNMP traps, API integrations with cloud services, and database connectors. Data is stored in high-performance databases, often using Big Data technologies. Rule engines, machine learning algorithms, and statistical models are used for correlation and anomaly detection. Playbooks are often defined for automated response actions (though full automation typically falls under SOAR). False positives are a common challenge, requiring continuous tuning and refinement of correlation rules.",
                tools: "Splunk Enterprise Security, IBM QRadar, Microsoft Sentinel, Elastic SIEM (ELK Stack - Elasticsearch, Logstash, Kibana), Exabeam, Securonix, LogRhythm, Sumo Logic."
            },
            'soar': {
                name: "Security Orchestration, Automation, and Response (SOAR)",
                purpose: "To enhance security operations efficiency by automating repetitive tasks, orchestrating security tools, and streamlining incident response workflows. SOAR platforms help organizations respond faster and more consistently to security incidents, reducing manual effort and analyst fatigue.",
                features: [
                    { title: "Security Orchestration", desc: "Connects and coordinates disparate security tools and systems (e.g., SIEM, EDR, firewalls, threat intelligence platforms, ticketing systems) through APIs. It enables different tools to work together seamlessly to execute predefined workflows without manual intervention." },
                    { title: "Security Automation", desc: "Automates repetitive, mundane, and time-consuming security tasks. This includes tasks like enriching incident data (e.g., querying threat intelligence databases for IOCs), blocking malicious IPs on firewalls, isolating compromised hosts, and opening/closing tickets in IT service management systems." },
                    { title: "Incident Response Playbooks", desc: "Provides pre-defined, automated, or semi-automated workflows (called 'playbooks' or 'runbooks') for common security incidents (e.g., phishing analysis, malware containment, data exfiltration). These step-by-step procedures guide security analysts through the investigation and response process, ensuring consistency and adherence to best practices." },
                    { title: "Case Management & Collaboration", desc: "Offers a centralized platform for managing security incidents, allowing security analysts to track progress, assign tasks, document findings, and collaborate effectively with other teams (e.g., IT, legal, HR) during an investigation. This provides a single source of truth for incident details." },
                    { title: "Threat Intelligence Operationalization", desc: "Automates the ingestion and distribution of threat intelligence from various sources into security tools. For example, a SOAR platform can automatically update firewall rules with newly identified malicious IP addresses from a threat intelligence feed." },
                    { title: "Reporting and Metrics", desc: "Provides metrics on security operations efficiency, such as incident response times, number of automated actions, and common incident types. This helps security teams measure performance, identify bottlenecks, and demonstrate value." }
                ],
                examples: [
                    "An automated playbook for a phishing alert: Upon receiving a phishing email report, the SOAR platform automatically ingests the email, extracts indicators (URLs, sender), queries threat intelligence for reputation, scans attachments in a sandbox, blocks the sender on the email gateway if malicious, and sends a notification to the user who reported it.",
                    "Upon detecting malware on an endpoint (via EDR or SIEM alert), the SOAR platform automatically isolates the endpoint from the network via the EDR solution, blocks the associated Command & Control (C2) IP on the perimeter firewall, and creates an incident ticket in the IT service management system.",
                    "Orchestrating data enrichment for a suspicious IP alert: The SOAR system automatically queries external threat intelligence platforms and internal vulnerability scanners for details on the IP address, enriches the alert in the SIEM, and presents a consolidated view to the security analyst."
                ],
                technicalDetails: "SOAR platforms utilize APIs to integrate with a wide range of security products (SIEMs, EDRs, firewalls, identity management, vulnerability scanners, etc.). Playbooks are defined using visual drag-and-drop interfaces or scripting languages (e.g., Python). They often incorporate decision logic, conditional branching, and approval steps. Key benefits include faster Mean Time To Respond (MTTR), reduced human error, and optimized resource allocation for security teams, especially in Security Operations Centers (SOCs).",
                tools: "Palo Alto Networks Cortex XSOAR, Splunk SOAR (Phantom), Swimlane, Delinea (formerly ThycoticCentrify) Secret Server (with SOAR capabilities), FortiSOAR, ThreatConnect."
            },
            'tip': {
                name: "Threat Intelligence Platforms (TIP)",
                purpose: "To aggregate, process, analyze, and disseminate threat intelligence (e.g., Indicators of Compromise - IOCs, Tactics, Techniques, and Procedures - TTPs) from various internal and external sources. The goal is to make threat intelligence actionable, enhancing an organization's detection, prevention, and response capabilities against evolving cyber threats.",
                features: [
                    { title: "Threat Intelligence Aggregation", desc: "Collects raw threat intelligence from numerous sources, including commercial threat feeds (e.g., FireEye, CrowdStrike), open-source intelligence (OSINT) feeds (e.g., Abuse.ch, AlienVault OTX), industry-specific sharing groups (ISACs/ISAOs), and internal security tools (e.g., SIEM, EDR, firewalls)." },
                    { title: "IOC Management & Enrichment", desc: "Stores, categorizes, and organizes various types of Indicators of Compromise (IOCs) such as malicious IP addresses, domain names, file hashes (MD5, SHA256), URLs, and email addresses. It enriches these IOCs with context, such as associated malware families, attack campaigns, threat actors, and confidence scores, making the intelligence more actionable." },
                    { title: "Contextualization & Analysis", desc: "Applies analytics (e.g., machine learning, rule-based engines) to raw intelligence to identify patterns, remove false positives, prioritize threats, and derive actionable insights. It helps security teams understand 'who' is attacking, 'how' they are attacking, and 'what' their targets are." },
                    { title: "Integration with Security Controls", desc: "Shares refined and contextualized threat intelligence with other security tools in the ecosystem. This enables automated blocking on firewalls, enhanced detection in SIEMs and EDRs, improved vulnerability prioritization, and proactive threat hunting activities." },
                    { title: "Collaboration & Sharing", desc: "Facilitates the sharing of threat intelligence within an organization (e.g., between security analysts and incident responders) and with trusted partners, industry peers, or law enforcement (e.g., via STIX/TAXII standards), fostering collective defense." },
                    { title: "Reporting & Visualization", desc: "Provides dashboards and reports that visualize threat landscapes, trending attack vectors, and the operational impact of threat intelligence, helping security leadership make informed decisions and communicate risks." }
                ],
                examples: [
                    "A TIP automatically ingests a new list of IP addresses associated with a known ransomware campaign from a threat intelligence feed. It then pushes these IPs to the organization's perimeter firewall, automatically blocking all inbound and outbound communication to these malicious destinations.",
                    "When a SIEM alert fires on a suspicious connection, the TIP enriches the alert with context, indicating that the destination IP address is a known command-and-control server for a specific nation-state actor, helping the security analyst quickly understand the severity and nature of the threat.",
                    "A security analyst using the TIP to proactively search internal network logs for file hashes identified as part of a new malware variant, allowing them to detect potential compromises before they escalate."
                ],
                technicalDetails: "TIPs use data parsers, correlation engines, and often graph databases to store relationships between intelligence entities. Standards like STIX (Structured Threat Information eXpression) and TAXII (Trusted Automated eXchange of Indicator Information) are crucial for automated sharing and consumption of threat intelligence. Machine learning helps in filtering noise and prioritizing indicators. Integration typically happens via APIs with SIEM, SOAR, firewalls, and EDR platforms.",
                tools: "Anomali ThreatStream, Recorded Future, ThreatConnect, Maltego (for OSINT gathering/visualization), MISP (Malware Information Sharing Platform & Threat Sharing - open source), IBM X-Force Exchange, CrowdStrike Falcon Intelligence."
            },
            'vulnerability-management': {
                name: "Vulnerability Management",
                purpose: "To continuously identify, assess, prioritize, and remediate security vulnerabilities (weaknesses) in IT systems, applications, and network infrastructure. The overarching goal is to reduce the organization's attack surface and exposure to cyber threats.",
                features: [
                    { title: "Vulnerability Scanning", desc: "Automated scanning of networks, servers, workstations, web applications, and cloud environments to discover known security weaknesses (e.g., unpatched software, misconfigurations, default credentials, open ports, insecure protocols). Scanners use databases of known vulnerabilities (CVEs) to identify issues." },
                    { title: "Penetration Testing (Pen Test)", desc: "Manual, ethical hacking exercises conducted by security experts (internal or third-party) to simulate real-world attacks. Pen tests aim to exploit identified vulnerabilities and weaknesses in defenses, demonstrating the actual impact of a compromise and often uncovering complex, chained vulnerabilities that automated scans might miss." },
                    { title: "Risk Prioritization & Contextualization", desc: "Automatically or manually ranks identified vulnerabilities based on their severity (e.g., CVSS score), exploitability, potential business impact, and the criticality of the affected asset. This helps organizations focus remediation efforts on the most significant risks first, preventing 'alert fatigue' and optimizing resources." },
                    { title: "Remediation & Tracking", desc: "Manages the lifecycle of vulnerabilities from discovery to fix. This includes assigning ownership for remediation, tracking progress, verifying fixes, and ensuring vulnerabilities are addressed in a timely manner. Integration with ticketing systems (e.g., Jira, ServiceNow) is common." },
                    { title: "Compliance Mapping & Reporting", desc: "Maps identified vulnerabilities and remediation efforts to specific regulatory requirements or industry standards (e.g., PCI DSS, HIPAA, GDPR, ISO 27001). Generates reports to demonstrate compliance to auditors, regulators, and internal stakeholders." },
                    { title: "Continuous Monitoring & Asset Inventory", desc: "Maintains an up-to-date inventory of all IT assets and continuously monitors them for new vulnerabilities or changes in their security posture. This ensures that new systems are automatically included in the vulnerability management program." }
                ],
                examples: [
                    "Regularly scanning all internal servers and network devices to find unpatched operating system vulnerabilities and outdated software versions, then prioritizing patching based on the criticality of the server.",
                    "Hiring an external security firm to perform a penetration test on a new public-facing web application before its launch, uncovering a critical SQL injection flaw that could lead to a data breach.",
                    "Prioritizing the patching of critical vulnerabilities (e.g., a remote code execution flaw) on internet-facing web servers over low-severity misconfigurations on internal non-production systems, based on risk scores and asset value."
                ],
                technicalDetails: "Vulnerability management programs leverage automated scanning tools (network, web application, cloud configuration scanners), vulnerability databases (e.g., NVD - National Vulnerability Database, CVE - Common Vulnerabilities and Exposures), and risk assessment frameworks (e.g., CVSS - Common Vulnerability Scoring System). Pen testing involves reconnaissance, scanning, exploitation, post-exploitation, and reporting phases. Remediation typically involves patching, reconfiguring systems, or implementing compensating controls. It's an ongoing process, not a one-time activity.",
                tools: "Vulnerability Scanners: Nessus (Tenable), Qualys Vulnerability Management, Rapid7 InsightVM, OpenVAS (open source). Web Application Pen Testing Tools: Burp Suite, OWASP ZAP. GRC Platforms (for tracking): Archer GRC, ServiceNow GRC."
            },
            'incident-response': {
                name: "Incident Response (IR) Platform",
                purpose: "To provide a centralized platform and set of tools to manage the entire lifecycle of a security incident, from initial detection and analysis through containment, eradication, recovery, and post-mortem review. It streamlines workflows, facilitates collaboration, and ensures consistent, effective response.",
                features: [
                    { title: "Incident Triage & Prioritization", desc: "Categorizes and prioritizes security incidents based on their severity, potential impact, and type (e.g., malware infection, data breach, phishing). This ensures that critical incidents receive immediate attention and resources are allocated effectively." },
                    { title: "Investigation & Analysis Tools", desc: "Provides capabilities for collecting digital evidence (e.g., forensic images, network packet captures, system logs), analyzing root causes, understanding the scope of a breach, and identifying the attack's 'kill chain'. Integration with SIEM and EDR platforms enriches investigative data." },
                    { title: "Communication & Collaboration", desc: "Facilitates secure and efficient communication and task assignment among incident responders, internal stakeholders (e.g., legal, HR, PR), and external parties (e.g., law enforcement, affected customers, regulatory bodies). It ensures all parties are informed and aligned during a crisis." },
                    { title: "Workflow Automation & Playbooks (SOAR Integration)", desc: "Can integrate with SOAR capabilities to automate repetitive response tasks. This includes executing predefined 'playbooks' for common incident types (e.g., automated host isolation, blocking malicious IPs, collecting forensic artifacts), accelerating response times and reducing manual effort." },
                    { title: "Containment & Eradication Support", desc: "Provides tools and dashboards to manage the containment phase (stopping the spread of an attack, isolating affected systems) and the eradication phase (removing the threat from the environment, cleaning infected systems). This might involve remote execution of scripts or coordination with endpoint tools." },
                    { title: "Recovery & Post-Mortem Reporting", desc: "Supports the recovery phase (restoring systems and data to normal operation) and the crucial post-mortem phase. It generates detailed reports on incidents, including lessons learned, root causes, and recommendations for improving future defenses and processes." }
                ],
                examples: [
                    "Managing the response to a suspected data breach involving sensitive customer information: the IR platform coordinates actions like isolating affected systems, notifying legal counsel and senior management, drafting communications to affected parties, and tracking all investigative steps and evidence.",
                    "Tracking the progress of a widespread malware outbreak investigation across multiple departments, assigning specific tasks (e.g., 'forensic analysis of endpoint X', 'network isolation of subnet Y') to different security teams, and documenting all findings and remediation actions in a centralized timeline.",
                    "Utilizing the IR platform to manage the containment and eradication phases of a ransomware attack, ensuring all affected systems are properly identified, disconnected, cleaned, and restored from backups, minimizing business disruption."
                ],
                technicalDetails: "IR platforms are often standalone systems or modules within larger GRC or security operations platforms. They integrate with SIEMs for alert ingestion, EDR for endpoint visibility and control, SOAR for automation, and threat intelligence platforms for context. Key functionalities include case management, evidence locker, timeline creation, task management, and integration with communication tools (e.g., Slack, Microsoft Teams). They typically align with industry-standard incident response frameworks like the NIST Cybersecurity Framework (Detect, Respond, Recover functions) or the SANS Incident Handler's Handbook lifecycle (Preparation, Identification, Containment, Eradication, Recovery, Lessons Learned).",
                tools: "IBM Security SOAR (formerly Resilient), TheHive (open source), Swimlane, ServiceNow Security Operations, Splunk Phantom (SOAR functions within Splunk), Delinea (with incident response modules)."
            },
            'security-policies': {
                name: "Security Policies and Standards",
                purpose: "To establish formal, high-level documents that define the organization's overarching security posture, objectives, and acceptable behavior. They serve as the foundation for all other security controls, providing clear guidelines, rules, and best practices for protecting information assets.",
                features: [
                    { title: "Acceptable Use Policy (AUP)", desc: "Defines how employees, contractors, and other users can responsibly and securely use organizational IT assets (e.g., internet, email, company devices, software). It outlines prohibited activities, consequences of violations, and user responsibilities, aiming to protect against misuse and legal liabilities." },
                    { title: "Password Policy", desc: "Specifies requirements for creating and managing strong passwords (e.g., minimum length, complexity rules including special characters/numbers, prohibition of common words), defines password expiration periods, and dictates rules for password reuse and lockout thresholds after failed attempts." },
                    { title: "Data Classification Policy", desc: "Defines how data should be categorized (e.g., Public, Internal, Confidential, Restricted, Secret) based on its sensitivity, business impact, and regulatory requirements. It specifies handling, storage, access, and destruction requirements for each classification level, ensuring appropriate protection." },
                    { title: "Incident Response Policy", desc: "Outlines the formal procedures, roles, responsibilities, and communication protocols for responding to security incidents. It covers detection, analysis, containment, eradication, recovery, and post-mortem phases, ensuring a structured and effective response to breaches." },
                    { title: "Remote Access Policy", desc: "Governs the secure methods and requirements for employees and authorized third parties to access internal networks and systems from external locations (e.g., home, public Wi-Fi). It typically mandates VPN use, strong authentication (MFA), and specific device security postures." },
                    { title: "Information Security Policy", desc: "The overarching document that sets the tone for the entire information security program. It defines the organization's commitment to security, its high-level objectives, and the framework for managing information security risks. All other policies typically derive from this master policy." }
                ],
                examples: [
                    "An Acceptable Use Policy (AUP) clearly stating that unauthorized software installation or downloading pirated content on company laptops is prohibited, and that company email should not be used for personal commercial activities.",
                    "A Data Classification Policy dictating that all 'Confidential' customer Personally Identifiable Information (PII) must be encrypted both at rest (e.g., in databases) and in transit (e.g., over HTTPS) and only accessible by authorized personnel with a clear business need.",
                    "A Password Policy requiring all employees to set passwords of at least 14 characters, including upper case, lower case, numbers, and symbols, and mandating MFA for all system logins to enhance authentication strength."
                ],
                technicalDetails: "Security policies are administrative controls; their enforcement relies on a combination of technical controls (e.g., IAM systems, DLP solutions, network access controls, endpoint protection) and procedural controls (e.g., employee training, awareness programs, security audits). Policies should be reviewed and updated regularly to adapt to changing threat landscapes, technologies, and regulatory requirements. Policy management often involves document control systems and GRC platforms for versioning, distribution, and attestation.",
                tools: "Document management systems (e.g., SharePoint, Confluence), GRC platforms (e.g., Archer, ServiceNow GRC, LogicManager), internal wikis or knowledge bases, policy authoring templates."
            },
            'risk-management': {
                name: "Risk Management",
                purpose: "To systematically identify, assess, prioritize, and treat (mitigate, accept, transfer, avoid) security risks to an acceptable level. It aligns security investments and activities with the organization's strategic objectives and risk appetite, moving beyond just technical controls to a holistic view of potential threats and impacts.",
                features: [
                    { title: "Risk Assessment & Analysis", desc: "The process of identifying potential threats (e.g., malware, insider threat, natural disaster, supply chain attack) and vulnerabilities (e.g., unpatched systems, weak configurations, human error). It then analyzes the likelihood of these threats exploiting vulnerabilities and the potential impact (financial, reputational, operational) of such an event. This can be quantitative (monetary values) or qualitative (high/medium/low)." },
                    { title: "Risk Mitigation & Control Implementation", desc: "Implementing controls (technical, administrative, physical) to reduce the likelihood or impact of identified risks to an acceptable level. This involves applying security patches, implementing new security tools (e.g., WAF, EDR), strengthening authentication, enhancing employee training, or establishing new security procedures." },
                    { title: "Risk Monitoring & Review", desc: "Continuously tracking and reviewing identified risks, the effectiveness of implemented controls, and any changes in the threat landscape, regulatory environment, or business operations. New risks may emerge, and existing risks may change in likelihood or impact over time." },
                    { title: "Risk Register & Reporting", desc: "A centralized repository to document all identified risks, their assessment details (likelihood, impact, risk score), current controls, and treatment plans. Regular reports are generated for management and stakeholders to provide transparency on the organization's risk posture and progress in addressing risks." },
                    { title: "Risk Treatment Strategies", desc: "Beyond mitigation, organizations can choose to: **Accept** a risk (if its impact/likelihood is low or cost of mitigation is too high); **Transfer** a risk (e.g., via cyber insurance); or **Avoid** a risk (e.g., by not engaging in a risky activity or discontinuing a vulnerable system)." },
                    { title: "Risk Frameworks", desc: "Adopting established frameworks (e.g., NIST Cybersecurity Framework (CSF), ISO 27005, FAIR - Factor Analysis of Information Risk) provides a structured approach to managing information security risks, ensuring comprehensiveness and consistency." }
                ],
                examples: [
                    "Assessing the risk of a data breach from a vulnerable public-facing web application. The assessment identifies a high likelihood of exploitation and a severe financial/reputational impact. The organization decides to mitigate this by implementing a WAF, performing a penetration test, and patching the application.",
                    "Monitoring new zero-day vulnerabilities disclosed in critical software and prioritizing their patching or workaround implementation based on their potential exploitability and the criticality of the systems using that software.",
                    "Accepting the residual risk of a minor data loss from a non-critical internal system after implementing reasonable security controls, as the cost of further mitigation outweighs the potential impact of the remaining risk."
                ],
                technicalDetails: "Risk management is a continuous process governed by standards and frameworks. It involves identifying assets, threats, and vulnerabilities, then calculating or estimating risk scores. Tools can automate vulnerability scanning and asset inventory, but risk analysis and treatment decisions often require human expertise and business context. The FAIR methodology provides a quantitative approach to risk assessment. Integration with GRC platforms helps centralize risk data and reporting.",
                tools: "GRC Platforms (e.g., Archer GRC, ServiceNow GRC, LogicManager, RSA Archer), Risk Assessment Templates (Excel, specialized software), Vulnerability Scanners (e.g., Tenable.io, Qualys), Cyber Insurance providers (for risk transfer)."
            },
            'compliance-management': {
                name: "Compliance Management",
                purpose: "To ensure that the organization adheres to relevant laws, regulations, industry standards, and internal policies related to information security and data privacy. It demonstrates accountability, avoids legal penalties, and builds trust with customers and partners.",
                features: [
                    { title: "Regulatory Mapping & Control Frameworks", desc: "Mapping organizational security controls and practices to specific requirements of various compliance mandates (e.g., GDPR, HIPAA, PCI DSS, ISO 27001, SOC 2, CCPA, FedRAMP). This involves understanding which controls satisfy which requirements across multiple regulations." },
                    { title: "Audit Management & Evidence Collection", desc: "Preparing for and facilitating internal and external security audits. This includes collecting necessary evidence (e.g., policy documents, log files, configuration reports, audit trails), providing auditor access, and responding to auditor requests efficiently. Automation for evidence collection is key." },
                    { title: "Reporting & Documentation", desc: "Generating comprehensive reports to demonstrate compliance status to auditors, regulators, internal stakeholders, and customers. Maintaining thorough and up-to-date documentation of all security controls, policies, procedures, and risk assessments is crucial for audit readiness." },
                    { title: "Control Gap Analysis", desc: "Identifying areas where current security controls or practices fall short of compliance requirements. This involves comparing the organization's existing security posture against the mandates of specific regulations to pinpoint gaps that need to be addressed." },
                    { title: "Policy Enforcement Verification", desc: "Ensuring that defined security policies are not just written documents, but are actually being implemented, enforced, and followed consistently across the organization. This involves monitoring, auditing, and enforcing compliance through technical controls and awareness programs." },
                    { title: "Continuous Compliance Monitoring", desc: "Moving beyond point-in-time audits to continuous monitoring of controls and configurations for compliance. This leverages tools like security configuration management and cloud security posture management (CSPM) to automatically detect and alert on non-compliant states." }
                ],
                examples: [
                    "Implementing specific encryption standards, access controls, and data retention policies to comply with HIPAA regulations for Protected Health Information (PHI) stored and processed by a healthcare provider.",
                    "Undergoing an annual PCI DSS (Payment Card Industry Data Security Standard) audit to ensure secure handling of credit card data, involving network segmentation, strong encryption, and regular vulnerability scans.",
                    "Documenting evidence that multi-factor authentication (MFA) is enforced for all administrative access to critical systems, to satisfy a control requirement from ISO 27001 certification or a SOC 2 audit report."
                ],
                technicalDetails: "Compliance management is heavily process-driven but increasingly supported by technology. It involves interpreting legal and regulatory texts, mapping controls to requirements, and collecting evidence. Automation is key for large organizations, leveraging GRC platforms, cloud security posture management (CSPM) tools, configuration management databases (CMDBs), and security auditing tools. Legal teams, security teams, and internal audit groups collaborate closely. Non-compliance can lead to significant fines, reputational damage, and legal action.",
                tools: "GRC Platforms (e.g., OneTrust, MetricStream, Archer, ServiceNow GRC), Cloud Security Posture Management (CSPM) tools (e.g., Prisma Cloud, Wiz, Orca Security), Audit Management Software, Compliance Dashboards (often integrated into cloud provider consoles)."
            }
        };

        let currentActiveBranch = null; // Tracks the currently active main branch

        /**
         * Toggles the visibility of sub-services (categories) within a main branch.
         * Closes other open branches when a new one is opened.
         * @param {string} branchId - The ID of the branch element to toggle.
         */
        function toggleBranch(branchId) {
            const subServices = document.getElementById(branchId);
            // If there's an active branch and it's not the one just clicked, close it
            if (currentActiveBranch && currentActiveBranch !== subServices) {
                currentActiveBranch.classList.remove('active');
            }
            // Toggle the 'active' class for the clicked branch's sub-services
            subServices.classList.toggle('active');
            // Update the currentActiveBranch variable
            currentActiveBranch = subServices.classList.contains('active') ? subServices : null;
        }

        /**
         * Displays the detailed information about a security category in a modal.
         * @param {string} categoryId - The ID of the category to display.
         */
        function showCategoryDetails(categoryId) {
            const data = securityData[categoryId];
            if (!data) return; // Exit if category data is not found

            const modalContent = document.getElementById('modalContent');
            
            // Generate Features HTML with feature-tag and feature-details
            const featuresHtml = data.features.map(feature => `
                <span class="feature-tag" onclick="toggleFeatureDetails('${categoryId}', '${feature.title}')">${feature.title}</span>
            `).join('');

            const featureDetailsHtml = data.features.map(feature => `
                <div id="feature-details-${categoryId}-${feature.title.replace(/[\s\/]/g, '-')}" class="feature-details">
                    <div class="sub-feature">
                        <div class="sub-feature-title">${feature.title}</div>
                        <div class="sub-feature-desc">${feature.desc}</div>
                    </div>
                </div>
            `).join('');

            // Populate the modal with category details
            modalContent.innerHTML = `
                <h2>${data.name}</h2>
                <p class="category-desc">${data.purpose}</p>
                <div style="display: flex; gap: 10px; margin-top: 10px; flex-wrap: wrap;">
                    <button class="llm-action-button" onclick="summarizeCategoryPurpose('${data.name}', '${data.purpose}', this)">Summarize Purpose ✨</button>
                    <button class="llm-action-button" onclick="generateMoreExamples('${data.name}', '${data.examples.join(', ')}', this)">Suggest More Examples ✨</button>
                    <button class="llm-action-button" onclick="explainTechnicalDetails('${data.name}', '${data.technicalDetails}', this)">Explain Technical Details ✨</button>
                </div>
                <div id="llm-category-output" class="llm-output-area" style="display: none;"></div>
                <hr style="margin: 20px 0; border-color: rgba(255,255,255,0.1);">

                <h3>🌟 Key Features</h3>
                <div class="features">
                    ${featuresHtml}
                </div>
                ${featureDetailsHtml}
                <hr style="margin: 20px 0; border-color: rgba(255,255,255,0.1);">

                <h3>🎯 Examples / Use Cases</h3>
                <div class="scenario-box">
                    <ul class="use-cases-list">
                        ${data.examples.map(example => `<li>${example}</li>`).join('')}
                    </ul>
                </div>
                <hr style="margin: 20px 0; border-color: rgba(255,255,255,0.1);">

                <h3>💻 Technical Details</h3>
                <div class="tech-stack-list">
                    <p>${data.technicalDetails}</p>
                </div>
                <hr style="margin: 20px 0; border-color: rgba(255,255,255,0.1);">

                <h3>🛠️ Common Tools</h3>
                <div class="pricing-info-box">
                    <p>${data.tools}</p>
                </div>
            `;
            document.getElementById('categoryModal').style.display = 'block'; // Show the modal
        }

        /**
         * Toggles the visibility of specific feature details within the category modal.
         * Ensures only one feature detail section is open at a time.
         * @param {string} categoryId - The ID of the current category.
         * @param {string} featureTitle - The title of the feature to toggle.
         */
        function toggleFeatureDetails(categoryId, featureTitle) {
            // Construct the ID for the specific feature details element, replacing spaces and slashes for valid IDs
            const featureId = `feature-details-${categoryId}-${featureTitle.replace(/[\s\/]/g, '-')}`;
            const featureDetailsElement = document.getElementById(featureId);

            // Get all feature details elements within the current modal
            const allFeatureDetailsInModal = document.querySelectorAll('#modalContent .feature-details');

            // If the clicked element is already active, close it and return
            if (featureDetailsElement.classList.contains('active')) {
                featureDetailsElement.classList.remove('active');
                return;
            }

            // Close all other active feature details elements in the modal
            allFeatureDetailsInModal.forEach(element => {
                if (element.classList.contains('active')) {
                    element.classList.remove('active');
                }
            });

            // Now, open the clicked feature details element
            featureDetailsElement.classList.add('active');
        }


        /**
         * Closes the category details modal.
         */
        function closeModal() {
            document.getElementById('categoryModal').style.display = 'none';
            // Optionally, clear modal content or reset state when closing
            document.getElementById('modalContent').innerHTML = '';
        }

        // Close modal when clicking outside of it
        window.onclick = function(event) {
            const modal = document.getElementById('categoryModal');
            if (event.target == modal) {
                closeModal(); // Use the existing closeModal function
            }
        }

        // LLM specific functions
        /**
         * Summarizes the given category purpose using the Gemini API.
         * @param {string} categoryName - The name of the security category.
         * @param {string} purpose - The category purpose to summarize.
         * @param {HTMLElement} buttonElement - The button element that triggered the call.
         */
        async function summarizeCategoryPurpose(categoryName, purpose, buttonElement) {
            const prompt = `Summarize the purpose of "${categoryName}" in cybersecurity concisely in 2-3 sentences:\n\n"${purpose}"`;
            await callGeminiAPI(prompt, 'llm-category-output', buttonElement);
        }

        /**
         * Generates new examples for a given security category using the Gemini API.
         * @param {string} categoryName - The name of the security category.
         * @param {string} existingExamples - Comma-separated existing examples.
         * @param {HTMLElement} buttonElement - The button element that triggered the call.
         */
        async function generateMoreExamples(categoryName, existingExamples, buttonElement) {
            const prompt = `Given the cybersecurity category "${categoryName}" with existing examples: "${existingExamples}", suggest 2-3 additional distinct real-world examples or use cases in bullet point format.`;
            await callGeminiAPI(prompt, 'llm-category-output', buttonElement);
        }

        /**
         * Explains the technical details for a given security category using the Gemini API.
         * @param {string} categoryName - The name of the security category.
         * @param {string} technicalDetails - The existing technical details.
         * @param {HTMLElement} buttonElement - The button element that triggered the call.
         */
        async function explainTechnicalDetails(categoryName, technicalDetails, buttonElement) {
            const prompt = `Elaborate on the technical details for the cybersecurity feature "${categoryName}" based on this information: "${technicalDetails}". Explain how it fundamentally works and any relevant underlying technologies or concepts. Keep it concise (3-5 sentences).`;
            await callGeminiAPI(prompt, 'llm-category-output', buttonElement);
        }

        /**
         * Calls the Gemini API with a given prompt and displays the response.
         * @param {string} prompt - The text prompt to send to the LLM.
         * @param {string} outputElementId - The ID of the HTML element where the response should be displayed.
         * @param {HTMLElement} buttonElement - The button element that triggered the call, to manage its state.
         */
        async function callGeminiAPI(prompt, outputElementId, buttonElement) {
            const outputElement = document.getElementById(outputElementId);
            const originalButtonText = buttonElement.innerHTML; // Store original button text

            outputElement.style.display = 'block'; // Ensure output area is visible
            outputElement.innerHTML = '<div class="loading-indicator"></div> Loading AI response...'; // Show loading

            buttonElement.disabled = true; // Disable button during API call
            buttonElement.innerHTML = `<div class="loading-indicator"></div> Thinking...`; // Change button text to show loading

            try {
                let chatHistory = [];
                chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                const payload = { contents: chatHistory };
                const apiKey = ""; // Canvas will automatically provide the API key here.
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    const errorText = await response.text();
                    throw new Error(`HTTP error! status: ${response.status}, message: ${errorText}`);
                }

                const result = await response.json();

                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    outputElement.innerHTML = text; // Display the response
                } else {
                    outputElement.innerHTML = 'Error: Could not get a valid response from the AI. Unexpected structure.';
                }
            } catch (error) {
                outputElement.innerHTML = `Error: Failed to connect to AI. Details: ${error.message}`;
            } finally {
                buttonElement.innerHTML = originalButtonText; // Restore button text
                buttonElement.disabled = false; // Re-enable button
            }
        }

        /**
         * Fetches and displays the latest general cybersecurity news using Gemini AI (simulated).
         */
        async function fetchCybersecurityNews() {
            const newsOutputElement = document.getElementById('news-list');
            newsOutputElement.innerHTML = '<div class="loading-indicator"></div> Fetching latest cybersecurity news via Gemini AI...';

            const prompt = `Find and summarize at least 10 recent news articles (published within the last 3-6 months) related to general cybersecurity topics (e.g., data breaches, new attack techniques, security trends, regulatory changes). For each article, provide the title, a 1-2 sentence summary, and a placeholder URL. Ensure the summaries are concise and informative.`;
            
            try {
                // Simulate a call to a backend service that would perform the deep search with Gemini/Google Search.
                const simulatedNewsResponse = await new Promise(resolve => {
                    setTimeout(() => {
                        // Dummy data as if returned from a Gemini-powered search backend.
                        const articles = [
                            { title: "Major Ransomware Gang Disrupted by International Law Enforcement", summary: "A significant international operation has led to the takedown of a notorious ransomware group, seizing infrastructure and recovering millions in cryptocurrency, marking a win for cybersecurity efforts.", url: "https://example.com/ransomware-disruption" },
                            { title: "New Phishing Techniques Exploiting QR Codes on the Rise", summary: "Security researchers warn of an increase in 'quishing' attacks, where malicious QR codes are used to direct victims to phishing sites, bypassing traditional email security filters.", url: "https://example.com/quishing-attacks" },
                            { title: "AI-Powered Cyberattacks Becoming More Sophisticated, Report Says", summary: "A recent industry report highlights the growing sophistication of AI-driven cyberattacks, which can adapt in real-time and automate reconnaissance and exploitation phases.", url: "https://example.com/ai-cyberattacks-report" },
                            { title: "Zero-Day Vulnerability Found in Popular Enterprise Software, Patches Issued", summary: "A critical zero-day vulnerability affecting widely used enterprise software has been discovered, prompting urgent patch releases and calls for immediate updates by affected organizations.", url: "https://example.com/zero-day-vulnerability" },
                            { title: "Governments Push for Stronger Cybersecurity Regulations Amidst Rising Threats", summary: "New legislative efforts are underway globally to mandate stricter cybersecurity requirements for critical infrastructure and data-handling organizations, emphasizing accountability and resilience.", url: "https://example.com/new-cyber-regulations" },
                            { title: "Supply Chain Attacks Continue to Pose Major Risk to Businesses", summary: "Analysis shows supply chain attacks remain a primary concern, with attackers compromising software vendors to distribute malware to their downstream customers, impacting numerous organizations.", url: "https://example.com/supply-chain-risk" },
                            { title: "Cloud Security Misconfigurations Lead to Significant Data Breaches", summary: "Several high-profile data breaches have attributed to basic cloud security misconfigurations, underscoring the need for continuous auditing and automated posture management in cloud environments.", url: "https://example.com/cloud-breaches" },
                            { title: "Quantum Computing Poses Future Threat to Current Encryption Standards", summary: "Experts discuss the long-term implications of quantum computing for cybersecurity, warning that future quantum machines could break many current encryption algorithms, necessitating research into post-quantum cryptography.", url: "https://example.com/quantum-encryption" },
                            { title: "Biometric Authentication Gains Traction for Enhanced User Security", summary: "The adoption of biometric authentication methods like facial recognition and fingerprints is increasing across industries, offering a more convenient and secure alternative to traditional passwords.", url: "https://example.com/biometric-security" },
                            { title: "Ethical Hacking and Bug Bounty Programs Drive Proactive Security Improvement", summary: "More companies are embracing ethical hacking and incentivizing bug bounty programs to discover and fix vulnerabilities before malicious actors can exploit them, demonstrating a proactive approach to cybersecurity.", url: "https://example.com/bug-bounty-programs" }
                        ];
                        resolve({ articles });
                    }, 1500); // Simulate 1.5 second network delay
                });

                if (simulatedNewsResponse.articles && simulatedNewsResponse.articles.length > 0) {
                    newsOutputElement.innerHTML = simulatedNewsResponse.articles.map(article => `
                        <li class="news-item">
                            <h3><a href="${article.url}" target="_blank">${article.title}</a></h3>
                            <p>${article.summary}</p>
                            <p style="font-size: 0.75rem; color: #ccc;">Source: ${article.source || 'Various'} | Published: ${article.date || 'Recent'}</p>
                        </li>
                    `).join('');
                } else {
                    newsOutputElement.innerHTML = '<p>No general cybersecurity news found at this time. Please try again later.</p>';
                }
            } catch (error) {
                newsOutputElement.innerHTML = `<p style="color: #ffcccc;">Error fetching news: ${error.message}. Displaying placeholder data.</p>`;
            }
        }

        /**
         * Performs a search using Gemini AI and displays the result in the floating search area.
         */
        async function performAISearch() {
            const searchInput = document.getElementById('ai-search-input');
            const searchOutput = document.getElementById('ai-search-output');
            const searchButton = document.getElementById('ai-search-button');
            const userQuery = searchInput.value.trim();

            if (!userQuery) {
                searchOutput.innerHTML = '<p style="color: #ffcccc;">Please enter a search query.</p>';
                searchOutput.style.display = 'block';
                return;
            }

            const prompt = `As a concise AI search assistant focused *only* on organizational cybersecurity features (Perimeter, Network, Endpoint, Application, Data, IAM, Security Operations, GRC) and related concepts, provide a relevant and helpful answer to the following query: "${userQuery}". Keep the answer to a maximum of 3-4 sentences. If the query is outside the scope of organizational cybersecurity, state that politely.`;
            await callGeminiAPI(prompt, 'ai-search-output', searchButton);
        }

        // Draggable functionality for the floating search bar
        let isDragging = false;
        let offset = { x: 0, y: 0 };
        const floatingSearchElement = document.getElementById('floatingAISearch');

        floatingSearchElement.addEventListener('mousedown', (e) => {
            // Only start dragging if the bar is not expanded or if the click is on the toggle button itself
            if (!floatingSearchElement.classList.contains('expanded') || e.target.closest('.search-toggle-button')) {
                isDragging = true;
                offset = {
                    x: e.clientX - floatingSearchElement.getBoundingClientRect().left,
                    y: e.clientY - floatingSearchElement.getBoundingClientRect().top
                };
                floatingSearchElement.style.cursor = 'grabbing';
            }
        });

        document.addEventListener('mousemove', (e) => {
            if (!isDragging) return;

            // Calculate new position
            let newX = e.clientX - offset.x;
            let newY = e.clientY - offset.y;

            // Get viewport dimensions to constrain dragging
            const viewportWidth = window.innerWidth;
            const viewportHeight = window.innerHeight;
            const elementWidth = floatingSearchElement.offsetWidth;
            const elementHeight = floatingSearchElement.offsetHeight;

            // Constrain newX to stay within viewport bounds
            newX = Math.max(0, Math.min(newX, viewportWidth - elementWidth));
            // Constrain newY to stay within viewport bounds
            newY = Math.max(0, Math.min(newY, viewportHeight - elementHeight));

            // Set position using left/top (overriding right/bottom)
            floatingSearchElement.style.left = `${newX}px`;
            floatingSearchElement.style.top = `${newY}px`;
            floatingSearchElement.style.right = 'auto'; // Disable right/bottom positioning when dragging via left/top
            floatingSearchElement.style.bottom = 'auto';
        });

        document.addEventListener('mouseup', () => {
            isDragging = false;
            floatingSearchElement.style.cursor = floatingSearchElement.classList.contains('expanded') ? 'auto' : 'grab';
        });

        /**
         * Toggles the visibility and expanded state of the floating AI search bar.
         * Also handles dynamic positioning (left/right) based on current location.
         */
        function toggleFloatingSearch() {
            const floatingSearch = document.getElementById('floatingAISearch');
            const searchIcon = document.getElementById('searchIcon');

            // Get current position before toggling the class
            const currentLeft = floatingSearch.getBoundingClientRect().left;
            const viewportWidth = window.innerWidth;

            floatingSearch.classList.toggle('expanded');

            if (floatingSearch.classList.contains('expanded')) {
                searchIcon.textContent = '✖'; // Change icon to close
                document.getElementById('ai-search-input').focus(); // Focus on input when expanded

                // Determine whether to open to the left or right
                if (currentLeft > (viewportWidth / 2)) {
                    // It's on the right half, open to the left
                    floatingSearch.style.right = '20px';
                    floatingSearch.style.left = 'auto'; // Ensure left is auto
                } else {
                    // It's on the left half, open to the right
                    floatingSearch.style.left = '20px';
                    floatingSearch.style.right = 'auto'; // Ensure right is auto
                }
                // Ensure top is maintained or set if not dragged
                if (floatingSearch.style.top === 'auto' || floatingSearch.style.top === '') {
                    floatingSearch.style.bottom = '20px';
                    floatingSearch.style.top = 'auto';
                }

            } else {
                searchIcon.textContent = '🔍'; // Change icon to search
                document.getElementById('ai-search-output').style.display = 'none'; // Hide output when collapsed
                document.getElementById('ai-search-output').innerHTML = ''; // Clear output when collapsed
                document.getElementById('ai-search-input').value = ''; // Clear input when collapsed

                // Reset position to default bottom-right on collapse
                floatingSearch.style.right = '20px';
                floatingSearch.style.bottom = '20px';
                floatingSearch.style.left = 'auto';
                floatingSearch.style.top = 'auto';
            }
        }

        // Initialize fetching news on page load
        document.addEventListener('DOMContentLoaded', fetchCybersecurityNews);

        // Remove onclick from central node as it does nothing in this version
        document.querySelector('.central-node').onclick = null;
    </script>
</body>
</html>
