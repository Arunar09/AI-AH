<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comprehensive Interactive Python & Bash Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;700&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/skulpt@1.2.0/skulpt.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/skulpt@1.2.0/skulpt-stdlib.js"></script>
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #111827; color: #E5E7EB; }
        .font-fira { font-family: 'Fira Code', monospace; }
        .tab-button.active { background-color: #3B82F6; color: white; border-bottom-color: #3B82F6; }
        .tab-button { border-bottom: 2px solid transparent; }
        .command-card { background-color: #1F2937; border: 1px solid #374151; transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out; cursor: pointer; display: flex; flex-direction: column; justify-content: space-between; }
        .command-card:hover { transform: translateY(-4px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -2px rgba(0, 0, 0, 0.1); }
        .code-block { background-color: #0d1117; border: 1px solid #30363d; }
        #code-runner { background-color: #1F2937; border: 1px solid #374151; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.4); resize: both; overflow: auto; }
        #runner-header { cursor: move; }
        .modal { background-color: rgba(0,0,0,0.8); animation: fadeIn 0.3s ease; }
        .modal-content { background: linear-gradient(135deg, #1f283e 0%, #3a4b6c 100%); }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .llm-action-button { background-color: #2563EB; color: white; border: none; padding: 8px 12px; cursor: pointer; font-size: 0.9rem; margin-right: 10px; transition: background-color 0.3s ease; border-radius: 6px; }
        .llm-action-button:hover { background-color: #1D4ED8; }
        .try-it-btn { background-color: #4F46E5; } .try-it-btn:hover { background-color: #4338CA; }
        .llm-output-area { background: rgba(0,0,0,0.3); padding: 15px; margin-top: 20px; border: 1px solid rgba(255,255,255,0.2); min-height: 50px; font-size: 0.95rem; line-height: 1.5; white-space: pre-wrap; word-wrap: break-word; display: none; border-radius: 8px; }
        .loading-indicator { display: inline-block; width: 20px; height: 20px; border: 3px solid rgba(255,255,255,0.3); border-radius: 50%; border-top-color: #3B82F6; animation: spin 1s ease-in-out infinite; vertical-align: middle; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .modal-section h3 { font-size: 1.5rem; font-weight: 600; color: #60A5FA; margin-bottom: 1rem; border-left: 3px solid #60A5FA; padding-left: 0.75rem; }
    </style>
</head>
<body class="p-4 sm:p-6 lg:p-8">
 
	<!-- Back to Landing Page Button -->
    <a href="./The Dubs.html" class="fixed top-4 left-4 z-50 bg-purple-700 text-white py-2 px-4 rounded-lg shadow-lg hover:bg-purple-800 transition duration-300 ease-in-out text-lg font-bold">
        &larr; Back to Hub
    </a>
	
    <div class="max-w-7xl mx-auto">
        <header class="text-center mb-12">
            <h1 class="text-4xl sm:text-5xl font-bold text-white mb-2">Comprehensive Interactive Guide</h1>
            <p class="text-lg text-gray-400">Detailed reference for Python & Bash with a built-in code runner.</p>
        </header>

        <div class="flex justify-center mb-8 border-b border-gray-700">
            <button id="tab-python" class="tab-button text-lg font-semibold py-3 px-6 text-gray-300 transition-colors duration-200 active" onclick="switchTab('python')">üêç Python</button>
            <button id="tab-bash" class="tab-button text-lg font-semibold py-3 px-6 text-gray-300 transition-colors duration-200" onclick="switchTab('bash')">~$ Bash</button>
        </div>

        <main id="content-python" class="space-y-12">
            <section>
                <h2 class="text-3xl font-bold text-blue-400 border-l-4 border-blue-400 pl-4 mb-6">Python Basics</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('python-variables')"><h3 class="text-xl font-semibold text-white mb-2">Variables & Data Types</h3><p class="text-gray-400">Storing and classifying data using types like integers, strings, and booleans.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('python-operators')"><h3 class="text-xl font-semibold text-white mb-2">Operators</h3><p class="text-gray-400">Performing arithmetic, comparison, and logical operations.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('python-string-formatting')"><h3 class="text-xl font-semibold text-white mb-2">String Formatting</h3><p class="text-gray-400">Embedding expressions inside string literals using f-strings.</p></div>
                </div>
            </section>
            <section>
                <h2 class="text-3xl font-bold text-blue-400 border-l-4 border-blue-400 pl-4 mb-6">Control Flow</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('python-if-else')"><h3 class="text-xl font-semibold text-white mb-2">If-Elif-Else</h3><p class="text-gray-400">Making decisions in code based on conditions.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('python-loops')"><h3 class="text-xl font-semibold text-white mb-2">For & While Loops</h3><p class="text-gray-400">Repeating actions over a sequence or until a condition is met.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('python-exceptions')"><h3 class="text-xl font-semibold text-white mb-2">Exception Handling</h3><p class="text-gray-400">Managing runtime errors gracefully with try-except blocks.</p></div>
                </div>
            </section>
            <section>
                <h2 class="text-3xl font-bold text-blue-400 border-l-4 border-blue-400 pl-4 mb-6">Data Structures</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('python-lists')"><h3 class="text-xl font-semibold text-white mb-2">Lists</h3><p class="text-gray-400">Ordered, mutable collections of items.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('python-tuples')"><h3 class="text-xl font-semibold text-white mb-2">Tuples</h3><p class="text-gray-400">Ordered, immutable collections, often used for fixed data.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('python-dicts')"><h3 class="text-xl font-semibold text-white mb-2">Dictionaries</h3><p class="text-gray-400">Unordered collections of key-value pairs for fast lookups.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('python-sets')"><h3 class="text-xl font-semibold text-white mb-2">Sets</h3><p class="text-gray-400">Unordered collections of unique elements.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('python-listcomp')"><h3 class="text-xl font-semibold text-white mb-2">List Comprehensions</h3><p class="text-gray-400">A concise and readable way to create lists.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('python-slicing')"><h3 class="text-xl font-semibold text-white mb-2">Slicing</h3><p class="text-gray-400">Extracting a portion of a sequence like a list or string.</p></div>
                </div>
            </section>
             <section>
                <h2 class="text-3xl font-bold text-blue-400 border-l-4 border-blue-400 pl-4 mb-6">Functions & Object-Oriented Programming</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('python-functions')"><h3 class="text-xl font-semibold text-white mb-2">Functions</h3><p class="text-gray-400">Reusable blocks of code that perform a specific task.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('python-lambda')"><h3 class="text-xl font-semibold text-white mb-2">Lambda Functions</h3><p class="text-gray-400">Small, anonymous functions defined with the `lambda` keyword.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('python-kwargs')"><h3 class="text-xl font-semibold text-white mb-2">*args and **kwargs</h3><p class="text-gray-400">Functions that accept a variable number of arguments.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('python-decorators')"><h3 class="text-xl font-semibold text-white mb-2">Decorators</h3><p class="text-gray-400">A way to modify or enhance functions or methods without changing their code.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('python-classes')"><h3 class="text-xl font-semibold text-white mb-2">Classes & Objects</h3><p class="text-gray-400">Blueprints for creating objects, bundling data and functionality.</p></div>
                </div>
            </section>
        </main>

        <main id="content-bash" class="space-y-12 hidden">
            <section>
                <h2 class="text-3xl font-bold text-green-400 border-l-4 border-green-400 pl-4 mb-6">File & Directory Management</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-ls')"><h3 class="text-xl font-semibold text-white mb-2">ls</h3><p class="text-gray-400">List directory contents.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-cd')"><h3 class="text-xl font-semibold text-white mb-2">cd</h3><p class="text-gray-400">Change the current directory.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-mkdir')"><h3 class="text-xl font-semibold text-white mb-2">mkdir</h3><p class="text-gray-400">Create new directories.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-cp')"><h3 class="text-xl font-semibold text-white mb-2">cp</h3><p class="text-gray-400">Copy files and directories.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-mv')"><h3 class="text-xl font-semibold text-white mb-2">mv</h3><p class="text-gray-400">Move or rename files and directories.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-rm')"><h3 class="text-xl font-semibold text-white mb-2">rm</h3><p class="text-gray-400">Remove files and directories.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-find')"><h3 class="text-xl font-semibold text-white mb-2">find</h3><p class="text-gray-400">Search for files in a directory hierarchy.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-chmod')"><h3 class="text-xl font-semibold text-white mb-2">chmod</h3><p class="text-gray-400">Change file permissions.</p></div>
                </div>
            </section>
             <section>
                <h2 class="text-3xl font-bold text-green-400 border-l-4 border-green-400 pl-4 mb-6">Text Processing & Redirection</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-cat')"><h3 class="text-xl font-semibold text-white mb-2">cat</h3><p class="text-gray-400">Concatenate and display file content.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-grep')"><h3 class="text-xl font-semibold text-white mb-2">grep</h3><p class="text-gray-400">Search for patterns in text.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-pipe')"><h3 class="text-xl font-semibold text-white mb-2">Piping |</h3><p class="text-gray-400">Chain commands by sending output of one to the input of another.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-redirect')"><h3 class="text-xl font-semibold text-white mb-2">Redirection > >></h3><p class="text-gray-400">Redirect command output to a file.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-sed')"><h3 class="text-xl font-semibold text-white mb-2">sed</h3><p class="text-gray-400">A stream editor for filtering and transforming text.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-awk')"><h3 class="text-xl font-semibold text-white mb-2">awk</h3><p class="text-gray-400">Powerful pattern scanning and processing language.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-cut')"><h3 class="text-xl font-semibold text-white mb-2">cut</h3><p class="text-gray-400">Extract sections from lines.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-head')"><h3 class="text-xl font-semibold text-white mb-2">head</h3><p class="text-gray-400">Output first part of files.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-tail')"><h3 class="text-xl font-semibold text-white mb-2">tail</h3><p class="text-gray-400">Output last part of files.</p></div>
                </div>
            </section>
            <section>
                <h2 class="text-3xl font-bold text-green-400 border-l-4 border-green-400 pl-4 mb-6">Network & Remote Operations</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-ssh')"><h3 class="text-xl font-semibold text-white mb-2">ssh</h3><p class="text-gray-400">Securely connect to a remote server.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-scp')"><h3 class="text-xl font-semibold text-white mb-2">scp</h3><p class="text-gray-400">Securely copy files between hosts.</p></div>
                </div>
            </section>
            <section>
                <h2 class="text-3xl font-bold text-green-400 border-l-4 border-green-400 pl-4 mb-6">Process & Task Management</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-ps')"><h3 class="text-xl font-semibold text-white mb-2">ps</h3><p class="text-gray-400">Report process status.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-kill')"><h3 class="text-xl font-semibold text-white mb-2">kill</h3><p class="text-gray-400">Send signals to processes.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-xargs')"><h3 class="text-xl font-semibold text-white mb-2">xargs</h3><p class="text-gray-400">Build and execute command lines from standard input.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-cron')"><h3 class="text-xl font-semibold text-white mb-2">cron</h3><p class="text-gray-400">Schedule commands to run periodically.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-tar')"><h3 class="text-xl font-semibold text-white mb-2">tar</h3><p class="text-gray-400">Archive and compress files.</p></div>
                </div>
            </section>
            <section>
                <h2 class="text-3xl font-bold text-green-400 border-l-4 border-green-400 pl-4 mb-6">System Monitoring & Utilities</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-du')"><h3 class="text-xl font-semibold text-white mb-2">du</h3><p class="text-gray-400">Estimate file space usage.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-df')"><h3 class="text-xl font-semibold text-white mb-2">df</h3><p class="text-gray-400">Report file system disk space usage.</p></div>
                </div>
            </section>
            <section>
                <h2 class="text-3xl font-bold text-green-400 border-l-4 border-green-400 pl-4 mb-6">Scripting Basics & Utilities</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-vars')"><h3 class="text-xl font-semibold text-white mb-2">Variables</h3><p class="text-gray-400">Storing and referencing data in scripts.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-if')"><h3 class="text-xl font-semibold text-white mb-2">If-Else Statements</h3><p class="text-gray-400">Executing code based on conditional logic.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-for-loop')"><h3 class="text-xl font-semibold text-white mb-2">For Loops</h3><p class="text-gray-400">Iterating over a list of items.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-history')"><h3 class="text-xl font-semibold text-white mb-2">history</h3><p class="text-gray-400">View and manage command history.</p></div>
                    <div class="command-card rounded-lg p-6" onclick="showCommandDetails('bash-alias')"><h3 class="text-xl font-semibold text-white mb-2">alias</h3><p class="text-gray-400">Create command shortcuts.</p></div>
                </div>
            </section>
        </main>
    </div>

    <div id="code-runner" class="fixed bottom-5 right-5 w-96 h-96 rounded-lg shadow-2xl flex-col hidden z-50">
        <div id="runner-header" class="bg-gray-800 p-3 flex justify-between items-center rounded-t-lg border-b border-gray-600"><h4 id="runner-title" class="text-white font-bold">Code Runner</h4><button class="text-gray-400 hover:text-white" onclick="closeRunner()">‚úñ</button></div>
        <textarea id="runner-input" class="w-full flex-grow p-3 bg-gray-900 text-gray-200 font-fira text-sm focus:outline-none resize-none" spellcheck="false"></textarea>
        <div class="p-3 bg-black/50 border-t border-gray-600"><h5 class="text-sm font-semibold text-gray-400 mb-2">Output:</h5><pre id="runner-output" class="font-fira text-sm text-gray-300 h-28 overflow-y-auto"></pre></div>
        <button id="runner-execute-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 rounded-b-lg w-full" onclick="executeCode()">Execute</button>
    </div>

    <div id="commandModal" class="modal fixed inset-0 z-40 items-center justify-center hidden" onclick="closeModal()">
        <div class="modal-content w-11/12 max-w-4xl max-h-[90vh] overflow-y-auto p-8 rounded-lg shadow-2xl" onclick="event.stopPropagation()">
            <div id="modalContent" class="text-gray-200"></div>
        </div>
    </div>

    <script>
        // --- Data Definitions ---
        const commandData = {
            // --- PYTHON DATA ---
            'python-variables': { lang: 'python', name: 'Variables & Data Types', code_sample: `name = "Alice"\nage = 30\nis_student = True\nprint(f"{name} is {age} years old.")`, details: { long_desc: "Variables are containers for storing data values. In Python, you don't need to declare the type explicitly; the type is inferred at runtime. Core data types include strings (text), integers (whole numbers), floats (decimal numbers), and booleans (True/False).", example_output: 'Alice is 30 years old.', variations: [{name: 'Multiple Assignment', code:'x, y, z = "Orange", "Banana", "Cherry"'}], scenarios:['Storing user input.', 'Keeping track of state in a program.', 'Defining configuration settings.'], pitfalls:['Variable names are case-sensitive (`age` and `Age` are different).', 'Using a keyword (like `list` or `str`) as a variable name can lead to unexpected errors.'], related:['python-operators', 'python-string-formatting'] }},
            'python-operators': { lang: 'python', name: 'Operators', code_sample: `a = 10\nb = 4\nprint(f"Addition: {a + b}")\nprint(f"Floor Division: {a // b}")\nprint(f"Is a > b? {a > b}")`, details: { long_desc: "Operators are special symbols that perform operations on variables and values. This includes arithmetic (+, -, *, /, //, %), comparison (==, !=, >, <), and logical (and, or, not) operators.", example_output: 'Addition: 14\nFloor Division: 2\nIs a > b? True', variations: [{name: 'Logical Operators', code:'age = 25\nif age > 18 and age < 65:\n    print("Is an adult")'}], scenarios:['Performing mathematical calculations.', 'Controlling program flow with conditional checks.', 'Filtering data based on criteria.'], pitfalls:['`=` is for assignment, while `==` is for comparison. Mixing them up is a common bug.'], related:['python-variables', 'python-if-else'] }},
            'python-string-formatting': { lang: 'python', name: 'String Formatting (f-strings)', code_sample: `name = "World"\nversion = 3.9\nmessage = f"Hello, {name}! Welcome to Python {version}."\nprint(message)`, details: { long_desc: "Formatted string literals, or f-strings, provide a concise and convenient way to embed Python expressions inside string literals for formatting. They are prefixed with an 'f' and use curly braces {} as placeholders.", example_output: 'Hello, World! Welcome to Python 3.9.', variations: [{name: 'Formatting numbers', code:'price = 19.99\nprint(f"The price is ${price:.2f}")'}], scenarios:['Creating dynamic log messages.', 'Generating user-friendly output.', 'Constructing database queries.'], pitfalls:['F-strings were introduced in Python 3.6. For older versions, you must use `.format()` or the `%` operator.'], related:['python-variables'] }},
            'python-if-else': { lang: 'python', name: 'Conditional Statements', code_sample: `temp = 25\nif temp > 30:\n    print("It's hot outside.")\nelif temp < 10:\n    print("It's cold outside.")\nelse:\n    print("The weather is pleasant.")`, details: { long_desc: "Control flow statements allow you to execute certain blocks of code only when specific conditions are met. `if` is used for the primary condition, `elif` (else if) for alternative conditions, and `else` for the default case.", example_output: "The weather is pleasant.", variations: [{name: 'Ternary Operator (Conditional Expression)', code:'age = 25\nstatus = "Adult" if age >= 18 else "Minor"'}], scenarios:['Validating user input.', 'Controlling program behavior based on state.', 'Handling different types of data.'], pitfalls:['Make sure the condition evaluates to a boolean (True/False). Indentation is crucial and defines the code block to be executed.'], related:['python-operators', 'python-loops'] }},
            'python-loops': { lang: 'python', name: 'For & While Loops', code_sample: `print("For loop:")\nfor i in range(3):\n    print(i)\n\nprint("While loop:")\ncount = 0\nwhile count < 3:\n    print(count)\n    count += 1`, details: { long_desc: "`for` loops are used for iterating over a sequence (like a list, tuple, or string). `while` loops are used to repeat a block of code as long as a condition is true.", example_output: 'For loop:\n0\n1\n2\n\nWhile loop:\n0\n1\n2', variations: [{name: 'Looping with `enumerate`', code:'for index, value in enumerate(["a", "b"]):\n    print(f"{index}: {value}")'}], scenarios:['Processing each item in a list.', 'Reading a file line by line.', 'Running a game loop until the user quits.'], pitfalls:['Forgetting to increment the counter in a `while` loop can lead to an infinite loop.'], related:['python-lists', 'python-if-else'] }},
            'python-exceptions': { lang: 'python', name: 'Exception Handling', code_sample: `try:\n    result = 10 / 0\nexcept ZeroDivisionError as e:\n    print(f"Error: {e}")\nfinally:\n    print("This block always runs.")`, details: { long_desc: "Exception handling allows your program to deal with runtime errors without crashing. The `try` block contains code that might raise an error. The `except` block catches and handles the specific error. The `finally` block contains code that will run regardless of whether an error occurred.", example_output: "Error: division by zero\nThis block always runs.", variations: [{name: 'Handling multiple exceptions', code:'try:\n    # code\nexcept (ValueError, TypeError):\n    print("Handling multiple errors")'}], scenarios:['Handling potential errors from file I/O (e.g., file not found).', 'Validating user input that might be in the wrong format.', 'Dealing with network connection errors.'], pitfalls:['Using a bare `except:` clause will catch all errors, including system-exiting ones, which can hide bugs. It\'s better to catch specific exceptions.'], related:[] }},
            'python-lists': { lang: 'python', name: 'Lists', code_sample: `fruits = ["apple", "banana"]\nfruits.append("cherry")\nfruits[0] = "orange"\nprint(fruits)`, details: { long_desc: "Lists are one of Python's most versatile data structures. They are ordered, meaning items have a defined position, and mutable, meaning you can change, add, and remove items after the list has been created.", example_output: "['orange', 'banana', 'cherry']", variations: [{name: 'Removing an item', code:'fruits.remove("banana")\nprint(fruits)'}], scenarios:['Storing a collection of user data.', 'Creating a queue of tasks to be processed.', 'Representing a sequence of steps in a process.'], pitfalls:['Assigning a list to a new variable (`new_list = old_list`) does not create a copy; it creates another reference to the same list. To copy, use `new_list = old_list.copy()` or `new_list = old_list[:]`.'], related:['python-tuples', 'python-loops', 'python-slicing'] }},
            'python-tuples': { lang: 'python', name: 'Tuples', code_sample: `point = (10, 20)\nprint(f"X: {point[0]}, Y: {point[1]}")`, details: { long_desc: "Tuples are similar to lists but they are immutable, meaning their contents cannot be changed after creation. They are often used to store fixed collections of related data, like coordinates or database records.", example_output: "X: 10, Y: 20", variations: [{name: 'Tuple unpacking', code:'x, y = point\nprint(f"Unpacked: {x}, {y}")'}], scenarios:['Returning multiple values from a function.', 'Using as keys in a dictionary (since they are immutable).', 'Protecting data from accidental modification.'], pitfalls:['Trying to change an item in a tuple (`point[0] = 5`) will result in a `TypeError`.'], related:['python-lists'] }},
            'python-dicts': { lang: 'python', name: 'Dictionaries', code_sample: `user = {"name": "Alice", "age": 25}\nuser["city"] = "New York"\nprint(user.get("name"))`, details: { long_desc: "Dictionaries store data in key-value pairs. They are optimized for retrieving a value when you know the key. Keys must be unique and immutable (like strings, numbers, or tuples).", example_output: "Alice", variations: [{name: 'Iterating over keys and values', code:'for key, value in user.items():\n    print(f"{key}: {value}")'}], scenarios:['Representing JSON objects.', 'Fast lookups for data associated with a unique ID.', 'Counting frequencies of items.'], pitfalls:['Accessing a non-existent key with `user["key"]` will raise a `KeyError`. Use `user.get("key")` to safely access it, which returns `None` if the key is not found.'], related:['python-sets', 'python-listcomp'] }},
            'python-sets': { lang: 'python', name: 'Sets', code_sample: `numbers = {1, 2, 3, 2, 1}\nprint(numbers)\nnumbers.add(4)\nprint(4 in numbers)`, details: { long_desc: "A set is an unordered collection with no duplicate elements. They are highly useful for membership testing, removing duplicates from other collections, and performing mathematical set operations like union, intersection, and difference.", example_output: "{1, 2, 3}\nTrue", variations: [{name: 'Set intersection', code:'set1 = {1, 2, 3}\nset2 = {3, 4, 5}\nprint(set1.intersection(set2))'}], scenarios:['Finding unique items in a list.', 'Checking for common elements between two sets of data.', 'Fast membership testing (checking if an item exists).'], pitfalls:['Since sets are unordered, they cannot be indexed or sliced like lists.'], related:['python-dicts', 'python-lists'] }},
            'python-listcomp': { lang: 'python', name: 'List Comprehensions', code_sample: `squares = [x * x for x in range(5)]\nprint(squares)`, details: { long_desc: "List comprehensions provide a short and readable syntax for creating a new list by performing an operation on each item in an existing sequence, often with an optional filter condition.", example_output: "[0, 1, 4, 9, 16]", variations: [{name: 'Comprehension with a condition', code:'even_squares = [x*x for x in range(10) if x % 2 == 0]'}], scenarios:['Filtering data from a large list.', 'Transforming a list of items into a new format.', 'Creating flat lists from nested data.'], pitfalls:['For very complex logic, a standard `for` loop might be more readable than a long, complicated list comprehension.'], related:['python-lambda', 'python-lists'] }},
            'python-slicing': { lang: 'python', name: 'Slicing', code_sample: `letters = ['a', 'b', 'c', 'd', 'e']\nfirst_three = letters[0:3] # or letters[:3]\nlast_two = letters[-2:]\nprint(first_three)\nprint(last_two)`, details: { long_desc: "Slicing is a feature that lets you access a sub-sequence of a list, tuple, or string. The syntax is `sequence[start:stop:step]`, where all parts are optional.", example_output: "['a', 'b', 'c']\n['d', 'e']", variations: [{name: 'Reversing a list', code:'reversed_letters = letters[::-1]'}], scenarios:['Getting a subset of data.', 'Creating a shallow copy of a list (`new_list = old_list[:]`).', 'Extracting parts of a string for parsing.'], pitfalls:['The `stop` index in a slice is exclusive, meaning the element at that index is not included in the result.'], related:['python-lists', 'python-tuples'] }},
            'python-functions': { lang: 'python', name: 'Functions', code_sample: `def greet(name):\n    return f"Hello, {name}!"\n\nmessage = greet("Developer")\nprint(message)`, details: { long_desc: "Functions are defined using the `def` keyword. They allow you to group code into reusable blocks, making your program more organized, efficient, and readable. They can take input parameters and return output values.", example_output: "Hello, Developer!", variations: [{name: 'Function with default arguments', code:'def greet(name="Guest"):\n    return f"Hello, {name}!"'}], scenarios:['Encapsulating a piece of logic that is used multiple times.', 'Breaking down a complex problem into smaller, manageable parts.', 'Improving code organization and reusability.'], pitfalls:['Variables created inside a function are local to that function and cannot be accessed from outside unless returned.'], related:['python-lambda', 'python-decorators'] }},
            'python-lambda': { lang: 'python', name: 'Lambda Functions', code_sample: `add = lambda x, y: x + y\nresult = add(5, 3)\nprint(result)`, details: { long_desc: "A lambda function is a small, anonymous function defined with the `lambda` keyword. It can take any number of arguments, but can only have one expression. They are best used for short, simple operations.", example_output: "8", variations: [{name: 'Using lambda with `sorted`', code:'points = [(1, 2), (3, 1), (5, -4)]\npoints.sort(key=lambda p: p[1])'}], scenarios:['As a quick, one-off function for arguments to higher-order functions like `sorted()`, `map()`, or `filter()`.'], pitfalls:['Lambda functions are syntactically restricted to a single expression. For more complex logic, a standard `def` function is more appropriate and readable.'], related:['python-functions', 'python-decorators'] }},
            'python-kwargs': { lang: 'python', name: '*args and **kwargs', code_sample: `def show_info(*args, **kwargs):\n    print("Positional:", args)\n    print("Keyword:", kwargs)\n\nshow_info(1, 2, name="Alice", age=30)`, details: { long_desc: "This special syntax allows a function to accept a variable number of arguments. `*args` collects extra positional arguments into a tuple. `**kwargs` collects extra keyword arguments into a dictionary.", example_output: "Positional: (1, 2)\nKeyword: {'name': 'Alice', 'age': 30}", variations: [{name: 'Using to wrap another function', code:'def wrapper(*a, **kw):\n    print("Calling wrapped function")\n    another_function(*a, **kw)'}], scenarios:['Creating flexible, general-purpose functions.', 'Writing decorators that need to work with any function signature.', 'Subclassing and calling parent methods.'], pitfalls:['The names `args` and `kwargs` are a convention. The important part is the `*` and `**`. Sticking to the convention is highly recommended for clarity.'], related:['python-functions', 'python-decorators'] }},
            'python-decorators': { lang: 'python', name: 'Decorators', code_sample: `def my_decorator(func):\n    def wrapper():\n        print("Something is happening before the function is called.")\n        func()\n        print("Something is happening after the function is called.")\n    return wrapper\n\n@my_decorator\ndef say_whee():\n    print("Whee!")\n\nsay_whee()`, details: { long_desc: "A decorator is a function that takes another function as input, adds some functionality to it, and returns the modified function. The `@` syntax is syntactic sugar for this process.", example_output: "Something is happening before the function is called.\nWhee!\nSomething is happening after the function is called.", variations: [], scenarios:['Logging function calls.', 'Timing how long a function takes to run.', 'Enforcing authentication or permissions before running a function.'], pitfalls:['Decorators can make debugging more complex as they add a layer of abstraction. The `functools.wraps` decorator should be used inside your decorator to preserve the original function\'s metadata.'], related:['python-functions'] }},
            'python-classes': { lang: 'python', name: 'Classes & Objects', code_sample: `class Dog:\n    def __init__(self, name):\n        self.name = name\n\n    def bark(self):\n        return f"{self.name} says woof!"\n\nd = Dog("Rex")\nprint(d.bark())`, details: { long_desc: "Classes provide a way of bundling data and functionality together. Creating a new class creates a new type of object, allowing new instances of that type to be made. Each class instance can have attributes attached to it for maintaining its state, and methods for modifying its state.", example_output: "Rex says woof!", variations: [{name: 'Class Inheritance', code:'class LoudDog(Dog):\n    def bark(self):\n        return f"{self.name.upper()} SAYS WOOF!"'}], scenarios:['Modeling real-world entities like users, products, or cars.', 'Creating structured, reusable components like GUI widgets or database connections.', 'Organizing large codebases into logical units.'], pitfalls:['Understanding the difference between class variables (shared by all instances) and instance variables (unique to each instance) is key.'], related:[] }},

            // --- BASH DATA ---
            'bash-ls': { lang: 'bash', name: 'ls - List Directory Contents', code_sample: `ls -la`, details: { long_desc: 'The `ls` command lists files and directories. The `-l` flag provides a long listing format (with permissions, owner, size, date), and the `-a` flag shows all files, including hidden ones (starting with a dot).', example_output: 'drwxr-xr-x 2 user user 4096 Jun 26 10:00 .\n-rw-r--r-- 1 user user   28 Jun 26 10:00 file.txt', variations: [{name: 'List by time, reversed (newest last)', code:'ls -ltr'}, {name: 'List with human-readable sizes', code:'ls -lh'}], scenarios:['Quickly checking the contents of a folder.', 'Verifying file permissions and ownership.', 'Finding recently modified files.'], pitfalls:['The output format of `ls` can vary between systems. For reliable scripting, using `find` or other methods is often safer.'], related:['bash-cd', 'bash-find'] }},
            'bash-cd': { lang: 'bash', name: 'cd - Change Directory', code_sample: `cd /tmp\npwd`, details: { long_desc: 'The `cd` command changes your current working directory, allowing you to navigate the filesystem.', example_output: '/tmp', variations: [{name: 'Go to home directory', code:'cd'}, {name: 'Go to previous directory', code:'cd -'}], scenarios:['Moving into a project folder to work.', 'Navigating to system directories to check configuration files.'], pitfalls:['If a directory name has spaces, you must enclose it in quotes: `cd "My Documents"`.'], related:['bash-ls', 'bash-pwd'] }},
            'bash-mkdir': { lang: 'bash', name: 'mkdir - Make Directory', code_sample: `mkdir my_new_project`, details: { long_desc: 'Use `mkdir` to create one or more new directories.', example_output: '', variations: [{name: 'Create parent directories as needed', code:'mkdir -p path/to/deep/folder'}], scenarios:['Setting up a new project structure.', 'Creating a temporary directory for storing output files.'], pitfalls:['By default, `mkdir` will error if the parent directory doesn\'t exist. Use the `-p` flag to create the entire path.'], related:['bash-touch', 'bash-rm'] }},
            'bash-cp': { lang: 'bash', name: 'cp - Copy', code_sample: `echo "content" > source.txt\ncp source.txt destination.txt`, details: { long_desc: 'The `cp` command copies files or directories from a source to a destination.', example_output: '', variations: [{name: 'Copy directory recursively', code:'cp -r my_project/ my_project_backup/'}, {name: 'Interactive prompt before overwriting', code:'cp -i source.txt dest.txt'}], scenarios:['Backing up a configuration file before editing.', 'Duplicating a project directory.'], pitfalls:['`cp` will overwrite the destination file without warning. The `-i` (interactive) flag is useful to prevent accidental overwrites.'], related:['bash-mv', 'bash-rm'] }},
            'bash-mv': { lang: 'bash', name: 'mv - Move/Rename', code_sample: `touch old_name.txt\nmv old_name.txt new_name.txt`, details: { long_desc: 'The `mv` command moves a file or directory to a new location, or renames it if the source and destination are in the same directory.', example_output: '', variations: [{name: 'Move file to another directory', code:'mv new_name.txt /tmp/'}], scenarios:['Renaming a file.', 'Organizing files by moving them into different folders.'], pitfalls:['Like `cp`, `mv` will overwrite an existing file at the destination without warning. Use `-i` for an interactive prompt.'], related:['bash-cp', 'bash-rm'] }},
            'bash-rm': { lang: 'bash', name: 'rm - Remove', code_sample: `touch to_delete.txt\nrm to_delete.txt`, details: { long_desc: 'The `rm` command is used to delete files. Use with caution, as deleted files are generally not recoverable.', example_output: '', variations: [{name: 'Remove a directory and its contents recursively', code:'rm -r old_project/'}, {name: 'Force removal without prompting', code:'rm -f unneeded_file.txt'}], scenarios:['Cleaning up temporary files.', 'Deleting old log files.'], pitfalls:['`rm -rf /` is a catastrophic command that will attempt to delete everything on your filesystem. Double-check any `rm -r` command before running it.'], related:['bash-mkdir', 'bash-touch'] }},
            'bash-find': { lang: 'bash', name: 'find - Find Files', code_sample: `find . -name "*.txt"`, details: { long_desc: '`find` is a powerful utility to search for files and directories based on various criteria like name, size, modification time, and type.', example_output: './file.txt\n./source.txt\n./sample.txt\n./script.sh', variations: [{name: 'Find by type (d for directory, f for file)', code:'find /tmp -type d'}, {name: 'Execute a command on found files', code:'find . -name "*.log" -exec rm {} \\;'}], scenarios:['Finding all Python files in a project.', 'Locating large files that are taking up disk space.', 'Deleting all temporary files older than 7 days.'], pitfalls:['The `-exec` action can be dangerous if not used carefully, especially with `rm`. It\'s often safer to pipe the output to `xargs`.'], related:['bash-ls', 'bash-grep'] }},
            'bash-chmod': { lang: 'bash', name: 'chmod - Change File Permissions', code_sample: `touch script.sh\nchmod +x script.sh\n# The simulated output might not reflect actual permissions change`, details: { long_desc: 'The `chmod` command changes file mode bits (permissions). Permissions control who can read, write, or execute a file. Permissions can be set numerically (e.g., `755`) or symbolically (e.g., `u+x`).', example_output: '', variations: [{name: 'Grant read/write to owner, read-only to others (744)', code:'chmod 744 my_file.txt'}, {name: 'Make file writable for group', code:'chmod g+w data.txt'}], scenarios:['Making a script executable.', 'Restricting access to sensitive configuration files.', 'Allowing a web server to read certain files.'], pitfalls:['Incorrect use of `chmod` can lead to security vulnerabilities (too permissive) or make files unusable (too restrictive). Always understand what permissions you are setting. Use `ls -l` to verify.'], related:['bash-chown', 'bash-ls'] }},
            'bash-cat': { lang: 'bash', name: 'cat - Concatenate and Display', code_sample: `echo "Line 1" > file.txt\necho "Line 2" >> file.txt\ncat file.txt`, details: { long_desc: 'The `cat` command reads files sequentially and writes their content to standard output. It\'s commonly used to quickly view the contents of a file.', example_output: 'Line 1\nLine 2', variations: [{name: 'Display with line numbers', code:'cat -n file.txt'}], scenarios:['Viewing the contents of a small text file.', 'Concatenating multiple files into one (`cat file1.txt file2.txt > combined.txt`).'], pitfalls:['Using `cat` on a very large file will dump the entire content to your terminal, which can be slow. Use `less` or `more` to view large files paginated.'], related:['bash-head', 'bash-tail'] }},
            'bash-grep': { lang: 'bash', name: 'grep - Search Text', code_sample: `echo -e "hello\\nworld\\nhello again" | grep "hello"`, details: { long_desc: '`grep` searches for lines containing a pattern. It\'s an essential tool for filtering log files and command output.', example_output: 'hello\nhello again', variations: [{name: 'Case-insensitive search', code:'grep -i "pattern" file.txt'}, {name: 'Recursive search in directory', code:'grep -r "pattern" .'}, {name: 'Show lines NOT matching pattern', code:'echo -e "apple\\nbanana\\norange" | grep -v "banana"'}], scenarios:['Finding error messages in a log file.', 'Filtering `ps` output to find a specific process.', 'Searching for a function definition in source code.'], pitfalls:['By default, `grep` uses Basic Regular Expressions. Use `grep -E` for Extended Regular Expressions, which are often more powerful and familiar.'], related:['bash-pipe', 'bash-find'] }},
            'bash-pipe': { lang: 'bash', name: 'Piping |', code_sample: `ps aux | grep "bash" | wc -l`, details: { long_desc: 'The pipe `|` operator takes the standard output of the command on its left and uses it as the standard input for the command on its right. This allows youto build powerful command-line workflows.', example_output: '1', variations: [{name: 'Chaining with `sort` and `uniq`', code:'cat names.txt | sort | uniq -c'}], scenarios:['Filtering the output of a command.', 'Counting the number of files in a directory (`ls | wc -l`).', 'Chaining multiple filters together (`cat log.txt | grep "ERROR" | tail -n 10`).'], pitfalls:['Piping only redirects standard output (stdout), not standard error (stderr). To redirect both, you might need to use `2>&1 |`.'], related:['bash-redirect', 'bash-grep', 'bash-wc'] }},
            'bash-redirect': { lang: 'bash', name: 'Redirection > >>', code_sample: `echo "Overwrite" > file.log\necho "Append" >> file.log\ncat file.log`, details: { long_desc: 'Redirection changes where command output goes. `>` overwrites a file with the output. `>>` appends the output to the end of a file.', example_output: 'Overwrite\nAppend', variations: [{name: 'Redirect standard error', code:'bad_command 2> errors.log'}, {name: 'Redirect stdout and stderr to a file', code:'command > file.txt 2>&1'}], scenarios:['Saving command output to a file for later analysis.', 'Creating log files from scripts.', 'Suppressing unwanted output by redirecting to `/dev/null`.'], pitfalls:['Be very careful with `>`. It will instantly overwrite the destination file without any warning. `>>` is generally safer if you want to preserve content.'], related:['bash-pipe', 'bash-cat'] }},
            'bash-sed': { lang: 'bash', name: 'sed - Stream Editor', code_sample: `echo "hello world" | sed 's/world/developer/g'`, details: { long_desc: '`sed` is a powerful stream editor for performing text transformations on an input stream (a file or input from a pipe). The most common use is for substitution (search and replace). The `g` flag means global replacement (all occurrences on a line).', example_output: 'hello developer', variations: [{name: 'In-place file editing', code:'sed -i \'s/old/new/g\' file.txt'}, {name: 'Delete lines containing a pattern', code:'echo -e "line1\\nDELETE THIS\\nline3" | sed \'/DELETE/d\''}, {name: 'Replace first occurrence only', code:'echo "hello world world" | sed \'s/world/universe/\''}], scenarios:['Replacing text in a file.', 'Deleting specific lines from a file.', 'Performing complex text transformations in a script.'], pitfalls:['`sed` syntax can be cryptic. The `-i` flag modifies the file directly, which can be destructive; it\'s good practice to test without it first.'], related:['bash-awk', 'bash-grep'] }},
            'bash-awk': { lang: 'bash', name: 'awk - Text Processor', code_sample: `echo -e "Name Age City\\nAlice 25 NewYork\\nBob 30 London" | awk 'NR==1 {print "Header: " $0} NR>1 {print "User: " $1 ", Age: " $2}'`, details: { long_desc: '`awk` is a versatile programming language for working with text files. It processes files line by line, automatically splitting each line into fields, making it excellent for processing column-based data. `NR` is the record number, `$0` is the whole line, `$1`, `$2`, etc., are fields.', example_output: 'Header: Name Age City\nUser: Alice, Age: 25\nUser: Bob, Age: 30', variations: [{name: 'Using a different field separator', code:'echo "user:1001:comment" | awk -F: \'{print $1 " has ID " $2}\''}, {name: 'Filter and sum a column', code:'echo -e "item1 10\\nitem2 20\\nitem3 15" | awk \'{sum+=$2} END {print "Total: " sum}\''}, {name: 'Print lines matching pattern', code:'echo -e "apple\\nbanana\\norange" | awk \'/anana/\''}], scenarios:['Extracting specific columns of data from a text file.', 'Summing up values in a column.', 'Generating reports from structured text or log files.'], pitfalls:['`awk` is a full programming language and can become complex. For simple column cutting, the `cut` command might be easier.'], related:['bash-sed', 'bash-cut'] }},
            'bash-cut': { lang: 'bash', name: 'cut - Extract Sections from Lines', code_sample: `echo "apple:red:fruit\\nbanana:yellow:fruit" | cut -d: -f1,3`, details: { long_desc: 'The `cut` command extracts sections from each line of files or piped input. It can cut by byte position (`-b`), character position (`-c`), or by delimited fields (`-d` and `-f`).', example_output: 'apple:fruit\nbanana:fruit', variations: [{name: 'Cut by characters', code:'echo "Hello World" | cut -c1-5'}, {name: 'Cut second field with space delimiter', code:'echo "First Second Third" | cut -d\' \' -f2'}], scenarios:['Extracting specific columns from CSV files.', 'Parsing log entries to get a particular data point.', 'Reformatting text data for other commands.'], pitfalls:['`cut` is simpler than `awk` but less flexible. It cannot perform calculations or complex pattern matching. Handling multiple spaces as a single delimiter can be tricky; `awk` is better for that.'], related:['bash-awk', 'bash-sed'] }},
            'bash-head': { lang: 'bash', name: 'head - Output First Part of Files', code_sample: `echo -e "Line 1\\nLine 2\\nLine 3\\nLine 4\\nLine 5" > sample.txt\nhead -n 3 sample.txt`, details: { long_desc: 'The `head` command outputs the first part of files (by default, the first 10 lines). It\'s useful for quickly inspecting the beginning of large log files or data files.', example_output: 'Line 1\nLine 2\nLine 3', variations: [{name: 'View first line', code:'head -n 1 logfile.log'}, {name: 'View first 20 bytes', code:'head -c 20 file.bin'}], scenarios:['Quickly checking the header of a CSV file.', 'Viewing the latest configuration changes in a file.', 'Debugging scripts by examining initial output.'], pitfalls:['For very large files, `head` is efficient because it stops reading after the specified amount. Always remember to use the correct options for lines (`-n`) or bytes (`-c`).'], related:['bash-tail', 'bash-cat'] }},
            'bash-tail': { lang: 'bash', name: 'tail - Output Last Part of Files', code_sample: `echo -e "Line 1\\nLine 2\\nLine 3\\nLine 4\\nLine 5" > sample.txt\ntail -n 2 sample.txt`, details: { long_desc: 'The `tail` command outputs the last part of files (by default, the last 10 lines). It\'s frequently used to monitor log files in real-time with the `-f` (follow) option.', example_output: 'Line 4\nLine 5', variations: [{name: 'Monitor log file in real-time', code:'tail -f /var/log/syslog'}, {name: 'View last 50 bytes', code:'tail -c 50 file.bin'}], scenarios:['Monitoring active log files for new entries.', 'Checking the end of a long data processing output.', 'Extracting the most recent entries from a history file.'], pitfalls:['The `-f` option keeps the file open and continues to display new lines, which is great for logs but will keep your terminal busy. Use Ctrl+C to exit.'], related:['bash-head', 'bash-cat'] }},
            'bash-ssh': { lang: 'bash', name: 'ssh - Secure Shell', code_sample: `ssh user@remote.example.com "ls -lh /var/log"`, details: { long_desc: '`ssh` (Secure Shell) is a cryptographic network protocol for operating network services securely over an unsecured network. It is primarily used for remote command-line login and remote command execution. It encrypts the connection, making it secure.', example_output: 'total 1.5M\n-rw-r----- 1 syslog adm 1.2M Jun 26 09:00 syslog', variations: [{name: 'SSH with port forwarding', code:'ssh -L 8080:localhost:80 user@remote.example.com'}, {name: 'Execute multiple commands', code:'ssh user@host "cd /app && ./restart_service.sh"'}], scenarios:['Logging into a remote server to administer it.', 'Executing commands on a remote machine non-interactively.', 'Setting up secure tunnels for network traffic.'], pitfalls:['Incorrect SSH key permissions can prevent login. Ensure `~/.ssh/id_rsa` has permissions `600`. Firewalls can block SSH access (port 22 by default).'], related:['bash-scp', 'bash-rsync'] }},
            'bash-scp': { lang: 'bash', name: 'scp - Secure Copy', code_sample: `echo "local file content" > local.txt\n# This command would copy local.txt to remote.example.com\n# scp local.txt user@remote.example.com:/tmp/remote.txt\n# For simulation, imagine it copied.`, details: { long_desc: '`scp` (Secure Copy Protocol) allows for secure transfer of files between the local host and a remote host, or between two remote hosts. It uses SSH for data transfer and provides the same authentication and security as SSH.', example_output: 'local.txt                                     100%   20     0.0KB/s   00:00', variations: [{name: 'Copy from remote to local', code:'scp user@remote.example.com:/tmp/remote.txt ./local_copy.txt'}, {name: 'Copy directory recursively', code:'scp -r my_local_dir/ user@remote.example.com:/tmp/'}], scenarios:['Deploying files to a web server.', 'Retrieving log files from a remote machine.', 'Backing up remote configuration files locally.'], pitfalls:['Similar to `cp`, `scp` will overwrite files at the destination without prompting. Use caution.', 'Ensure correct file paths and permissions on both local and remote ends.'], related:['bash-ssh', 'bash-rsync'] }},
            'bash-ps': { lang: 'bash', name: 'ps - Report Process Status', code_sample: `ps aux`, details: { long_desc: 'The `ps` command displays information about currently running processes. `aux` is a common combination of options: `a` shows all processes, `u` shows user-oriented format, `x` shows processes without a controlling tty.', example_output: 'USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nroot         1  0.0  0.1  10000  5000 ?        Ss   Jun01   0:02 /sbin/init\nuser      1234  0.0  0.1  12345  6789 pts/0 Ss+  10:00   0:00 /bin/bash\nuser      5678  0.0  0.0  10000  2000 pts/0 R+   10:01   0:00 python script.py', variations: [{name: 'Show processes in a tree format', code:'ps -ef | less'}, {name: 'Filter for specific process', code:'ps aux | grep "apache"'}], scenarios:['Identifying runaway processes consuming CPU or memory.', 'Finding the PID of a process to kill it.', 'Monitoring system activity and resource usage.'], pitfalls:['The output of `ps` can be very long. Pipe it to `less` or `grep` to manage output. The meaning of columns can vary, so check `man ps`.'], related:['bash-kill', 'bash-top'] }},
            'bash-kill': { lang: 'bash', name: 'kill - Send Signals to Processes', code_sample: `echo "To simulate: find PID from 'ps aux' then use 'kill PID'"\n# For example, to stop a simulated process with PID 1234:\nkill 1234`, details: { long_desc: 'The `kill` command sends signals to processes, typically to terminate them. The most common signal is `SIGTERM` (15, polite termination), followed by `SIGKILL` (9, forceful termination).', example_output: 'Simulating sending SIGTERM to PID 1234. Process 1234 (bash) would normally terminate.', variations: [{name: 'Forceful kill (SIGKILL)', code:'kill -9 1234'}, {name: 'List signals', code:'kill -l'}], scenarios:['Stopping a frozen or unresponsive application.', 'Terminating background processes gracefully.', 'Automating process management in scripts.'], pitfalls:['`kill -9` should be a last resort as it doesn\'t allow the process to clean up. Always try `kill PID` first. Killing critical system processes can lead to instability.'], related:['bash-ps'] }},
            'bash-xargs': { lang: 'bash', name: 'xargs - Build and Execute Command Lines', code_sample: `touch file1.txt file2.log file3.txt\nfind . -name "*.txt" | xargs rm`, details: { long_desc: '`xargs` reads items from standard input, delimited by blanks (which can be protected with quotes or backslashes) or newlines, and executes the command one or more times using these items as arguments.', example_output: '\n> rm "file1.txt"\n\n> rm "file3.txt"\n', variations: [{name: 'Process files with spaces in names', code:'find . -name "*.txt" -print0 | xargs -0 rm'}, {name: 'Execute command for each item', code:'ls *.txt | xargs -I {} mv {} {}.bak'}], scenarios:['Deleting multiple files found by `find`.', 'Converting multi-line output into arguments for a command.', 'Running a command on a list of items efficiently.'], pitfalls:['Without `-0` (null delimiter), `xargs` can have issues with filenames containing spaces or special characters. Always prefer `-print0` with `find` and `-0` with `xargs`.'], related:['bash-find', 'bash-pipe'] }},
            'bash-cron': { lang: 'bash', name: 'cron - Schedule Commands', code_sample: `echo "This would open your crontab editor."\n# To add a job: echo "*/5 * * * * echo 'Hello every 5 minutes' >> /tmp/mylog.log" | crontab -\n# This is a simulation, so no actual cron job will be set.`, details: { long_desc: '`cron` is a time-based job scheduler in Unix-like operating systems. `crontab` is the command used to manage cron jobs. Jobs are scheduled using a specific syntax (minute hour day-of-month month day-of-week command).', example_output: 'This would open your crontab editor.', variations: [{name: 'List existing cron jobs', code:'crontab -l'}, {name: 'Edit cron jobs', code:'crontab -e'}], scenarios:['Automating daily backups.', 'Running system maintenance scripts at off-peak hours.', 'Sending periodic reports via email.'], pitfalls:['Cron jobs run in a minimal environment, so full paths to commands and environmental variables often need to be specified within the cron job itself. Output is mailed to the user by default if not redirected.'], related:[] }},
            'bash-tar': { lang: 'bash', name: 'tar - Archive and Compress Files', code_sample: `mkdir my_folder\ntouch my_folder/file1.txt my_folder/file2.txt\ntar -cvf my_archive.tar my_folder/\n# For simulation, imagine the archive is created.`, details: { long_desc: '`tar` (tape archive) is used to create and extract archive files. It\'s commonly used with compression utilities like `gzip` (`-z`) or `bzip2` (`-j`) to create compressed archives (`.tar.gz`, `.tgz`, `.tar.bz2`).', example_output: 'my_folder/\nmy_folder/file1.txt\nmy_folder/file2.txt\nsimulated: archive \'my_archive.tar\' created.', variations: [{name: 'Create a gzipped tar archive', code:'tar -czvf my_archive.tar.gz my_folder/'}, {name: 'Extract a gzipped tar archive', code:'tar -xzvf my_archive.tar.gz'}], scenarios:['Creating backups of directories.', 'Packaging software for distribution.', 'Compressing multiple files into a single, smaller file.'], pitfalls:['When extracting, `tar` will overwrite existing files without prompting unless specified otherwise. Always be aware of the current directory when extracting.'], related:['bash-gzip', 'bash-bzip2'] }},
            'bash-du': { lang: 'bash', name: 'du - Estimate File Space Usage', code_sample: `mkdir test_dir\necho "big content" > test_dir/bigfile.txt\ndu -sh test_dir/`, details: { long_desc: 'The `du` (disk usage) command estimates file space usage. It is used to find out the disk space taken by a directory or a set of files.', example_output: '4.0K\ttest_dir/\n', variations: [{name: 'Human-readable sizes for current directory', code:'du -h .'}, {name: 'Summarize total size for directories', code:'du -sh *'}], scenarios:['Finding out which directories are consuming the most disk space.', 'Monitoring disk usage of applications.', 'Cleaning up old or large files.'], pitfalls:['`du` reports disk space *allocated* to files, which can be different from their actual size due to block sizes. For overall filesystem capacity, use `df`.'], related:['bash-df'] }},
            'bash-df': { lang: 'bash', name: 'df - Report File System Disk Space Usage', code_sample: `df -h`, details: { long_desc: 'The `df` (disk free) command reports file system disk space usage. It shows the total, used, and available disk space for all mounted filesystems.', example_output: 'Filesystem      Size  Used Avail Use% Mounted on\n/dev/sda1        50G   20G   28G  42% /', variations: [{name: 'Show inode usage', code:'df -i'}, {name: 'Exclude specific filesystems', code:'df -hT --exclude-type=tmpfs'}], scenarios:['Checking overall disk space availability on a server.', 'Identifying full partitions before they cause issues.', 'Monitoring storage capacity over time.'], pitfalls:['`df` shows filesystem-level information, not individual file/directory sizes. For that, use `du`.'], related:['bash-du'] }},
            'bash-history': { lang: 'bash', name: 'history - Command History', code_sample: `history 5`, details: { long_desc: 'The `history` command displays a list of previously executed commands. This is incredibly useful for recalling complex commands or re-running them quickly. Bash stores history in `~/.bash_history`.', example_output: '  1 ls -la\n  2 cd /tmp\n  3 echo "Hello"\n  4 cat file.txt\n  5 history 5\n', variations: [{name: 'Search history (Ctrl+R)', code:'# Press Ctrl+R and type a command to search'}, {name: 'Execute previous command by number', code:'!123 # (assuming 123 is a history number)'}], scenarios:['Finding a command you ran yesterday.', 'Re-running a long command with a slight modification.', 'Auditing commands run on a system.'], pitfalls:['History can be disabled or limited. Commands with sensitive information (like passwords) should be avoided in history or cleared.'], related:[] }},
            'bash-alias': { lang: 'bash', name: 'alias - Create Command Shortcuts', code_sample: `alias ll='ls -lh'\nll`, details: { long_desc: 'The `alias` command allows you to create shortcuts for longer commands. Aliases are session-specific unless defined in your shell\'s configuration file (e.g., `~/.bashrc` or `~/.zshrc`).', example_output: '\n> alias ll=\'ls -lh\'\n\n> ll\n-rw-r--r-- 1 user user   28 Jan 01 00:00 file.txt\n-rw-r--r-- 1 user user   60 Jan 01 00:00 names.txt\n-rw-r--r-- 1 user user   30 Jan 01 00:00 sample.txt\n-rw-r--r-- 1 user user   30 Jan 01 00:00 script.sh\n-rw-r--r-- 1 user user   25 Jan 01 00:00 source.txt\ndrwxr-xr-x 1 user user 4.0K Jan 01 00:00 test_dir/\n', variations: [{name: 'List all current aliases', code:'alias'}, {name: 'Remove an alias', code:'unalias ll'}], scenarios:['Shortening frequently used commands (`alias gst="git status"`).', 'Creating custom commands for common tasks.', 'Adding default flags to commands (`alias rm="rm -i"`).'], pitfalls:['Aliases only work in interactive shells by default. For scripts, it\'s better to use functions or direct commands.', 'Aliases are expanded at the beginning of a command, which can sometimes lead to unexpected behavior if not careful.'], related:[] }},
            'bash-vars': { lang: 'bash', name: 'Variables', code_sample: `GREETING="Hello, World"\necho $GREETING`, details: { long_desc: 'Variables store data that can be used later in a script. To assign a variable, use `NAME="value"`. To reference it, use `$NAME` or `${NAME}`.', example_output: 'Hello, World', variations: [{name: 'Command Substitution', code:'FILES=$(ls)\necho "Files found: $FILES"'}], scenarios:['Storing configuration values at the top of a script.', 'Capturing the output of a command for later use.', 'Making scripts more readable and maintainable.'], pitfalls:['Do not put spaces around the equals sign (`NAME = "value"` is wrong).', 'Always quote your variables (`echo "$GREETING"`) to prevent issues with spaces and special characters.'], related:['bash-if', 'bash-for-loop'] }},
            'bash-if': { lang: 'bash', name: 'If-Else Statements', code_sample: `if [ -f "file.txt" ]; then\n    echo "file.txt exists."\nelse\n    echo "file.txt does not exist."\nfi`, details: { long_desc: 'Conditional statements allow you to run commands only if certain conditions are true. The `[` command (also known as `test`) is used for checks, like file existence (`-f`), string comparison (`=`), and numerical comparison (`-gt`, `-lt`).', example_output: 'file.txt exists.', variations: [{name: 'String comparison', code:'NAME="Alice"\nif [ "$NAME" = "Alice" ]; then\n    echo "Hello Alice"\nfi'}, {name: 'Integer comparison', code:'COUNT=5\nif [ "$COUNT" -gt 3 ]; then echo "Count > 3"; fi'}], scenarios:['Checking if a file exists before trying to use it.', 'Validating script arguments.', 'Running different commands based on the environment.'], pitfalls:['Spaces around the brackets `[` and `]` are mandatory. `[ -f ... ]` is correct; `[-f ...]` is not.'], related:['bash-vars'] }},
            'bash-for-loop': { lang: 'bash', name: 'For Loops', code_sample: `for fruit in apple banana cherry; do\n    echo "I like $fruit"\ndone`, details: { long_desc: 'For loops iterate over a list of items, executing a block of commands for each item.', example_output: 'I like apple\nI like banana\nI like cherry', variations: [{name: 'C-style for loop', code:'for (( i=0; i<3; i++ )); do\n    echo "Number: $i"\ndone'}, {name: 'Looping through command output', code:'for f in $(ls *.txt); do echo "Processing $f"; done'}], scenarios:['Processing a list of files.', 'Looping through a list of servers to perform an action.', 'Automating repetitive tasks.'], pitfalls:['If you are looping over command output that contains spaces (like filenames), you may need to set the `IFS` (Internal Field Separator) variable or use other techniques to handle them correctly.'], related:['bash-vars', 'bash-while-loop'] }},
        };
        // --- End Data ---

        // Main script logic
        let currentRunnerLang = 'python';
        const codeRunner = document.getElementById('code-runner');
        const runnerInput = document.getElementById('runner-input');
        const runnerOutput = document.getElementById('runner-output');
        const runnerTitle = document.getElementById('runner-title');
        let simulatedFileSystem = {};
        let currentAliases = {}; // Stores active aliases

        function resetFileSystem() {
            simulatedFileSystem = {
                "file.txt": "Hello from the simulated filesystem.\nAnother line here.",
                "source.txt": "This is the source.",
                "names.txt": "Alice\nBob\nCharlie\nAlice\nDavid",
                "item_data.txt": "apple 10\nbanana 20\ncherry 15",
                "sample.txt": "Line 1\nLine 2\nLine 3\nLine 4\nLine 5\nLine 6\nLine 7\nLine 8\nLine 9\nLine 10\nLine 11\nLine 12", // For head/tail
                "script.sh": "#!/bin/bash\necho 'This is a script.'", // For chmod
                "log.txt": "INFO: Application started.\nERROR: File not found: data.json\nWARN: Low disk space.\nINFO: User login: admin", // For grep examples
                "test_dir/bigfile.txt": "This is a large file with content here to simulate size. ".repeat(10), // For du
                // Simulate a directory structure for tar
                "my_folder/file1.txt": "Content of file1",
                "my_folder/file2.txt": "Content of file2",
            };
            // Simulate a process list (not actual files)
            simulatedFileSystem.simulated_processes = {
                "1234": "/bin/bash",
                "5678": "/usr/bin/python script.py"
            };
            currentAliases = {}; // Reset aliases on file system reset
        }
        resetFileSystem();

        function switchTab(tabName) {
            document.getElementById('tab-python').classList.toggle('active', tabName === 'python');
            document.getElementById('tab-bash').classList.toggle('active', tabName === 'bash');
            document.getElementById('content-python').classList.toggle('hidden', tabName !== 'python');
            document.getElementById('content-bash').classList.toggle('hidden', tabName === 'python');
        }

        function showCommandDetails(commandId) {
            const data = commandData[commandId];
            if (!data || !data.details) {
                console.error("Data or data.details not found for commandId:", commandId);
                return;
            }

            const modalContent = document.getElementById('modalContent');
            
            let relatedHtml = (data.details.related || []).map(rId => {
                const rData = commandData[rId];
                if (!rData) return '';
                return `<span class="inline-block bg-gray-600 hover:bg-gray-500 text-gray-200 py-1 px-3 rounded-full text-sm mr-2 mb-2 cursor-pointer" onclick="showCommandDetails('${rId}')">${rData.name}</span>`;
            }).join('');

            const variationsHtml = (data.details.variations || []).map(v => `<div class="mt-4"><h4 class="text-md font-semibold text-gray-300">${v.name}</h4><div class="code-block rounded-md p-4 mt-2 font-fira text-sm">${v.code}</div></div>`).join('');
            const scenariosHtml = (data.details.scenarios || []).map(s => `<li>${s}</li>`).join('');
            const pitfallsHtml = (data.details.pitfalls || []).map(p => `<li>${p}</li>`).join('');

            modalContent.innerHTML = `
                <div class="flex justify-between items-start">
                    <h2 class="text-3xl font-bold text-white mb-2">${data.name}</h2>
                    <button class="text-3xl text-gray-400 hover:text-white" onclick="closeModal()">&times;</button>
                </div>
                <p class="text-lg text-gray-400 mt-2">${data.details.long_desc}</p>
                
                <div class="my-6">
                    <button class="llm-action-button" onclick="explainCodeSimple('${commandId}', this)">Explain this in ELI5 ‚ú®</button>
                    <button class="llm-action-button" onclick="suggestAlternative('${commandId}', this)">Suggest an Alternative ‚ú®</button>
                </div>
                <div id="llm-modal-output" class="llm-output-area"></div>
                
                <div class="modal-section mt-8">
                    <h3>Example</h3>
                    <div class="code-block rounded-md p-4 mt-2">
                        <pre class="font-fira text-sm text-gray-300"><code id="modal-code-${commandId}">${data.code_sample}</code></pre>
                    </div>
                    <div class="bg-black/30 p-4 rounded-md mt-2 font-fira text-sm">
                        <p class="text-gray-400 mb-1 font-semibold">Output:</p>
                        <pre>${data.details.example_output}</pre>
                    </div>
                    <button class="try-it-btn w-full mt-4 text-white font-semibold py-2 px-4 rounded-md" onclick="tryCode('modal-code-${commandId}', '${data.lang}')">Run This Code</button>
                </div>

                <div class="modal-section mt-8"><h3>Variations & Options</h3>${variationsHtml || '<p>No common variations listed.</p>'}</div>
                <div class="modal-section mt-8"><h3>Use Cases & Scenarios</h3><ul class="list-disc list-inside text-gray-300 space-y-2">${scenariosHtml}</ul></div>
                <div class="modal-section mt-8"><h3>Gotchas & Pitfalls</h3><ul class="list-disc list-inside text-gray-300 space-y-2">${pitfallsHtml}</ul></div>
                <div class="modal-section mt-8"><h3>Related Concepts</h3><div>${relatedHtml || '<p>No related concepts linked.</p>'}</div></div>
            `;
            document.getElementById('commandModal').classList.remove('hidden');
            document.getElementById('commandModal').classList.add('flex');
        }

        function closeModal() {
            document.getElementById('commandModal').classList.add('hidden');
            document.getElementById('commandModal').classList.remove('flex');
        }
        
        async function callGeminiAPI(prompt, outputElId, btnEl) {
            const outputElement = document.getElementById(outputElId);
            outputElement.style.display = 'block';
            outputElement.innerHTML = '<div class="flex items-center"><div class="loading-indicator"></div><span class="ml-2">Thinking...</span></div>';
            btnEl.disabled = true;
            try {
                const payload = { contents: [{ role: "user", parts: [{ text: prompt }] }] };
                const apiKey = ""; 
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(payload)
                });
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                const result = await response.json();
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    outputElement.innerHTML = result.candidates[0].content.parts[0].text;
                } else {
                    outputElement.innerHTML = "No response from AI.";
                }
            } catch (error) {
                outputElement.innerHTML = `Error: ${error.message}`;
            } finally {
                btnEl.disabled = false;
            }
        }
        async function explainCodeSimple(cmdId, btn) { await callGeminiAPI(`Explain the following ${commandData[cmdId].lang} code snippet in an "Explain Like I'm 5" format:\n\n${commandData[cmdId].code_sample}`, 'llm-modal-output', btn); }
        async function suggestAlternative(cmdId, btn) { await callGeminiAPI(`Given the code:\n\n${commandData[cmdId].code_sample}\n\nSuggest one common, alternative way in ${commandData[cmdId].lang} to accomplish a similar task. Provide code and a brief explanation.`, 'llm-modal-output', btn); }
        
        function tryCode(codeElementId, lang) {
            const code = document.getElementById(codeElementId).innerText;
            runnerInput.value = code;
            currentRunnerLang = lang;
            runnerTitle.textContent = lang === 'python' ? 'üêç Python Runner' : '~$ Bash Runner';
            codeRunner.classList.remove('hidden');
            codeRunner.classList.add('flex');
            runnerOutput.textContent = ''; // Clear previous output
        }
        function closeRunner() { codeRunner.classList.add('hidden'); codeRunner.classList.remove('flex'); }
        function executeCode() { runnerOutput.textContent = ''; if (currentRunnerLang === 'python') executePython(runnerInput.value); else executeBash(runnerInput.value); }
        function executePython(code) {
            Sk.builtinFiles = { files: {} };
            for(const [k, v] of Object.entries(simulatedFileSystem)) if(typeof v === 'string') Sk.builtinFiles.files[`./${k}`] = v;
            Sk.configure({ output: (txt) => runnerOutput.textContent += txt, read: (x) => { if (Sk.builtinFiles.files[x] === undefined) throw "File not found: " + x; return Sk.builtinFiles.files[x]; }, __future__: Sk.python3 });
            try { Sk.misceval.asyncToPromise(() => Sk.importMainWithBody("<stdin>", false, code, true)).then(null, err => runnerOutput.textContent = err.toString()); } catch (e) { runnerOutput.textContent = e.toString(); }
        }
        
        // Complex Bash simulation
        function executeBash(fullCommand) {
            let finalOutput = '';
            let pipedInput = null; // Stores output of previous command in a pipe chain

            // Split commands by pipe, but handle escaped pipes or pipes inside quotes
            const commandChain = fullCommand.split(/(?<!\\)\|/).map(cmd => cmd.trim().replace(/\\\|/g, '|')); // Basic handling for escaped pipes

            for (let i = 0; i < commandChain.length; i++) {
                const currentCommand = commandChain[i];
                let output = '';

                // Handle redirection for the current command
                let cmdParts = currentCommand.split(/(?<!\\)>/); // Split by > not preceded by \
                let commandToExecute = cmdParts[0].trim();
                let outputFile = null;
                let appendMode = false;

                if (cmdParts.length > 1) {
                    // Check if it's '>>'
                    if (commandToExecute.endsWith('>') && cmdParts[0].endsWith('>>')) { 
                        commandToExecute = commandToExecute.slice(0, -1).trim(); // Remove the second '>'
                        outputFile = cmdParts[1].trim();
                        appendMode = true;
                    } else { // Overwrite redirection
                        outputFile = cmdParts[1].trim();
                    }
                }
                
                // --- Alias resolution ---
                const cmdNameParts = commandToExecute.split(/\s+/);
                const aliasedCmd = cmdNameParts[0];
                if (currentAliases[aliasedCmd]) {
                    commandToExecute = `${currentAliases[aliasedCmd]} ${cmdNameParts.slice(1).join(' ')}`;
                }
                // --- End Alias resolution ---

                // Simulate execution for each part of the pipe
                output = runBashCommand(commandToExecute, pipedInput);
                
                // Handle file output if redirection was specified
                if (outputFile) {
                    // Initialize file if it doesn't exist
                    if (simulatedFileSystem[outputFile] === undefined) {
                        simulatedFileSystem[outputFile] = "";
                    }
                    if (appendMode) {
                        simulatedFileSystem[outputFile] += output;
                    } else {
                        simulatedFileSystem[outputFile] = output;
                    }
                    output = ''; // No direct output to console if redirected to file
                }

                pipedInput = output.trim(); // Prepare for the next command in the pipe
                if (output || outputFile) { // Append to finalOutput if there was actual output or file redirection
                     finalOutput += `\n> ${currentCommand}\n${output}`;
                }
            }
            runnerOutput.textContent = finalOutput.trim();
        }

        function runBashCommand(command, pipedInput = null) {
            // Normalize command for parsing
            command = command.trim();
            const parts = command.split(/\s+/);
            const cmd = parts[0];
            const args = parts.slice(1);
            let output = '';

            // Handle piped input for commands like grep, sed, awk, head, tail, cut, sort, uniq
            let inputToProcess = pipedInput;
            let fileArgConsumed = false; // Flag to know if file argument was used as input

            // If no pipe, but an argument refers to a file in FS, use its content as input
            if (!inputToProcess && args.length > 0 && simulatedFileSystem[args[0]] !== undefined) {
                // Ensure it's not a directory simulation for 'du'
                if (cmd !== 'du' && simulatedFileSystem[args[0]] !== null && typeof simulatedFileSystem[args[0]] === 'string') {
                    inputToProcess = simulatedFileSystem[args[0]];
                    if (cmd !== 'cat' && cmd !== 'head' && cmd !== 'tail' && cmd !== 'chmod') { // cat, head, tail, chmod can take a file arg *without* consuming it for piping
                        args.shift(); // Remove the file name from args if it's being used as input
                        fileArgConsumed = true;
                    }
                }
            }

            switch (cmd) {
                case 'ls':
                    let lsOutput = [];
                    const showAll = command.includes('-a');
                    const longFormat = command.includes('-l');
                    const sortByTimeReverse = command.includes('-ltr');

                    let entries = Object.keys(simulatedFileSystem).filter(name => typeof simulatedFileSystem[name] === 'string' || name.endsWith('/'));

                    if (!showAll) {
                        entries = entries.filter(name => !name.startsWith('.'));
                    }

                    if (sortByTimeReverse) {
                        // Very simplified time sort: just sort alphabetically for now
                        entries.sort();
                    } else {
                        entries.sort();
                    }

                    if (longFormat) {
                        lsOutput = entries.map(name => {
                            let size = 0;
                            let type = '-'; // - for file, d for directory
                            if (typeof simulatedFileSystem[name] === 'string') {
                                size = simulatedFileSystem[name].length;
                            } else if (name.endsWith('/')) { // Simulated directory
                                type = 'd';
                                size = '4.0K'; // Common directory size
                            }
                            return `${type}rw-r--r-- 1 user user ${size} Jan 01 00:00 ${name}`;
                        });
                    } else {
                        lsOutput = entries;
                    }
                    output = lsOutput.join(longFormat ? '\n' : '  ') + '\n';
                    break;
                case 'pwd':
                    output = '/home/user\n';
                    break;
                case 'echo':
                    output = args.join(' ') + '\n';
                    break;
                case 'cat':
                    if (inputToProcess) { // If piped input, cat just outputs it
                        output = inputToProcess + '\n';
                    } else if (args.length > 0 && simulatedFileSystem[args[0]] !== undefined) {
                        output = simulatedFileSystem[args[0]] + '\n';
                    } else {
                        output = 'cat: No such file or input\n';
                    }
                    break;
                case 'grep':
                    if (inputToProcess && args.length > 0) {
                        let pattern = args[0];
                        let invertMatch = false;
                        let patternIndex = 0;

                        if (args[0] === '-v') {
                            invertMatch = true;
                            pattern = args[1]; // Next arg is the pattern
                            patternIndex = 1;
                        }
                        if (!pattern) return 'grep: missing pattern\n';

                        // Basic simulation of regex: checks for inclusion
                        output = inputToProcess.split('\n').filter(line => {
                            const matches = line.includes(pattern);
                            return invertMatch ? !matches : matches;
                        }).join('\n') + '\n';
                    } else {
                        output = 'grep: requires input or file and pattern.\n';
                    }
                    break;
                case 'sed':
                    if (inputToProcess && args.length > 0) {
                        const sedCommand = args[0].replace(/['"]/g, ''); // Remove quotes
                        let processedLines = inputToProcess.split('\n');
                        let sedOutput = [];

                        if (sedCommand.startsWith('s/')) {
                            const parts = sedCommand.split('/');
                            if (parts.length < 3) return `sed: malformed substitution expression: ${sedCommand}\n`;
                            const oldText = parts[1];
                            const newText = parts[2];
                            const flags = parts[3]; // e.g., 'g'

                            processedLines.forEach(line => {
                                let modifiedLine = line;
                                if (flags && flags.includes('g')) {
                                    modifiedLine = line.split(oldText).join(newText);
                                } else {
                                    modifiedLine = line.replace(oldText, newText);
                                }
                                sedOutput.push(modifiedLine);
                            });
                        } else if (sedCommand.startsWith('/') && sedCommand.endsWith('/d')) {
                            const pattern = sedCommand.substring(1, sedCommand.length - 2);
                            processedLines.forEach(line => {
                                if (!line.includes(pattern)) {
                                    sedOutput.push(line);
                                }
                            });
                        } else {
                            return `sed: unsupported command or malformed expression: ${sedCommand}\n`;
                        }
                        output = sedOutput.join('\n') + '\n';
                    } else {
                        output = 'sed: requires input and a command.\n';
                    }
                    break;
                case 'awk':
                    if (inputToProcess && args.length > 0) {
                        const awkProgram = args.join(' ').replace(/['"]/g, ''); // Remove outer quotes
                        const lines = inputToProcess.split('\n').filter(line => line.trim() !== '');
                        let awkOutput = [];
                        let sum = 0; // For sum example
                        let fieldSeparator = /\s+/; // Default whitespace

                        // Check for -F option
                        const F_index = args.indexOf('-F:');
                        if (F_index !== -1 && F_index + 1 < args.length) {
                             fieldSeparator = args[F_index + 1].replace(/['"]/g, '');
                        } else if (F_index !== -1) { // -F: without a specific char
                             fieldSeparator = ':';
                        }


                        // Simulate BEGIN block if present
                        if (awkProgram.includes('BEGIN')) {
                            const beginMatch = awkProgram.match(/BEGIN\s*\{([^\}]+)\}/);
                            if (beginMatch) {
                                const beginAction = beginMatch[1].trim();
                                if (beginAction.includes('print')) {
                                    awkOutput.push(beginAction.replace(/print\s*(.*)/, (match, p1) => p1.replace(/"/g, '')));
                                }
                            }
                        }

                        lines.forEach((line, index) => {
                            const fields = line.split(fieldSeparator); // Use determined separator

                            let lineHandled = false;

                            // Specific print for NR==1 and NR>1 examples
                            if (awkProgram.includes('NR==1 {print "Header: " $0}') && index === 0) {
                                awkOutput.push(`Header: ${line}`);
                                lineHandled = true;
                            } else if (awkProgram.includes('NR>1 {print "User: " $1 ", Age: " $2}') && index > 0) {
                                awkOutput.push(`User: ${fields[0]}, Age: ${fields[1]}`);
                                lineHandled = true;
                            }
                            
                            // Filter lines by pattern (e.g., /anana/)
                            if (!lineHandled && awkProgram.match(/\/.*\//) && line.includes(awkProgram.match(/\/(.*)\//)[1])) {
                                awkOutput.push(line);
                                lineHandled = true;
                            }


                            // Sum column example
                            if (awkProgram.includes('{sum+=$2}')) {
                                const value = parseFloat(fields[1]); // Assumes value is in second column for sum example
                                if (!isNaN(value)) sum += value;
                                lineHandled = true; // Mark as handled for this specific logic
                            }
                            
                            // General print $N or print with strings (if not already handled)
                            if (!lineHandled && awkProgram.includes('print')) {
                                // Extract the content inside print(...)
                                const printContentMatch = awkProgram.match(/\{print\s*([^}]+)\}/);
                                if (printContentMatch) {
                                    let printString = printContentMatch[1];
                                    // Replace $n with actual field values
                                    printString = printString.replace(/\$([0-9]+)/g, (match, p1) => {
                                        const fieldIndex = parseInt(p1, 10);
                                        if (fieldIndex === 0) return line;
                                        return fields[fieldIndex - 1] || '';
                                    });
                                    // Remove quotes from string literals
                                    printString = printString.replace(/"([^"]*)"/g, '$1');
                                    awkOutput.push(printString.trim());
                                    lineHandled = true;
                                } else if (awkProgram.includes('{print $1}') && args[0].includes("-F:")) { // Catch simple -F: example
                                    awkOutput.push(fields[0]);
                                    lineHandled = true;
                                }
                            }
                        });

                        // Simulate END block if present
                        if (awkProgram.includes('END')) {
                            const endMatch = awkProgram.match(/END\s*\{([^\}]+)\}/);
                            if (endMatch) {
                                const endAction = endMatch[1].trim();
                                if (endAction.includes('print "Total: " sum')) {
                                    awkOutput.push(`Total: ${sum}`);
                                }
                            }
                        }
                        output = awkOutput.join('\n') + '\n';

                    } else {
                        output = 'awk: requires input and a program.\n';
                    }
                    break;
                case 'cut':
                    if (inputToProcess && args.length > 0) {
                        let delimiter = '\t'; // Default tab
                        let fieldsToCut = [];
                        let charsToCut = null;

                        for (let i = 0; i < args.length; i++) {
                            if (args[i] === '-d' && i + 1 < args.length) {
                                delimiter = args[++i].replace(/['"]/g, '');
                            } else if (args[i] === '-f' && i + 1 < args.length) {
                                fieldsToCut = args[++i].split(',').map(Number);
                            } else if (args[i].startsWith('-c')) {
                                charsToCut = args[i].substring(2);
                            }
                        }

                        let cutOutput = [];
                        inputToProcess.split('\n').forEach(line => {
                            if (!line.trim()) return;

                            if (charsToCut) {
                                const [start, end] = charsToCut.split('-').map(Number);
                                cutOutput.push(line.substring(start - 1, end || line.length));
                            } else if (fieldsToCut.length > 0) {
                                const fields = line.split(delimiter);
                                let selectedFields = [];
                                fieldsToCut.forEach(f => {
                                    if (f > 0 && f <= fields.length) {
                                        selectedFields.push(fields[f - 1]);
                                    }
                                });
                                cutOutput.push(selectedFields.join(delimiter));
                            } else {
                                cutOutput.push(line); // No cutting specified
                            }
                        });
                        output = cutOutput.join('\n') + '\n';
                    } else {
                        output = 'cut: requires input or file and options.\n';
                    }
                    break;
                case 'head':
                    if (inputToProcess) {
                        let numLines = 10; // Default
                        if (args[0] === '-n' && args[1]) {
                            numLines = parseInt(args[1], 10);
                        }
                        output = inputToProcess.split('\n').slice(0, numLines).join('\n') + '\n';
                    } else {
                        output = 'head: requires input or file.\n';
                    }
                    break;
                case 'tail':
                    if (inputToProcess) {
                        let numLines = 10; // Default
                        if (args[0] === '-n' && args[1]) {
                            numLines = parseInt(args[1], 10);
                        }
                        const lines = inputToProcess.split('\n');
                        output = lines.slice(Math.max(lines.length - numLines, 0)).join('\n') + '\n';
                    } else {
                        output = 'tail: requires input or file.\n';
                    }
                    break;
                case 'touch':
                    args.forEach(file => simulatedFileSystem[file] = '');
                    output = '';
                    break;
                case 'ps':
                    let psOutput = 'USER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\n';
                    // Iterate over simulated processes
                    for (const pid in simulatedFileSystem.simulated_processes) {
                        psOutput += `user      ${pid}  0.0  0.1  12345  6789 pts/0 Ss+  10:00   0:00 ${simulatedFileSystem.simulated_processes[pid]}\n`;
                    }
                    output = psOutput;
                    break;
                case 'kill':
                    if (args.length > 0) {
                        const pidToKill = args[args.length -1]; // Last arg is usually PID
                        const signal = args[0] === '-9' ? 'SIGKILL' : 'SIGTERM';
                        if (simulatedFileSystem.simulated_processes[pidToKill]) {
                            const cmdName = simulatedFileSystem.simulated_processes[pidToKill];
                            delete simulatedFileSystem.simulated_processes[pidToKill];
                            output = `Simulating sending ${signal} to PID ${pidToKill}. Process ${pidToKill} (${cmdName}) would normally terminate.\n`;
                        } else {
                            output = `kill: (${pidToKill}): No such process or already terminated.\n`;
                        }
                    } else {
                        output = 'kill: missing PID.\n';
                    }
                    break;
                case 'wc': // Very basic wc -l simulation
                    if (inputToProcess && args[0] === '-l') {
                        output = `${inputToProcess.split('\n').filter(line => line.trim() !== '').length}\n`;
                    } else {
                        output = `wc: unsupported command or missing input\n`;
                    }
                    break;
                case 'sort':
                    if (inputToProcess) {
                        output = inputToProcess.split('\n').filter(line => line.trim() !== '').sort().join('\n') + '\n';
                    } else {
                        output = 'sort: requires input\n';
                    }
                    break;
                case 'uniq':
                    if (inputToProcess && args[0] === '-c') {
                        const lines = inputToProcess.split('\n').filter(line => line.trim() !== '');
                        const counts = {};
                        lines.forEach(line => {
                            counts[line] = (counts[line] || 0) + 1;
                        });
                        output = Object.entries(counts).map(([line, count]) => `${count} ${line}`).sort().join('\n') + '\n';
                    } else {
                        output = 'uniq: requires piped input and -c option for this simulation.\n';
                    }
                    break;
                case 'rm':
                    let recursive = command.includes('-r');
                    let force = command.includes('-f');
                    let success = true;
                    // Filter out rm options to get actual files/directories to delete
                    const filesToDelete = args.filter(arg => !arg.startsWith('-'));

                    for (const fileOrDir of filesToDelete) {
                        if (simulatedFileSystem[fileOrDir] !== undefined && typeof simulatedFileSystem[fileOrDir] === 'string') {
                            delete simulatedFileSystem[fileOrDir];
                            if (!force) output += `removed '${fileOrDir}'\n`; // Only show if not forced
                        } else if (simulatedFileSystem[fileOrDir] !== undefined && typeof simulatedFileSystem[fileOrDir] === 'object' && fileOrDir.endsWith('/')) { // Simulate directory deletion
                            if (recursive) {
                                const prefix = fileOrDir.slice(0, -1);
                                Object.keys(simulatedFileSystem).forEach(f => {
                                    if (f.startsWith(prefix)) delete simulatedFileSystem[f];
                                });
                                delete simulatedFileSystem[fileOrDir]; // Delete the directory marker itself
                                if (!force) output += `removed directory '${fileOrDir}' and its contents\n`;
                            } else {
                                output += `rm: cannot remove '${fileOrDir}': Is a directory\n`;
                                success = false;
                            }
                        }
                        else {
                            output += `rm: cannot remove '${fileOrDir}': No such file or directory\n`;
                            success = false;
                        }
                    }
                    if (output === '' && success) output = ''; // No output for successful silent removal
                    break;
                case 'history':
                    const histCount = parseInt(args[0]) || 5; // Default to 5 for simulation
                    const simulatedHistory = [
                        'ls -la',
                        'cd /tmp',
                        'echo "Hello"',
                        'cat file.txt',
                        'history 5',
                        'grep "ERROR" log.txt',
                        'sed \'s/old/new/\' file.txt',
                        'awk \'{print $1}\' item_data.txt',
                        'ssh user@remote.example.com',
                        'scp local.txt user@remote.example.com:/tmp/',
                        'tar -czvf backup.tar.gz my_folder/',
                        'find . -name "*.txt" | xargs rm',
                        'chmod +x script.sh',
                        'du -sh .',
                        'df -h',
                        'ps aux',
                        'kill 1234',
                        'alias ll=\'ls -lh\'',
                        'll',
                        'cut -d: -f1 names.txt',
                        'head -n 5 sample.txt',
                        'tail -n 3 sample.txt'
                    ];
                    output = simulatedHistory.slice(Math.max(0, simulatedHistory.length - histCount))
                                            .map((cmd, i) => `  ${simulatedHistory.length - histCount + i + 1} ${cmd}`).join('\n') + '\n';
                    break;
                case 'alias':
                    if (args.length === 0) {
                        output = Object.entries(currentAliases).map(([key, value]) => `alias ${key}='${value}'`).join('\n') + '\n';
                    } else {
                        const aliasAssignment = args.join(' '); // e.g., "ll='ls -lh'"
                        const match = aliasAssignment.match(/^([^=]+)='(.*)'$/);
                        if (match) {
                            const aliasName = match[1];
                            const aliasValue = match[2];
                            currentAliases[aliasName] = aliasValue;
                            output = ''; // No output for successful alias creation
                        } else {
                            output = `alias: invalid alias syntax or no alias specified: ${aliasAssignment}\n`;
                        }
                    }
                    break;
                case 'du':
                    if (args.length > 0) {
                        const target = args[args.length -1]; // Last arg is the target
                        if (simulatedFileSystem[target] !== undefined) {
                            let size = 0;
                            if (typeof simulatedFileSystem[target] === 'string') {
                                size = simulatedFileSystem[target].length;
                            } else if (target.endsWith('/')) { // Simulated directory
                                const prefix = target.slice(0, -1);
                                for (const key in simulatedFileSystem) {
                                    if (key.startsWith(prefix) && typeof simulatedFileSystem[key] === 'string') {
                                        size += simulatedFileSystem[key].length;
                                    }
                                }
                                size = Math.ceil(size / 1024) + 'K'; // Simulate KBs
                            }
                            output = `${size}\t${target}\n`;
                        } else {
                            output = `du: cannot access '${target}': No such file or directory\n`;
                        }
                    } else {
                        // Simulate default du behavior for current directory (all files)
                        let totalSize = 0;
                        for (const key in simulatedFileSystem) {
                            if (typeof simulatedFileSystem[key] === 'string') {
                                totalSize += simulatedFileSystem[key].length;
                            }
                        }
                        output = `${Math.ceil(totalSize / 1024)}K\t.\n`;
                    }
                    break;
                case 'df':
                    // Simplified df output
                    output = `Filesystem      Size  Used Avail Use% Mounted on\n`;
                    output += `/dev/sda1        50G   20G   28G  42% /\n`;
                    output += `tmpfs           1.5G     0  1.5G   0% /dev/shm\n`;
                    output += `tmpfs           5.0M     0  5.0M   0% /run/lock\n`;
                    break;
                case 'ssh':
                case 'scp':
                case 'cron':
                    output = `${cmd}: This command typically interacts with the real system or network. For this simulation, its execution is not fully replicated, but its purpose is described.\n`;
                    break;
                default:
                    output = `bash: command not found: ${cmd}\n`;
                    break;
            }
            return output;
        }
        
        let isDragging = false, offsetX, offsetY;
        const runnerHeader = document.getElementById('runner-header');
        runnerHeader.addEventListener('mousedown', e => { isDragging = true; offsetX = e.clientX - codeRunner.offsetLeft; offsetY = e.clientY - codeRunner.offsetTop; });
        document.addEventListener('mousemove', e => { if(isDragging) { codeRunner.style.left = (e.clientX - offsetX) + 'px'; codeRunner.style.top = (e.clientY - offsetY) + 'px'; } });
        document.addEventListener('mouseup', () => isDragging = false);
        document.body.addEventListener('click', e => { if(e.target.closest('.try-it-btn')) resetFileSystem(); }, true);
    </script>
</body>
</html>
